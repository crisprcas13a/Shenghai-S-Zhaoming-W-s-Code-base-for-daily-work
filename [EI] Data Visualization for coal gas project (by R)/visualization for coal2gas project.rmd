---
title: "Untitled"
author: "201900700277Wu Zhaoming"
date: "2021/5/8"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```




```{r paged.print=FALSE}

index<-duplicated(mapDF[mapDF$NAME_2 == 'Shijiazhuang',]$NAME_3)
data.set<-mapDF[mapDF$NAME_2 == 'Shijiazhuang',][!index,]
length(data.set$NAME_3)

```




# 绘制地图




```{r}



setwd("E://Rdata//Map//shpfile//new_1")
library(ggplot2)
library(maps)
library(mapdata)
library(maptools)
library(sp)
library(rgdal)
library(rgeos)
  
dataProjected <- readOGR("xian.shp",use_iconv=TRUE, encoding = "UTF-8")
# proj4string(dataProjected) <- CRS("+proj=longlat +ellps=WGS84")  
# projNew <- CRS("+proj=merc +lat_0=45n +lon_0=100e")  
# dataProjected <- spTransform(dataProjected, projNew)


dataProjected@data$id <- rownames(dataProjected@data)
mapPoints <- fortify(dataProjected, region = "id")

# dataProjected@data$hg <- ddddd$hg
mapDF <- merge(mapPoints, dataProjected@data, by = "id")

mapDF$long <- 6378137*pi*mapDF$long/180
mapDF$lat <- 6378137*log(tan(pi/4+mapDF$lat*pi/360))






dataProjected1 <- readOGR("sheng.shp",use_iconv=TRUE, encoding = "UTF-8")
# proj4string(dataProjected1) <- CRS("+proj=longlat +ellps=WGS84")
# projNew <- CRS("+proj=merc +lat_0=45n +lon_0=100e")
# dataProjected1 <- spTransform(dataProjected1, projNew)

dataProjected1@data$id <- rownames(dataProjected1@data) 
mapPoints1 <- fortify(dataProjected1, region = "id")

# dataProjected@data$hg <- ddddd$hg
mapDF1 <- merge(mapPoints1, dataProjected1@data, by = "id")

mapDF1$long <- 6378137*pi*mapDF1$long/180
mapDF1$lat <- 6378137*log(tan(pi/4+mapDF1$lat*pi/360))






dataProjected2 <- readOGR("shi.shp",use_iconv=TRUE, encoding = "UTF-8")

# proj4string(dataProjected2) <- CRS("+proj=longlat +ellps=WGS84")  
# projNew <- CRS("+proj=merc +lat_0=45n +lon_0=100e")  
# dataProjected2 <- spTransform(dataProjected2, projNew)


dataProjected2@data$id <- rownames(dataProjected2@data)
mapPoints2 <- fortify(dataProjected2, region = "id")

# dataProjected@data$hg <- ddddd$hg
mapDF2 <- merge(mapPoints2, dataProjected2@data, by = "id")

mapDF2$long <- 6378137*pi*mapDF2$long/180
mapDF2$lat <- 6378137*log(tan(pi/4+mapDF2$lat*pi/360))
```



```{r paged.print=FALSE}
# head(mapDF2[mapDF2$河北省 == "辛集市",])
shaanxi <- mapDF2[mapDF2$省 == "陕西省",]
```







```{r warning=FALSE, paged.print=FALSE}

# ddddd <- read.csv('E://Rdata//coal//visualization.csv')
ddddd <- data.frame(
    PAC = c(110101L,110102L,110105L,
            110106L,110107L,110108L,110109L,110111L,110112L,110113L,
            110114L,110115L,110116L,110117L,110118L,110119L,
            120101L,120102L,120103L,120104L,120105L,120106L,
            120110L,120111L,120112L,120113L,120114L,120115L,120116L,
            120117L,120118L,120119L,130102L,130104L,130105L,
            130107L,130108L,130109L,130110L,130111L,130121L,
            130123L,130125L,130126L,130127L,130128L,130129L,130130L,
            130131L,130132L,130133L,130181L,130183L,130184L,
            130202L,130203L,130204L,130205L,130207L,130208L,
            130209L,130224L,130225L,130227L,130229L,130281L,130283L,
            130284L,130302L,130303L,130304L,130306L,130321L,
            130322L,130324L,130402L,130403L,130404L,130406L,
            130407L,130408L,130423L,130424L,130425L,130426L,130427L,
            130430L,130431L,130432L,130433L,130434L,130435L,
            130481L,130502L,130503L,130521L,130522L,130523L,
            130524L,130525L,130526L,130527L,130528L,130529L,130530L,
            130531L,130532L,130533L,130534L,130535L,130581L,
            130582L,130602L,130606L,130607L,130608L,130609L,
            130623L,130624L,130626L,130627L,130628L,130629L,130630L,
            130631L,130632L,130633L,130634L,130635L,130636L,
            130637L,130638L,130681L,130682L,130683L,130684L,
            130702L,130703L,130705L,130706L,130708L,130709L,130722L,
            130723L,130724L,130725L,130726L,130727L,130728L,
            130730L,130731L,130732L,130802L,130803L,130804L,
            130821L,130822L,130824L,130825L,130826L,130827L,130828L,
            130881L,130902L,130903L,130921L,130922L,130923L,
            130924L,130925L,130926L,130927L,130928L,130929L,
            130930L,130981L,130982L,130983L,130984L,131002L,131003L,
            131022L,131023L,131024L,131025L,131026L,131028L,
            131081L,131082L,131102L,131103L,131121L,131122L,
            131123L,131124L,131125L,131126L,131127L,131128L,131182L,
            410102L,410103L,410104L,410105L,410106L,410108L,
            410122L,410181L,410182L,410183L,410184L,410185L,
            410202L,410203L,410204L,410205L,410212L,410221L,410222L,
            410223L,410225L,410302L,410303L,410304L,410305L,
            410306L,410311L,410322L,410323L,410324L,410325L,
            410326L,410327L,410328L,410329L,410381L,410402L,410403L,
            410404L,410411L,410421L,410422L,410423L,410425L,
            410481L,410482L,410502L,410503L,410505L,410506L,
            410522L,410523L,410526L,410527L,410581L,410602L,410603L,
            410611L,410621L,410622L,410702L,410703L,410704L,
            410711L,410721L,410724L,410725L,410726L,410727L,
            410781L,410782L,410783L,410802L,410803L,410804L,410811L,
            410821L,410822L,410823L,410825L,410882L,410883L,
            410902L,410922L,410923L,410926L,410927L,410928L,
            411002L,411003L,411024L,411025L,411081L,411082L,411102L,
            411103L,411104L,411121L,411122L,411202L,411203L,
            411221L,411224L,411281L,411282L,411302L,411303L,
            411321L,411322L,411323L,411324L,411325L,411326L,411327L,
            411328L,411329L,411330L,411381L,411402L,411403L,
            411421L,411422L,411423L,411424L,411425L,411426L,
            411481L,411502L,411503L,411521L,411522L,411523L,411524L,
            411525L,411526L,411527L,411528L,411602L,411603L,
            411621L,411622L,411623L,411624L,411625L,411627L,
            411628L,411681L,411702L,411721L,411722L,411723L,411724L,
            411725L,411726L,411727L,411728L,411729L,419001L,
            370102L,370103L,370104L,370105L,370112L,370113L,
            370114L,370115L,370116L,370117L,370124L,370126L,370202L,
            370203L,370211L,370212L,370213L,370214L,370215L,
            370281L,370283L,370285L,370302L,370303L,370304L,
            370305L,370306L,370321L,370322L,370323L,370402L,370403L,
            370404L,370405L,370406L,370481L,370502L,370503L,
            370505L,370522L,370523L,370602L,370611L,370612L,
            370613L,370634L,370681L,370682L,370683L,370684L,370685L,
            370686L,370687L,370702L,370703L,370704L,370705L,
            370724L,370725L,370781L,370782L,370783L,370784L,
            370785L,370786L,370811L,370812L,370826L,370827L,370828L,
            370829L,370830L,370831L,370832L,370881L,370883L,
            370902L,370911L,370921L,370923L,370982L,370983L,
            371002L,371003L,371082L,371083L,371102L,371103L,371121L,
            371122L,371302L,371311L,371312L,371321L,371322L,
            371323L,371324L,371325L,371326L,371327L,371328L,
            371329L,371402L,371403L,371422L,371423L,371424L,371425L,
            371426L,371427L,371428L,371481L,371482L,371502L,
            371503L,371521L,371522L,371524L,371525L,371526L,
            371581L,371602L,371603L,371621L,371622L,371623L,371625L,
            371681L,371702L,371703L,371721L,371722L,371723L,
            371724L,371725L,371726L,371728L,140105L,140106L,
            140107L,140108L,140109L,140110L,140121L,140122L,140123L,
            140181L,140212L,140213L,140214L,140215L,140221L,
            140222L,140223L,140224L,140225L,140226L,140302L,
            140303L,140311L,140321L,140322L,140403L,140404L,140405L,
            140406L,140423L,140425L,140426L,140427L,140428L,
            140429L,140430L,140431L,140502L,140521L,140522L,
            140524L,140525L,140581L,140602L,140603L,140621L,140622L,
            140623L,140681L,140702L,140703L,140721L,140722L,
            140723L,140724L,140725L,140727L,140728L,140729L,
            140781L,140802L,140821L,140822L,140823L,140824L,140825L,
            140826L,140827L,140828L,140829L,140830L,140881L,
            140882L,140902L,140921L,140922L,140923L,140924L,
            140925L,140926L,140927L,140928L,140929L,140930L,140931L,
            140932L,140981L,141002L,141021L,141022L,141023L,
            141024L,141025L,141026L,141027L,141028L,141029L,
            141030L,141031L,141032L,141033L,141034L,141081L,141082L,
            141102L,141121L,141122L,141123L,141124L,141125L,
            141126L,141127L,141128L,141129L,141130L,141181L,
            141182L),
    NAME = c("东城区","西城区","朝阳区","丰台区",
             "石景山区","海淀区","门头沟区","房山区","通州区","顺义区","昌平区","大兴区",
             "怀柔区","平谷区","密云区","延庆区","和平区","河东区","河西区","南开区",
             "河北区","红桥区","东丽区","西青区","津南区","北辰区","武清区","宝坻区",
             "滨海新区","宁河区","静海区","蓟州区","长安区","桥西区","新华区","井陉矿区",
             "裕华区","藁城区","鹿泉区","栾城区","井陉县","正定县","行唐县","灵寿县",
             "高邑县","深泽县","赞皇县","无极县","平山县","元氏县","赵县","辛集市","晋州市",
             "新乐市","路南区","路北区","古冶区","开平区","丰南区","丰润区","曹妃甸区",
             "滦南县","乐亭县","迁西县","玉田县","遵化市","迁安市","滦州市","海港区",
             "山海关区","北戴河区","抚宁区","青龙满族自治县","昌黎县","卢龙县","邯山区",
             "丛台区","复兴区","峰峰矿区","肥乡区","永年区","临漳县","成安县","大名县",
             "涉县","磁县","邱县","鸡泽县","广平县","馆陶县","魏县","曲周县","武安市",
             "桥东区","桥西区","邢台县","临城县","内丘县","柏乡县","隆尧县","任县",
             "南和县","宁晋县","巨鹿县","新河县","广宗县","平乡县","威县","清河县",
             "临西县","南宫市","沙河市","竞秀区","莲池区","满城区","清苑区","徐水区","涞水县",
             "阜平县","定兴县","唐县","高阳县","容城县","涞源县","望都县","安新县",
             "易县","曲阳县","蠡县","顺平县","博野县","雄县","涿州市","定州市",
             "安国市","高碑店市","桥东区","桥西区","宣化区","下花园区","万全区","崇礼区",
             "张北县","康保县","沽源县","尚义县","蔚县","阳原县","怀安县","怀来县","涿鹿县",
             "赤城县","双桥区","双滦区","鹰手营子矿区","承德县","兴隆县","滦平县",
             "隆化县","丰宁满族自治县","宽城满族自治县","围场满族蒙古族自治县","平泉市","新华区",
             "运河区","沧县","青县","东光县","海兴县","盐山县","肃宁县","南皮县","吴桥县",
             "献县","孟村回族自治县","泊头市","任丘市","黄骅市","河间市","安次区",
             "广阳区","固安县","永清县","香河县","大城县","文安县","大厂回族自治县","霸州市",
             "三河市","桃城区","冀州区","枣强县","武邑县","武强县","饶阳县","安平县",
             "故城县","景县","阜城县","深州市","中原区","二七区","管城回族区","金水区",
             "上街区","惠济区","中牟县","巩义市","荥阳市","新密市","新郑市","登封市",
             "龙亭区","顺河回族区","鼓楼区","禹王台区","祥符区","杞县","通许县","尉氏县",
             "兰考县","老城区","西工区","瀍河回族区","涧西区","吉利区","洛龙区","孟津县",
             "新安县","栾川县","嵩县","汝阳县","宜阳县","洛宁县","伊川县","偃师市",
             "新华区","卫东区","石龙区","湛河区","宝丰县","叶县","鲁山县","郏县","舞钢市",
             "汝州市","文峰区","北关区","殷都区","龙安区","安阳县","汤阴县","滑县",
             "内黄县","林州市","鹤山区","山城区","淇滨区","浚县","淇县","红旗区",
             "卫滨区","凤泉区","牧野区","新乡县","获嘉县","原阳县","延津县","封丘县","卫辉市",
             "辉县市","长垣市","解放区","中站区","马村区","山阳区","修武县","博爱县",
             "武陟县","温县","沁阳市","孟州市","华龙区","清丰县","南乐县","范县",
             "台前县","濮阳县","魏都区","建安区","鄢陵县","襄城县","禹州市","长葛市",
             "源汇区","郾城区","召陵区","舞阳县","临颍县","湖滨区","陕州区","渑池县",
             "卢氏县","义马市","灵宝市","宛城区","卧龙区","南召县","方城县","西峡县","镇平县",
             "内乡县","淅川县","社旗县","唐河县","新野县","桐柏县","邓州市","梁园区",
             "睢阳区","民权县","睢县","宁陵县","柘城县","虞城县","夏邑县","永城市",
             "浉河区","平桥区","罗山县","光山县","新县","商城县","固始县","潢川县",
             "淮滨县","息县","川汇区","淮阳区","扶沟县","西华县","商水县","沈丘县","郸城县",
             "太康县","鹿邑县","项城市","驿城区","西平县","上蔡县","平舆县","正阳县",
             "确山县","泌阳县","汝南县","遂平县","新蔡县","济源市","历下区","市中区",
             "槐荫区","天桥区","历城区","长清区","章丘区","济阳区","莱芜区","钢城区",
             "平阴县","商河县","市南区","市北区","黄岛区","崂山区","李沧区","城阳区",
             "即墨区","胶州市","平度市","莱西市","淄川区","张店区","博山区","临淄区",
             "周村区","桓台县","高青县","沂源县","市中区","薛城区","峄城区","台儿庄区",
             "山亭区","滕州市","东营区","河口区","垦利区","利津县","广饶县","芝罘区",
             "福山区","牟平区","莱山区","长岛县","龙口市","莱阳市","莱州市","蓬莱市","招远市",
             "栖霞市","海阳市","潍城区","寒亭区","坊子区","奎文区","临朐县","昌乐县",
             "青州市","诸城市","寿光市","安丘市","高密市","昌邑市","任城区","兖州区",
             "微山县","鱼台县","金乡县","嘉祥县","汶上县","泗水县","梁山县","曲阜市",
             "邹城市","泰山区","岱岳区","宁阳县","东平县","新泰市","肥城市","环翠区",
             "文登区","荣成市","乳山市","东港区","岚山区","五莲县","莒县","兰山区",
             "罗庄区","河东区","沂南县","郯城县","沂水县","兰陵县","费县","平邑县","莒南县",
             "蒙阴县","临沭县","德城区","陵城区","宁津县","庆云县","临邑县","齐河县",
             "平原县","夏津县","武城县","乐陵市","禹城市","东昌府区","茌平区","阳谷县",
             "莘县","东阿县","冠县","高唐县","临清市","滨城区","沾化区","惠民县",
             "阳信县","无棣县","博兴县","邹平市","牡丹区","定陶区","曹县","单县","成武县",
             "巨野县","郓城县","鄄城县","东明县","小店区","迎泽区","杏花岭区","尖草坪区",
             "万柏林区","晋源区","清徐县","阳曲县","娄烦县","古交市","新荣区","平城区",
             "云冈区","云州区","阳高县","天镇县","广灵县","灵丘县","浑源县","左云县",
             "城区","矿区","郊区","平定县","盂县","潞州区","上党区","屯留区",
             "潞城区","襄垣县","平顺县","黎城县","壶关县","长子县","武乡县","沁县","沁源县",
             "城区","沁水县","阳城县","陵川县","泽州县","高平市","朔城区","平鲁区",
             "山阴县","应县","右玉县","怀仁市","榆次区","太谷区","榆社县","左权县",
             "和顺县","昔阳县","寿阳县","祁县","平遥县","灵石县","介休市","盐湖区","临猗县",
             "万荣县","闻喜县","稷山县","新绛县","绛县","垣曲县","夏县","平陆县",
             "芮城县","永济市","河津市","忻府区","定襄县","五台县","代县","繁峙县",
             "宁武县","静乐县","神池县","五寨县","岢岚县","河曲县","保德县","偏关县",
             "原平市","尧都区","曲沃县","翼城县","襄汾县","洪洞县","古县","安泽县","浮山县",
             "吉县","乡宁县","大宁县","隰县","永和县","蒲县","汾西县","侯马市",
             "霍州市","离石区","文水县","交城县","兴县","临县","柳林县","石楼县","岚县",
             "方山县","中阳县","交口县","孝义市","汾阳市"),
    省代码 = c(110000L,110000L,110000L,
            110000L,110000L,110000L,110000L,110000L,110000L,110000L,
            110000L,110000L,110000L,110000L,110000L,110000L,
            120000L,120000L,120000L,120000L,120000L,120000L,
            120000L,120000L,120000L,120000L,120000L,120000L,120000L,
            120000L,120000L,120000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,130000L,130000L,130000L,130000L,130000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,370000L,
            370000L,370000L,370000L,370000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,140000L,140000L,
            140000L),
    省 = c("北京市","北京市","北京市","北京市",
          "北京市","北京市","北京市","北京市","北京市","北京市","北京市","北京市",
          "北京市","北京市","北京市","北京市","天津市","天津市","天津市","天津市","天津市",
          "天津市","天津市","天津市","天津市","天津市","天津市","天津市","天津市",
          "天津市","天津市","天津市","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","河北省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","河南省","河南省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","山东省",
          "山东省","山东省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山西省","山西省","山西省","山西省","山西省"),
    市代码 = c(110000L,110000L,110000L,
            110000L,110000L,110000L,110000L,110000L,110000L,110000L,
            110000L,110000L,110000L,110000L,110000L,110000L,
            120000L,120000L,120000L,120000L,120000L,120000L,
            120000L,120000L,120000L,120000L,120000L,120000L,120000L,
            120000L,120000L,120000L,130100L,130100L,130100L,
            130100L,130100L,130100L,130100L,130100L,130100L,
            130100L,130100L,130100L,130100L,130100L,130100L,130100L,
            130100L,130100L,130100L,130100L,130100L,130100L,
            130200L,130200L,130200L,130200L,130200L,130200L,
            130200L,130200L,130200L,130200L,130200L,130200L,130200L,
            130200L,130300L,130300L,130300L,130300L,130300L,
            130300L,130300L,130400L,130400L,130400L,130400L,
            130400L,130400L,130400L,130400L,130400L,130400L,130400L,
            130400L,130400L,130400L,130400L,130400L,130400L,
            130400L,130500L,130500L,130500L,130500L,130500L,
            130500L,130500L,130500L,130500L,130500L,130500L,130500L,
            130500L,130500L,130500L,130500L,130500L,130500L,
            130500L,130600L,130600L,130600L,130600L,130600L,
            130600L,130600L,130600L,130600L,130600L,130600L,130600L,
            130600L,130600L,130600L,130600L,130600L,130600L,
            130600L,130600L,130600L,130600L,130600L,130600L,
            130700L,130700L,130700L,130700L,130700L,130700L,130700L,
            130700L,130700L,130700L,130700L,130700L,130700L,
            130700L,130700L,130700L,130800L,130800L,130800L,
            130800L,130800L,130800L,130800L,130800L,130800L,130800L,
            130800L,130900L,130900L,130900L,130900L,130900L,
            130900L,130900L,130900L,130900L,130900L,130900L,
            130900L,130900L,130900L,130900L,130900L,131000L,131000L,
            131000L,131000L,131000L,131000L,131000L,131000L,
            131000L,131000L,131100L,131100L,131100L,131100L,
            131100L,131100L,131100L,131100L,131100L,131100L,131100L,
            410100L,410100L,410100L,410100L,410100L,410100L,
            410100L,410100L,410100L,410100L,410100L,410100L,
            410200L,410200L,410200L,410200L,410200L,410200L,410200L,
            410200L,410200L,410300L,410300L,410300L,410300L,
            410300L,410300L,410300L,410300L,410300L,410300L,
            410300L,410300L,410300L,410300L,410300L,410400L,410400L,
            410400L,410400L,410400L,410400L,410400L,410400L,
            410400L,410400L,410500L,410500L,410500L,410500L,
            410500L,410500L,410500L,410500L,410500L,410600L,410600L,
            410600L,410600L,410600L,410700L,410700L,410700L,
            410700L,410700L,410700L,410700L,410700L,410700L,
            410700L,410700L,410700L,410800L,410800L,410800L,410800L,
            410800L,410800L,410800L,410800L,410800L,410800L,
            410900L,410900L,410900L,410900L,410900L,410900L,
            411000L,411000L,411000L,411000L,411000L,411000L,411100L,
            411100L,411100L,411100L,411100L,411200L,411200L,
            411200L,411200L,411200L,411200L,411300L,411300L,
            411300L,411300L,411300L,411300L,411300L,411300L,411300L,
            411300L,411300L,411300L,411300L,411400L,411400L,
            411400L,411400L,411400L,411400L,411400L,411400L,
            411400L,411500L,411500L,411500L,411500L,411500L,411500L,
            411500L,411500L,411500L,411500L,411600L,411600L,
            411600L,411600L,411600L,411600L,411600L,411600L,
            411600L,411600L,411700L,411700L,411700L,411700L,411700L,
            411700L,411700L,411700L,411700L,411700L,419001L,
            370100L,370100L,370100L,370100L,370100L,370100L,
            370100L,370100L,370100L,370100L,370100L,370100L,370200L,
            370200L,370200L,370200L,370200L,370200L,370200L,
            370200L,370200L,370200L,370300L,370300L,370300L,
            370300L,370300L,370300L,370300L,370300L,370400L,370400L,
            370400L,370400L,370400L,370400L,370500L,370500L,
            370500L,370500L,370500L,370600L,370600L,370600L,
            370600L,370600L,370600L,370600L,370600L,370600L,370600L,
            370600L,370600L,370700L,370700L,370700L,370700L,
            370700L,370700L,370700L,370700L,370700L,370700L,
            370700L,370700L,370800L,370800L,370800L,370800L,370800L,
            370800L,370800L,370800L,370800L,370800L,370800L,
            370900L,370900L,370900L,370900L,370900L,370900L,
            371000L,371000L,371000L,371000L,371100L,371100L,371100L,
            371100L,371300L,371300L,371300L,371300L,371300L,
            371300L,371300L,371300L,371300L,371300L,371300L,
            371300L,371400L,371400L,371400L,371400L,371400L,371400L,
            371400L,371400L,371400L,371400L,371400L,371500L,
            371500L,371500L,371500L,371500L,371500L,371500L,
            371500L,371600L,371600L,371600L,371600L,371600L,371600L,
            371600L,371700L,371700L,371700L,371700L,371700L,
            371700L,371700L,371700L,371700L,140100L,140100L,
            140100L,140100L,140100L,140100L,140100L,140100L,140100L,
            140100L,140200L,140200L,140200L,140200L,140200L,
            140200L,140200L,140200L,140200L,140200L,140300L,
            140300L,140300L,140300L,140300L,140400L,140400L,140400L,
            140400L,140400L,140400L,140400L,140400L,140400L,
            140400L,140400L,140400L,140500L,140500L,140500L,
            140500L,140500L,140500L,140600L,140600L,140600L,140600L,
            140600L,140600L,140700L,140700L,140700L,140700L,
            140700L,140700L,140700L,140700L,140700L,140700L,
            140700L,140800L,140800L,140800L,140800L,140800L,140800L,
            140800L,140800L,140800L,140800L,140800L,140800L,
            140800L,140900L,140900L,140900L,140900L,140900L,
            140900L,140900L,140900L,140900L,140900L,140900L,140900L,
            140900L,140900L,141000L,141000L,141000L,141000L,
            141000L,141000L,141000L,141000L,141000L,141000L,
            141000L,141000L,141000L,141000L,141000L,141000L,141000L,
            141100L,141100L,141100L,141100L,141100L,141100L,
            141100L,141100L,141100L,141100L,141100L,141100L,
            141100L),
    市 = c("北京市","北京市","北京市","北京市",
          "北京市","北京市","北京市","北京市","北京市","北京市","北京市","北京市",
          "北京市","北京市","北京市","北京市","天津市","天津市","天津市","天津市","天津市",
          "天津市","天津市","天津市","天津市","天津市","天津市","天津市","天津市",
          "天津市","天津市","天津市","石家庄市","石家庄市","石家庄市","石家庄市",
          "石家庄市","石家庄市","石家庄市","石家庄市","石家庄市","石家庄市","石家庄市",
          "石家庄市","石家庄市","石家庄市","石家庄市","石家庄市","石家庄市","石家庄市",
          "石家庄市","石家庄市","石家庄市","石家庄市","唐山市","唐山市","唐山市","唐山市",
          "唐山市","唐山市","唐山市","唐山市","唐山市","唐山市","唐山市","唐山市",
          "唐山市","唐山市","秦皇岛市","秦皇岛市","秦皇岛市","秦皇岛市","秦皇岛市","秦皇岛市",
          "秦皇岛市","邯郸市","邯郸市","邯郸市","邯郸市","邯郸市","邯郸市","邯郸市",
          "邯郸市","邯郸市","邯郸市","邯郸市","邯郸市","邯郸市","邯郸市","邯郸市",
          "邯郸市","邯郸市","邯郸市","邢台市","邢台市","邢台市","邢台市","邢台市",
          "邢台市","邢台市","邢台市","邢台市","邢台市","邢台市","邢台市","邢台市",
          "邢台市","邢台市","邢台市","邢台市","邢台市","邢台市","保定市","保定市",
          "保定市","保定市","保定市","保定市","保定市","保定市","保定市","保定市",
          "保定市","保定市","保定市","保定市","保定市","保定市","保定市","保定市",
          "保定市","保定市","保定市","保定市","保定市","保定市","张家口市","张家口市",
          "张家口市","张家口市","张家口市","张家口市","张家口市","张家口市","张家口市",
          "张家口市","张家口市","张家口市","张家口市","张家口市","张家口市","张家口市","承德市",
          "承德市","承德市","承德市","承德市","承德市","承德市","承德市","承德市",
          "承德市","承德市","沧州市","沧州市","沧州市","沧州市","沧州市","沧州市",
          "沧州市","沧州市","沧州市","沧州市","沧州市","沧州市","沧州市","沧州市",
          "沧州市","沧州市","廊坊市","廊坊市","廊坊市","廊坊市","廊坊市","廊坊市",
          "廊坊市","廊坊市","廊坊市","廊坊市","衡水市","衡水市","衡水市","衡水市",
          "衡水市","衡水市","衡水市","衡水市","衡水市","衡水市","衡水市","郑州市",
          "郑州市","郑州市","郑州市","郑州市","郑州市","郑州市","郑州市","郑州市","郑州市",
          "郑州市","郑州市","开封市","开封市","开封市","开封市","开封市","开封市",
          "开封市","开封市","开封市","洛阳市","洛阳市","洛阳市","洛阳市","洛阳市",
          "洛阳市","洛阳市","洛阳市","洛阳市","洛阳市","洛阳市","洛阳市","洛阳市",
          "洛阳市","洛阳市","平顶山市","平顶山市","平顶山市","平顶山市","平顶山市",
          "平顶山市","平顶山市","平顶山市","平顶山市","平顶山市","安阳市","安阳市","安阳市",
          "安阳市","安阳市","安阳市","安阳市","安阳市","安阳市","鹤壁市","鹤壁市",
          "鹤壁市","鹤壁市","鹤壁市","新乡市","新乡市","新乡市","新乡市","新乡市",
          "新乡市","新乡市","新乡市","新乡市","新乡市","新乡市","新乡市","焦作市",
          "焦作市","焦作市","焦作市","焦作市","焦作市","焦作市","焦作市","焦作市",
          "焦作市","濮阳市","濮阳市","濮阳市","濮阳市","濮阳市","濮阳市","许昌市","许昌市",
          "许昌市","许昌市","许昌市","许昌市","漯河市","漯河市","漯河市","漯河市",
          "漯河市","三门峡市","三门峡市","三门峡市","三门峡市","三门峡市","三门峡市",
          "南阳市","南阳市","南阳市","南阳市","南阳市","南阳市","南阳市","南阳市",
          "南阳市","南阳市","南阳市","南阳市","南阳市","商丘市","商丘市","商丘市",
          "商丘市","商丘市","商丘市","商丘市","商丘市","商丘市","信阳市","信阳市",
          "信阳市","信阳市","信阳市","信阳市","信阳市","信阳市","信阳市","信阳市","周口市",
          "周口市","周口市","周口市","周口市","周口市","周口市","周口市","周口市",
          "周口市","驻马店市","驻马店市","驻马店市","驻马店市","驻马店市","驻马店市",
          "驻马店市","驻马店市","驻马店市","驻马店市","济源市","济南市","济南市","济南市",
          "济南市","济南市","济南市","济南市","济南市","济南市","济南市","济南市",
          "济南市","青岛市","青岛市","青岛市","青岛市","青岛市","青岛市","青岛市",
          "青岛市","青岛市","青岛市","淄博市","淄博市","淄博市","淄博市","淄博市",
          "淄博市","淄博市","淄博市","枣庄市","枣庄市","枣庄市","枣庄市","枣庄市",
          "枣庄市","东营市","东营市","东营市","东营市","东营市","烟台市","烟台市",
          "烟台市","烟台市","烟台市","烟台市","烟台市","烟台市","烟台市","烟台市",
          "烟台市","烟台市","潍坊市","潍坊市","潍坊市","潍坊市","潍坊市","潍坊市","潍坊市",
          "潍坊市","潍坊市","潍坊市","潍坊市","潍坊市","济宁市","济宁市","济宁市",
          "济宁市","济宁市","济宁市","济宁市","济宁市","济宁市","济宁市","济宁市",
          "泰安市","泰安市","泰安市","泰安市","泰安市","泰安市","威海市","威海市",
          "威海市","威海市","日照市","日照市","日照市","日照市","临沂市","临沂市",
          "临沂市","临沂市","临沂市","临沂市","临沂市","临沂市","临沂市","临沂市",
          "临沂市","临沂市","德州市","德州市","德州市","德州市","德州市","德州市",
          "德州市","德州市","德州市","德州市","德州市","聊城市","聊城市","聊城市","聊城市",
          "聊城市","聊城市","聊城市","聊城市","滨州市","滨州市","滨州市","滨州市",
          "滨州市","滨州市","滨州市","菏泽市","菏泽市","菏泽市","菏泽市","菏泽市",
          "菏泽市","菏泽市","菏泽市","菏泽市","太原市","太原市","太原市","太原市",
          "太原市","太原市","太原市","太原市","太原市","太原市","大同市","大同市",
          "大同市","大同市","大同市","大同市","大同市","大同市","大同市","大同市",
          "阳泉市","阳泉市","阳泉市","阳泉市","阳泉市","长治市","长治市","长治市",
          "长治市","长治市","长治市","长治市","长治市","长治市","长治市","长治市","长治市",
          "晋城市","晋城市","晋城市","晋城市","晋城市","晋城市","朔州市","朔州市",
          "朔州市","朔州市","朔州市","朔州市","晋中市","晋中市","晋中市","晋中市",
          "晋中市","晋中市","晋中市","晋中市","晋中市","晋中市","晋中市","运城市",
          "运城市","运城市","运城市","运城市","运城市","运城市","运城市","运城市",
          "运城市","运城市","运城市","运城市","忻州市","忻州市","忻州市","忻州市",
          "忻州市","忻州市","忻州市","忻州市","忻州市","忻州市","忻州市","忻州市",
          "忻州市","忻州市","临汾市","临汾市","临汾市","临汾市","临汾市","临汾市","临汾市",
          "临汾市","临汾市","临汾市","临汾市","临汾市","临汾市","临汾市","临汾市",
          "临汾市","临汾市","吕梁市","吕梁市","吕梁市","吕梁市","吕梁市","吕梁市",
          "吕梁市","吕梁市","吕梁市","吕梁市","吕梁市","吕梁市","吕梁市"),
    类型 = c("市辖区","市辖区","市辖区","市辖区",
           "市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区",
           "市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区",
           "市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区",
           "市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区",
           "市辖区","市辖区","市辖区","县","县","县","县","县","县","县",
           "县","县","县","县","县级市","县级市","县级市","市辖区","市辖区",
           "市辖区","市辖区","市辖区","市辖区","市辖区","县","县","县","县","县级市",
           "县级市","县级市","市辖区","市辖区","市辖区","市辖区","自治县","县",
           "县","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","县","县",
           "县","县","县","县","县","县","县","县","县","县级市","市辖区",
           "市辖区","县","县","县","县","县","县","县","县","县","县",
           "县","县","县","县","县","县级市","县级市","市辖区","市辖区",
           "市辖区","市辖区","市辖区","县","县","县","县","县","县","县","县",
           "县","县","县","县","县","县","县","县级市","县级市","县级市",
           "县级市","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","县","县",
           "县","县","县","县","县","县","县","县","市辖区","市辖区",
           "市辖区","县","县","县","县","自治县","自治县","自治县","县级市",
           "市辖区","市辖区","县","县","县","县","县","县","县","县","县",
           "自治县","县级市","县级市","县级市","县级市","市辖区","市辖区","县","县",
           "县","县","县","自治县","县级市","县级市","市辖区","市辖区","县",
           "县","县","县","县","县","县","县","县级市","市辖区","市辖区",
           "市辖区","市辖区","市辖区","市辖区","县","县级市","县级市","县级市","县级市",
           "县级市","市辖区","市辖区","市辖区","市辖区","市辖区","县","县","县",
           "县","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","县","县",
           "县","县","县","县","县","县","县级市","市辖区","市辖区",
           "市辖区","市辖区","县","县","县","县","县级市","县级市","市辖区","市辖区",
           "市辖区","市辖区","县","县","县","县","县级市","市辖区","市辖区",
           "市辖区","县","县","市辖区","市辖区","市辖区","市辖区","县","县","县",
           "县","县","县级市","县级市","县级市","市辖区","市辖区","市辖区",
           "市辖区","县","县","县","县","县级市","县级市","市辖区","县","县",
           "县","县","县","市辖区","市辖区","县","县","县级市","县级市","市辖区",
           "市辖区","市辖区","县","县","市辖区","市辖区","县","县","县级市",
           "县级市","市辖区","市辖区","县","县","县","县","县","县","县",
           "县","县","县","县级市","市辖区","市辖区","县","县","县","县","县",
           "县","县级市","市辖区","市辖区","县","县","县","县","县","县",
           "县","县","市辖区","市辖区","县","县","县","县","县","县",
           "县","县级市","市辖区","县","县","县","县","县","县","县","县",
           "县","县级市","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区",
           "市辖区","市辖区","市辖区","市辖区","县","县","市辖区","市辖区","市辖区",
           "市辖区","市辖区","市辖区","市辖区","县级市","县级市","县级市","市辖区",
           "市辖区","市辖区","市辖区","市辖区","县","县","县","市辖区","市辖区",
           "市辖区","市辖区","市辖区","县级市","市辖区","市辖区","市辖区","县","县",
           "市辖区","市辖区","市辖区","市辖区","县","县级市","县级市","县级市",
           "县级市","县级市","县级市","县级市","市辖区","市辖区","市辖区","市辖区","县",
           "县","县级市","县级市","县级市","县级市","县级市","县级市","市辖区",
           "市辖区","县","县","县","县","县","县","县","县级市","县级市",
           "市辖区","市辖区","县","县","县级市","县级市","市辖区","市辖区","县级市",
           "县级市","市辖区","市辖区","县","县","市辖区","市辖区","市辖区","县",
           "县","县","县","县","县","县","县","县","市辖区","市辖区","县",
           "县","县","县","县","县","县","县级市","县级市","市辖区","市辖区",
           "县","县","县","县","县","县级市","市辖区","市辖区","县","县",
           "县","县","县级市","市辖区","市辖区","县","县","县","县","县",
           "县","县","市辖区","市辖区","市辖区","市辖区","市辖区","市辖区","县",
           "县","县","县级市","市辖区","市辖区","市辖区","市辖区","县","县",
           "县","县","县","县","市辖区","市辖区","市辖区","县","县","市辖区",
           "市辖区","市辖区","市辖区","县","县","县","县","县","县","县",
           "县","市辖区","县","县","县","县","县级市","市辖区","市辖区","县",
           "县","县","县级市","市辖区","市辖区","县","县","县","县","县",
           "县","县","县","县级市","市辖区","县","县","县","县","县","县",
           "县","县","县","县","县级市","县级市","市辖区","县","县","县",
           "县","县","县","县","县","县","县","县","县","县级市","市辖区",
           "县","县","县","县","县","县","县","县","县","县","县",
           "县","县","县","县级市","县级市","市辖区","县","县","县","县",
           "县","县","县","县","县","县","县级市","县级市"),
    id = c(0L,1L,2L,3L,4L,5L,6L,7L,
           8L,9L,10L,11L,12L,13L,14L,15L,16L,17L,18L,19L,
           20L,21L,22L,23L,24L,25L,26L,27L,28L,29L,30L,
           31L,32L,33L,34L,35L,36L,37L,38L,39L,40L,41L,
           42L,43L,44L,45L,46L,47L,48L,49L,50L,51L,52L,53L,
           54L,55L,56L,57L,58L,59L,60L,61L,62L,63L,64L,
           65L,66L,67L,68L,69L,70L,71L,72L,73L,74L,75L,76L,
           77L,78L,79L,80L,81L,82L,83L,84L,85L,86L,87L,
           88L,89L,90L,91L,92L,93L,94L,95L,96L,97L,98L,
           99L,100L,101L,102L,103L,104L,105L,106L,107L,108L,
           109L,110L,111L,112L,113L,114L,115L,116L,117L,
           118L,119L,120L,121L,122L,123L,124L,125L,126L,127L,
           128L,129L,130L,131L,132L,133L,134L,135L,136L,
           137L,138L,139L,140L,141L,142L,143L,144L,145L,146L,
           147L,148L,149L,150L,151L,152L,153L,154L,155L,
           156L,157L,158L,159L,160L,161L,162L,163L,164L,165L,
           166L,167L,168L,169L,170L,171L,172L,173L,174L,
           175L,176L,177L,178L,179L,180L,181L,182L,183L,184L,
           185L,186L,187L,188L,189L,190L,191L,192L,193L,
           194L,195L,196L,197L,198L,199L,1331L,1332L,1333L,
           1334L,1335L,1336L,1337L,1338L,1339L,1340L,1341L,
           1342L,1343L,1344L,1345L,1346L,1347L,1348L,1349L,1350L,
           1351L,1352L,1353L,1354L,1355L,1356L,1357L,1358L,
           1359L,1360L,1361L,1362L,1363L,1364L,1365L,1366L,
           1367L,1368L,1369L,1370L,1371L,1372L,1373L,1374L,
           1375L,1376L,1377L,1378L,1379L,1380L,1381L,1382L,
           1383L,1384L,1385L,1386L,1387L,1388L,1389L,1390L,
           1391L,1392L,1393L,1394L,1395L,1396L,1397L,1398L,
           1399L,1400L,1401L,1402L,1403L,1404L,1405L,1406L,1407L,
           1408L,1409L,1410L,1411L,1412L,1413L,1414L,1415L,
           1416L,1417L,1418L,1419L,1420L,1421L,1422L,1423L,
           1424L,1425L,1426L,1427L,1428L,1429L,1430L,1431L,
           1432L,1433L,1434L,1435L,1436L,1437L,1438L,1439L,
           1440L,1441L,1442L,1443L,1444L,1445L,1446L,1447L,
           1448L,1449L,1450L,1451L,1452L,1453L,1454L,1455L,
           1456L,1457L,1458L,1459L,1460L,1461L,1462L,1463L,1464L,
           1465L,1466L,1467L,1468L,1469L,1470L,1471L,1472L,
           1473L,1474L,1475L,1476L,1477L,1478L,1479L,1480L,
           1481L,1482L,1483L,1484L,1485L,1486L,1487L,1488L,
           1194L,1195L,1196L,1197L,1198L,1199L,1200L,1201L,
           1202L,1203L,1204L,1205L,1206L,1207L,1208L,1209L,
           1210L,1211L,1212L,1213L,1214L,1215L,1216L,1217L,
           1218L,1219L,1220L,1221L,1222L,1223L,1224L,1225L,1226L,
           1227L,1228L,1229L,1230L,1231L,1232L,1233L,1234L,
           1235L,1236L,1237L,1238L,1239L,1240L,1241L,1242L,
           1243L,1244L,1245L,1246L,1247L,1248L,1249L,1250L,
           1251L,1252L,1253L,1254L,1255L,1256L,1257L,1258L,
           1259L,1260L,1261L,1262L,1263L,1264L,1265L,1266L,
           1267L,1268L,1269L,1270L,1271L,1272L,1273L,1274L,
           1275L,1276L,1277L,1278L,1279L,1280L,1281L,1282L,1283L,
           1284L,1285L,1286L,1287L,1288L,1289L,1290L,1291L,
           1292L,1293L,1294L,1295L,1296L,1297L,1298L,1299L,
           1300L,1301L,1302L,1303L,1304L,1305L,1306L,1307L,
           1308L,1309L,1310L,1311L,1312L,1313L,1314L,1315L,
           1316L,1317L,1318L,1319L,1320L,1321L,1322L,1323L,
           1324L,1325L,1326L,1327L,1328L,1329L,1330L,200L,201L,
           202L,203L,204L,205L,206L,207L,208L,209L,210L,
           211L,212L,213L,214L,215L,216L,217L,218L,219L,220L,
           221L,222L,223L,224L,225L,226L,227L,228L,229L,
           230L,231L,232L,233L,234L,235L,236L,237L,238L,239L,
           240L,241L,242L,243L,244L,245L,246L,247L,248L,
           249L,250L,251L,252L,253L,254L,255L,256L,257L,258L,
           259L,260L,261L,262L,263L,264L,265L,266L,267L,
           268L,269L,270L,271L,272L,273L,274L,275L,276L,277L,
           278L,279L,280L,281L,282L,283L,284L,285L,286L,
           287L,288L,289L,290L,291L,292L,293L,294L,295L,296L,
           297L,298L,299L,300L,301L,302L,303L,304L,305L,
           306L,307L,308L,309L,310L,311L,312L,313L,314L,315L,
           316L),
    hg = c(0,0,0.009586146,0,
           0.000477676,0.001658155,0.000276935,0.009896014,0.014903748,
           0.01492261,0.005262216,0.011606874,0.002484482,
           0.007960612,0.000207626,0.002071924,0,0.000173108,
           0.000315986,0.000211475,0.000208504,0.006795766,0.000254623,
           0.003599734,0.003490056,0.001462242,0.026821991,
           0.010054839,0.004374197,0.007689982,0.008602544,0.001760013,
           0.001441461,0.000688591,0.000207078,0,7.7e-06,
           0.043171849,0.013563588,0.012074015,0.000245568,
           0.014174622,0,2.21e-05,0.000435325,0.000981502,4.48e-05,
           3.85e-07,0.000567732,2.93e-05,5.77e-05,0.001055596,
           0.001572328,0.000115471,0.00402666,0.003355775,0.000224398,
           0.000249994,0.000269624,0,0.000386635,0.000156463,
           0.000242104,0,0.000312734,0,0,0.000292334,0,0,0,
           0,0,0,0,0.001999955,0.003500883,0.000885661,
           0.003791485,0.00207809,0.007044106,0.000234983,0.002581158,
           0,0,0,1.08e-05,0.000292911,0,0,0,0.000327167,0,
           0.004583615,0.002318462,0.006132656,0.000187255,
           0.002159882,0.000737089,0.003082879,0.002956246,
           0.002796896,0.003021102,0.001090045,0.000153961,0.000616037,
           0.000799636,0.000583898,0.001256515,0.000250187,
           0.001000747,0.001841952,0,0,0.006498698,0.008860654,
           0.014152682,0.009109879,0.000263658,0.031647668,
           0.000239217,0.000472661,0,0,6.72e-05,0,0.000353918,0,0,
           9.43e-05,0,0,0.025005016,0.005814149,0,0.023106291,0,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0.001318869,0.004250866,
           0.002825764,0.004708131,0,0.0003085,0.000620848,0.011187391,
           0.001032117,0.000568886,0.000290409,0.000387212,
           0.000489789,0.017425126,0.000519426,0.001477642,
           0.018188965,0.008489415,0.011821519,0.018237271,0.016188626,
           0.017412039,0.011569215,0.004918672,0.029606144,
           0.022593023,0.006935371,0.006974246,0.003119829,0,0,0,
           0.001636799,0,0,0,1.37e-05,0.000915119,0.001838294,
           0.000542283,0.000465095,9.29e-05,9.29e-05,0.000123326,
           0.002317601,0.004681559,0.000198355,0.001120645,
           0.007161408,0.001012188,0.002697199,0.003077015,
           0.002827084,0.000306127,0.000218006,0.000770566,0,0.002007757,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0.001604981,0.001287702,0.008052019,
           0.001766791,0.002931168,0.001000161,0.002739401,
           0.00119324,0.002844359,0.000952274,0.002412063,
           0.001644559,0.003953851,0.008153595,0.001517297,0.002208489,
           0.001012406,0.001308038,0.002442239,0.001255996,
           0.002164756,0.003188533,0.001709502,0.000803147,0.001168968,
           0.003928288,0.002444426,0.001485591,0.001551627,
           0.002611702,0.000881865,0.000931064,0.001380852,
           0.001244188,0.001166563,0.001223853,0.00010299,0.004619459,
           0.001609354,0.003430155,0.000359699,0.009228422,0,0,0,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,0.000169962,0.002469155,
           0.007413968,0.001980123,0.005562775,0.000728728,
           0.001984159,0.001302518,0,0,0.00186958,0.00261535,0,0,
           0,0,0,0,0,0,0,0,0.011942763,0.007498582,
           0.011024713,0.006299994,0.005715856,0.00730129,0.00338162,
           0.002214901,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0,0.001602081,0.001504543,0.000773573,0.000766398,
           0.000739939,0.00078456,0.000777833,0.000672672,
           0.00078882,0.001542213,0.001509476,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0.002175422,0.00149109,0.001148476,0.000813261,0.001455438,
           0.003024783,0.00112112,0.000799807,0.001104303,
           0.001589076,0.001243995,0.002801904,0.003988946,
           0.000755411,0.003910692,0.001797156,0.00125117,0.000733661,
           0.002500322,0.00202721,0.000853397,0.000887479,
           0.001787738,0.003061555,0.001028292,0.001302966,0.002648535,
           0.002496287,0.00227408,0.00244023,0.002287982,
           0.002524987,0.002493596,0.002280358,0.002673648,0.020628861,
           0.001037117,0.003388279,0.012476358,0.001322189,
           0.013246866,0.021554664,0.007001899,0,0,0,0,0,0,0,0,
           0,0,0,0,0.007181087,0.00349742,0.005651475,
           0.003913353,0.01012031,0,0,0.004209285,0.003540317,0,0,
           0,0.009171158,0.002282201,0,0,0,0.003114067,
           0.00835341,0.00605872,0.005325679,0.009409532,0.011967574,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
           0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
)
ddddd$hg <- ddddd$hg*1000

# okokok <- read.csv('E://Rdata//coal//country.csv')
okokok <- data.frame(
    省代码 = c(110000L,120000L,
            130000L,130000L,130000L,130000L,130000L,130000L,
            130000L,130000L,140000L,140000L,140000L,140000L,
            140000L,140000L,140000L,140000L,370000L,370000L,
            370000L,370000L,370000L,370000L,370000L,410000L,
            410000L,410000L,410000L,410000L,410000L,410000L,
            410000L,410000L,410000L,610000L,610000L,610000L,
            610000L,610000L),
    省 = c("北京市","天津市","河北省",
          "河北省","河北省","河北省","河北省","河北省","河北省","河北省","山西省",
          "山西省","山西省","山西省","山西省","山西省","山西省","山西省",
          "山东省","山东省","山东省","山东省","山东省","山东省","山东省","河南省",
          "河南省","河南省","河南省","河南省","河南省","河南省","河南省",
          "河南省","河南省","陕西省","陕西省","陕西省","陕西省","陕西省"),
    市代码 = c(110000L,120000L,
            130100L,130200L,130600L,130900L,130400L,131100L,
            131000L,130500L,140500L,140100L,140300L,140400L,
            140700L,141000L,141100L,140800L,370100L,370300L,
            370800L,371400L,371500L,371600L,371700L,410600L,
            419001L,410800L,410200L,410300L,410900L,411200L,
            410700L,410100L,410500L,610100L,610200L,610300L,
            610400L,610500L),
    市 = c("北京市","天津市","石家庄市",
          "唐山市","保定市","沧州市","邯郸市","衡水市","廊坊市","邢台市","晋城市",
          "太原市","阳泉市","长治市","晋中市","临汾市","吕梁市","运城市",
          "济南市","淄博市","济宁市","德州市","聊城市","滨州市","菏泽市","鹤壁市",
          "济源市","焦作市","开封市","洛阳市","濮阳市","三门峡市","新乡市",
          "郑州市","安阳市","西安市","铜川市","宝鸡市","咸阳市","渭南市"),
    类型 = c("直辖市","直辖市","地级市",
           "地级市","地级市","地级市","地级市","地级市","地级市","地级市","地级市",
           "地级市","地级市","地级市","地级市","地级市","地级市","地级市",
           "副省级市","地级市","地级市","地级市","地级市","地级市","地级市","地级市",
           "地级市","地级市","地级市","地级市","地级市","地级市","地级市",
           "地级市","地级市","副省级市","地级市","地级市","地级市","地级市"),
    批次 = c("2+26","2+26","2+26",
           "2+26","2+26","2+26","2+26","2+26","2+26",
           "2+26","2+26","2+26","2+26","2+26","第二批汾渭平原",
           "第二批汾渭平原","第二批汾渭平原","第二批汾渭平原","2+26","2+26","2+26",
           "2+26","2+26","2+26","2+26","2+26","第二批","2+26",
           "2+26","第二批汾渭平原","2+26","第二批汾渭平原","2+26","2+26",
           "2+26","第二批汾渭平原","第二批汾渭平原","第二批汾渭平原","第二批汾渭平原",
           "第二批汾渭平原"),
    id = c(0L,1L,2L,3L,7L,10L,
           5L,12L,11L,6L,17L,13L,15L,16L,19L,22L,23L,
           20L,134L,136L,141L,146L,147L,148L,149L,155L,
           167L,157L,151L,152L,158L,161L,156L,150L,
           154L,307L,308L,309L,310L,311L),
    coal_consume1 = c(145.5,49.8,118.75,
                      26.8,183.4764706,35.5,56.4,24,222.3727273,45.3,
                      13.25,36.3,14.7,25.8,0,0,0,0,27.3,23.4,11.8,
                      14.4,27.6,12.6,21.4,8.4,0,22.8,18.6,0,27.3,
                      0,30.6,33.9,33,0,0,0,0,0),
    coal_group1 = c("100+","30-50","100+",
                    "10-30","100+","30-50","50-100","10-30","100+",
                    "30-50","10-30","30-50","10-30","10-30","0-10",
                    "0-10","0-10","0-10","10-30","10-30","10-30",
                    "10-30","10-30","10-30","10-30","0-10","0-10",
                    "10-30","10-30","0-10","10-30","0-10","30-50",
                    "30-50","30-50","0-10","0-10","0-10","0-10",
                    "0-10"),
    Hg_total1 = c(333.64605,114.19638,
                  177.590625,40.0794,274.3890618,53.09025,84.3462,
                  35.892,332.5584136,67.74615,22.457425,61.52487,
                  24.91503,43.72842,0,0,0,0,48.99258,41.99364,
                  21.17628,25.84224,49.53096,22.61196,38.40444,
                  16.7496,0,45.4632,37.0884,0,54.4362,0,61.0164,
                  67.5966,65.802,0,0,0,0,0),
    Hg_01 = c(273.589761,93.6410316,
              145.6243125,32.865108,224.9990306,43.534005,
              69.163884,29.43144,272.6978992,55.551843,18.4150885,
              50.4503934,20.4303246,35.8573044,0,0,0,0,
              40.1739156,34.4347848,17.3645496,21.1906368,40.6153872,
              18.5418072,31.4916408,13.734672,0,37.279824,
              30.412488,0,44.637684,0,50.033448,55.429212,
              53.95764,0,0,0,0,0),
    `Hg_2+1` = c(56.7198285,19.4133846,
                 30.19040625,6.813498,46.6461405,9.0253425,
                 14.338854,6.10164,56.53493032,11.5168455,3.81776225,
                 10.4592279,4.2355551,7.4338314,0,0,0,0,8.3287386,
                 7.1389188,3.5999676,4.3931808,8.4202632,
                 3.8440332,6.5287548,2.847432,0,7.728744,6.305028,0,
                 9.254154,0,10.372788,11.491422,11.18634,0,0,0,0,
                 0),
    Hg_p1 = c(3.3364605,1.1419638,
              1.77590625,0.400794,2.743890618,0.5309025,0.843462,
              0.35892,3.325584136,0.6774615,0.22457425,
              0.6152487,0.2491503,0.4372842,0,0,0,0,0.4899258,
              0.4199364,0.2117628,0.2584224,0.4953096,0.2261196,
              0.3840444,0.167496,0,0.454632,0.370884,0,
              0.544362,0,0.610164,0.675966,0.65802,0,0,0,0,0),
    group1 = c("200-334","100-200",
               "100-200","30-50","200-334","50-100","50-100",
               "30-50","200-334","50-100","0-30","50-100","0-30",
               "30-50","0","0","0","0","30-50","30-50","0-30",
               "0-30","30-50","0-30","30-50","0-30","0",
               "30-50","30-50","0","50-100","0","50-100","50-100",
               "50-100","0","0","0","0","0"),
    coal_consume2 = c(49.9101,30.9204,
                      83.478,58.9156,81.89638529,58.63225,114.15,82.2933,
                      20.85562273,45.9372,18.098,28.2234,7.8561,35.0271,
                      24.997,25.1818,20.127,26.6408,6.5211,22.4722,
                      27.9056,9.8634,30.9957,8.0952,15.1042,15.962,
                      5.3628,29.1681,25.8558,18.1569,38.3055,10.1175,
                      43.9662,58.6086,32.5089,187.8699,10.8705,28.7391,
                      32.6949,35.5551),
    coal_group2 = c("30-50","30-50",
                    "50-100","50-100","50-100","50-100","100+","50-100",
                    "10-30","30-50","10-30","10-30","0-10","30-50",
                    "10-30","10-30","10-30","10-30","0-10","10-30",
                    "10-30","0-10","30-50","0-10","10-30","10-30",
                    "0-10","10-30","10-30","10-30","30-50","10-30",
                    "30-50","50-100","30-50","100+","10-30","10-30",
                    "30-50","30-50"),
    Hg_total2 = c(114.4488503,
                  70.90356924,124.841349,88.1082798,122.4760442,87.68452988,
                  170.711325,123.0696302,31.18958379,68.6990826,
                  30.6743002,47.83584066,13.31530389,59.36743179,
                  42.3674153,42.68063282,34.1132523,45.15349192,
                  11.70276606,40.32861012,50.07938976,17.70085764,
                  55.62488322,14.52764592,27.10599732,31.828228,10.6934232,
                  58.1611914,51.5564652,36.2048586,76.381167,
                  20.174295,87.6686028,116.8655484,64.8227466,393.3432096,
                  22.75956585,60.17105367,68.45331213,74.44171287),
    Hg_02 = c(93.84805725,
              58.14092678,102.3699062,72.24878944,100.4303563,71.9013145,
              139.9832865,100.9170967,25.57545871,56.33324773,
              25.15292616,39.22538934,10.91854919,48.68129407,
              34.74128055,34.99811891,27.97286689,37.02586337,
              9.596268169,33.0694603,41.0650996,14.51470326,
              45.61240424,11.91266965,22.2269178,26.09914696,
              8.768607024,47.69217695,42.27630146,29.68798405,
              62.63255694,16.5429219,71.8882543,95.82974969,53.15465221,
              322.5414319,18.662844,49.34026401,56.13171595,
              61.04220455),
    `Hg_2+2` = c(19.45630455,
                 12.05360677,21.22302933,14.97840757,20.82092752,14.90637008,
                 29.02092525,20.92183713,5.302229244,11.67884404,
                 5.214631034,8.132092912,2.263601661,10.0924634,
                 7.202460601,7.255707579,5.799252891,7.676093626,
                 1.98947023,6.85586372,8.513496259,3.009145799,
                 9.456230147,2.469699806,4.608019544,5.41079876,
                 1.817881944,9.887402538,8.764599084,6.154825962,
                 12.98479839,3.42963015,14.90366248,19.86714323,
                 11.01986692,66.86834564,3.869126195,10.22907912,11.63706306,
                 12.65509119),
    Hg_p2 = c(1.144488503,
              0.709035692,1.24841349,0.881082798,1.224760442,0.876845299,
              1.70711325,1.230696302,0.311895838,0.686990826,
              0.306743002,0.478358407,0.133153039,0.593674318,
              0.423674153,0.426806328,0.341132523,0.451534919,
              0.117027661,0.403286101,0.500793898,0.177008576,
              0.556248832,0.145276459,0.271059973,0.31828228,
              0.106934232,0.581611914,0.515564652,0.362048586,
              0.76381167,0.20174295,0.876686028,1.168655484,
              0.648227466,3.933432096,0.227595659,0.601710537,0.684533121,
              0.744417129),
    group2 = c("100-200","50-100",
               "100-200","50-100","100-200","50-100","100-200",
               "100-200","30-50","50-100","30-50","30-50","0-30",
               "50-100","30-50","30-50","30-50","30-50","0-30",
               "30-50","50-100","0-30","50-100","0-30","0-30",
               "30-50","0-30","50-100","50-100","30-50",
               "50-100","0-30","50-100","100-200","50-100","200-393",
               "0-30","50-100","50-100","50-100"),
    coal_consume3 = c(11.7,54.51,58.11175,
                      145.0488,37.21208529,53.47575,134.8604,65.8539,0,
                      51.7065,20.35,9,19.62,66.18,37.85,20.9,23.26,
                      32.1,12.3,20,10,20.6712,32.1,7.4,12.6,9.238,
                      5.568,37.11,20.4,44.46,40.5,15.93,42.9,
                      39.003,42.57,31.74,16.47,73.38,53.82,148.8),
    coal_group3 = c("10-30","50-100",
                    "50-100","100+","30-50","50-100","100+","50-100",
                    "0-10","50-100","10-30","0-10","10-30","50-100",
                    "30-50","10-30","10-30","30-50","10-30","10-30",
                    "10-30","10-30","30-50","0-10","10-30","0-10",
                    "0-10","30-50","10-30","30-50","30-50","10-30",
                    "30-50","30-50","30-50","30-50","10-30","50-100",
                    "50-100","100+"),
    Hg_total3 = c(26.82927,124.996881,
                  86.90612213,216.9204804,55.65067356,79.97298413,
                  201.6837282,98.48450745,0,77.32707075,34.491215,
                  15.2541,33.253938,112.168482,64.151965,35.42341,
                  39.423374,54.40629,22.07358,35.892,17.946,
                  37.09653552,57.60666,13.28004,22.61196,18.420572,
                  11.102592,73.99734,40.6776,88.65324,80.757,31.76442,
                  85.5426,77.766,84.88458,66.454038,34.483239,
                  153.635706,112.682934,311.54256),
    Hg_03 = c(22.0000014,102.4974424,
              71.26302014,177.8747939,45.63355232,65.57784698,
              165.3806571,80.75729611,0,63.40819802,28.2827963,
              12.508362,27.26822916,91.97815524,52.6046113,
              29.0471962,32.32716668,44.6131578,18.1003356,
              29.43144,14.71572,30.41915913,47.2374612,10.8896328,
              18.5418072,15.10486904,9.10412544,60.6778188,
              33.355632,72.6956568,66.22074,26.0468244,70.144932,
              63.76812,69.6053556,54.49231116,28.27625598,
              125.9812789,92.40000588,255.4648992),
    `Hg_2+3` = c(4.5609759,21.24946977,
                 14.77404076,36.87648167,9.460614505,13.5954073,
                 34.28623379,16.74236627,0,13.14560203,5.86350655,
                 2.593197,5.65316946,19.06864194,10.90583405,
                 6.0219797,6.70197358,9.2490693,3.7525086,6.10164,
                 3.05082,6.306411038,9.7931322,2.2576068,3.8440332,
                 3.13149724,1.88744064,12.5795478,6.915192,
                 15.0710508,13.72869,5.3999514,14.542242,13.22022,
                 14.4303786,11.29718646,5.86215063,26.11807002,19.15609878,
                 52.9622352),
    Hg_p3 = c(0.2682927,1.24996881,
              0.869061221,2.169204804,0.556506736,0.799729841,
              2.016837282,0.984845075,0,0.773270708,0.34491215,
              0.152541,0.33253938,1.12168482,0.64151965,
              0.3542341,0.39423374,0.5440629,0.2207358,0.35892,
              0.17946,0.370965355,0.5760666,0.1328004,0.2261196,
              0.18420572,0.11102592,0.7399734,0.406776,0.8865324,
              0.80757,0.3176442,0.855426,0.77766,0.8488458,
              0.66454038,0.34483239,1.53635706,1.12682934,3.1154256),
    group3 = c("0-30","100-200",
               "50-100","200-312","50-100","50-100","200-312",
               "50-100","0","50-100","30-50","0-30","30-50",
               "100-200","50-100","30-50","30-50","50-100","0-30",
               "30-50","0-30","30-50","50-100","0-30","0-30",
               "0-30","0-30","50-100","30-50","50-100","50-100",
               "30-50","50-100","50-100","50-100","50-100",
               "30-50","100-200","100-200","200-312"),
    coal_consume4 = c(0,0,8.97475,140.6812,
                      150.2029324,17.5335,86.874,44.0031,0,103.248,
                      13.313,4.9062,19.8,71.4774,21.73325,23.5508,
                      38.744,29.2762,110.4,21.02,56.74,58.1644,77.1,0,
                      40.08,2.54,3.15,20.85,25.65,43.68,16.77,27.78,
                      5.58,30.39,32.64,9.63,5.55,66.75,44.88,93.48),
    coal_group4 = c("0-10","0-10","0-10",
                    "100+","100+","10-30","50-100","30-50","0-10",
                    "100+","10-30","0-10","10-30","50-100","10-30",
                    "10-30","30-50","10-30","100+","10-30","50-100",
                    "50-100","50-100","0-10","30-50","0-10","0-10",
                    "10-30","10-30","30-50","10-30","10-30","0-10",
                    "30-50","30-50","0-10","0-10","50-100","30-50",
                    "50-100"),
    Hg_total4 = c(0,0,13.42173863,
                  210.3887346,224.6284853,26.22134925,129.920067,
                  65.80663605,0,154.407384,22.5642037,8.31551838,
                  33.55902,121.1470453,36.83568543,39.91625092,65.6672056,
                  49.62023138,198.12384,37.722492,101.825604,
                  104.3818322,138.36366,0,71.927568,5.06476,6.2811,
                  41.5749,51.1461,87.09792,33.43938,55.39332,11.12652,
                  60.59766,65.08416,20.162331,11.620035,
                  139.754475,93.965256,195.719076),
    Hg_04 = c(0,0,11.00582567,
              172.5187624,184.195358,21.50150639,106.5344549,
              53.96144156,0,126.6140549,18.50264703,6.818725072,
              27.5183964,99.34057711,30.20526205,32.73132575,
              53.84710859,40.68858973,162.4615488,30.93244344,
              83.49699528,85.59310244,113.4582012,0,58.98060576,
              4.1531032,5.150502,34.091418,41.939802,71.4202944,
              27.4202916,45.4225224,9.1237464,49.6900812,
              53.3690112,16.53311142,9.5284287,114.5986695,77.05150992,
              160.4896423),
    `Hg_2+4` = c(0,0,2.281695566,
                 35.76608488,38.18684251,4.457629373,22.08641139,
                 11.18712813,0,26.24925528,3.835914629,1.413638125,
                 5.7050334,20.59499769,6.262066522,6.785762656,
                 11.16342495,8.435439335,33.6810528,6.41282364,
                 17.31035268,17.74491148,23.5218222,0,12.22768656,
                 0.8610092,1.067787,7.067733,8.694837,14.8066464,
                 5.6846946,9.4168644,1.8915084,10.3016022,11.0643072,
                 3.42759627,1.97540595,23.75826075,15.97409352,
                 33.27224292),
    Hg_p4 = c(0,0,0.134217386,
              2.103887346,2.246284853,0.262213493,1.29920067,
              0.658066361,0,1.54407384,0.225642037,0.083155184,
              0.3355902,1.211470453,0.368356854,0.399162509,
              0.656672056,0.496202314,1.9812384,0.37722492,1.01825604,
              1.043818322,1.3836366,0,0.71927568,0.0506476,
              0.062811,0.415749,0.511461,0.8709792,0.3343938,
              0.5539332,0.1112652,0.6059766,0.6508416,0.20162331,
              0.11620035,1.39754475,0.93965256,1.95719076),
    group4 = c("0","0","0-30",
               "200-225","200-225","0-30","100-200","50-100","0",
               "100-200","0-30","0-30","30-50","100-200","30-50",
               "30-50","50-100","30-50","100-200","30-50",
               "100-200","100-200","100-200","0","50-100","0-30",
               "0-30","30-50","50-100","50-100","30-50","50-100",
               "0-30","50-100","50-100","0-30","0-30",
               "100-200","50-100","100-200"),
    coal_consume5 = c(207.1101,135.2304,
                      269.3145,371.4456,452.7878735,165.1415,392.2844,
                      216.1503,243.22835,246.1917,65.011,78.4296,61.9761,
                      198.4845,84.58025,69.6326,82.131,88.017,
                      156.5211,86.8922,106.4456,103.099,167.7957,28.0952,
                      89.1842,36.14,14.0808,109.9281,90.5058,106.2969,
                      122.8755,53.8275,123.0462,161.9016,140.7189,
                      229.2399,32.8905,168.8691,131.3949,277.8351),
    coal_group5 = c("200-300","100-200",
                    "200-300","300+","300+","100-200","300+",
                    "200-300","200-300","200-300","50-100","50-100","50-100",
                    "100-200","50-100","50-100","50-100","50-100",
                    "100-200","50-100","100-200","100-200","100-200",
                    "0-50","50-100","0-50","0-50","100-200",
                    "50-100","100-200","100-200","50-100","100-200",
                    "100-200","100-200","200-300","0-50","100-200",
                    "100-200","200-300"),
    Hg_total5 = c(474.9241703,
                  310.0968302,402.7598348,555.4968948,677.1442649,246.9691133,
                  586.6613202,323.2527737,363.7479974,368.1796874,
                  110.1871439,132.930329,105.0432919,336.4113791,
                  143.3550657,118.0202937,139.2038319,149.1800133,
                  280.8927661,155.9367421,191.0272738,185.0214654,
                  301.1261632,50.41964592,160.0499653,72.06316,
                  28.0771152,219.1966314,180.4685652,211.9560186,
                  245.013747,107.332035,245.3541228,322.8258084,280.5934866,
                  479.9595786,68.86283985,353.5612347,275.1015021,
                  581.7033489),
    Hg_05 = c(389.4378197,
              254.2794008,330.2630645,455.5074537,555.2582972,202.5146729,
              481.0622826,265.0672744,298.2733579,301.9073436,
              90.353458,109.0028698,86.13549935,275.8573308,
              117.5511539,96.77664086,114.1471422,122.3276109,
              230.3320682,127.8681285,156.6423645,151.7176016,
              246.9234538,41.34410965,131.2409716,59.0917912,
              23.02323446,179.7412377,147.9842235,173.8039353,
              200.9112725,88.0122687,201.1903807,264.7171629,
              230.086659,393.5668545,56.46752868,289.9202124,225.5832317,
              476.9967461),
    `Hg_2+5` = c(80.73710895,
                 52.71646114,68.46917191,94.43447212,115.114525,41.98474925,
                 99.73242443,54.95297152,61.83715956,62.59054685,
                 18.73181446,22.59815594,17.85735962,57.18993444,
                 24.37036117,20.06344994,23.66465142,25.36060226,
                 47.75177023,26.50924616,32.47463654,31.45364912,
                 51.19144775,8.571339806,27.2084941,12.2507372,
                 4.773109584,37.26342734,30.67965608,36.03252316,
                 41.65233699,18.24644595,41.71020088,54.88038743,
                 47.70089272,81.59312837,11.70668277,60.10540989,
                 46.76725536,98.88956931),
    Hg_p5 = c(4.749241703,
              3.100968302,4.027598348,5.554968948,6.771442649,2.469691133,
              5.866613202,3.232527737,3.637479974,3.681796874,
              1.101871439,1.32930329,1.050432919,3.364113791,
              1.433550657,1.180202937,1.392038319,1.491800133,
              2.808927661,1.559367421,1.910272738,1.850214654,
              3.011261632,0.504196459,1.600499653,0.7206316,
              0.280771152,2.191966314,1.804685652,2.119560186,
              2.45013747,1.07332035,2.453541228,3.228258084,
              2.805934866,4.799595786,0.688628399,3.535612347,2.751015021,
              5.817033489),
    group5 = c("400-500","300-400",
               "400-500","500-677","500-677","200-300","500-677",
               "300-400","300-400","300-400","100-200",
               "100-200","100-200","300-400","100-200","100-200",
               "100-200","100-200","200-300","100-200","100-200",
               "100-200","300-400","0-100","100-200","0-100",
               "0-100","200-300","100-200","200-300","200-300",
               "100-200","200-300","300-400","200-300","400-500",
               "0-100","300-400","200-300","500-677"),
    gas_num = c(21.9686,55.2261,
                81.9692,67.2516,122.0666,61.3268,80.9014,70.4394,
                79.5155,50.742,11.1726,16.3832,6.6722,27.5022,
                4.2868,15.1689,5.561,7.3162,44.2768,23.218,25.0944,
                43.0115,44.8049,10.7238,13.199,0.3,0.0915,
                1.2117,1.2797,0.7378,6.475,0.047,2.1338,1.9864,
                7.9952,14.7843,6.3414,24.9995,22.2583,47.2588),
    electricity_num = c(47.0681,34.855,
                        24.9956,24.8895,17.8334,4.714,15.3497,1.5217,8.2062,
                        29.2179,2.2888,7.2064,7.5986,10.5872,4.4692,
                        5.0977,15.1,18.986,7.3236,15.7281,24.678,5.5865,
                        11.11,3.2538,25.7231,14.888,3.1021,30.881,
                        15.2389,23.5745,24.0935,14.5355,31.6346,28.3298,
                        33.9381,61.0693,4.6221,31.2902,21.11,42.6416),
    others_num = c(0,0.0725,0.761,
                   0.7203,0.7355,0.0158,1.82,0.089,0,2.104,12.543,
                   2.5536,6.3879,28.0721,25.0761,14.5497,20.4045,
                   17.7063,0.5733,4.5,3.4504,2.9515,0.017,0.07,5.67,
                   2.882,1.5,4.55,13.65,11.12,10.39,3.36,7.247,
                   23.651,4.973,0.5597,0,0,0.43,2.7113),
    gas_equality = c(54.2058,82.83915,
                     204.923,269.0064,394.4036294,153.317,323.6056,
                     211.3182,220.4747955,152.226,27.9315,49.1496,20.0166,
                     82.5066,10.717,30.3378,11.122,14.6324,132.8304,
                     46.436,50.1888,86.023,134.4147,21.4476,26.398,
                     0.6,0.2745,3.6351,3.8391,2.2134,19.425,0.141,
                     6.4014,5.9592,23.9856,44.3529,19.0242,74.9985,
                     66.7749,141.7764),
    electricity_equality = c(141.2043,52.2825,
                             62.489,99.558,56.10217059,11.785,61.3988,4.5651,
                             22.75355455,87.6537,5.722,21.6192,22.7958,31.7616,
                             11.173,10.1954,30.2,37.972,21.9708,31.4562,
                             49.356,11.173,33.33,6.5076,51.4462,29.776,9.3063,
                             92.643,45.7167,70.7235,72.2805,43.6065,94.9038,
                             84.9894,101.8143,183.2079,13.8663,93.8706,63.33,
                             127.9248),
    others_equality = c(0,0.10875,1.9025,
                        2.8812,2.282073529,0.0395,7.28,0.267,0,6.312,
                        31.3575,7.6608,19.1637,84.2163,62.69025,29.0994,
                        40.809,35.4126,1.7199,9,6.9008,5.903,0.051,0.14,
                        11.34,5.764,4.5,13.65,40.95,33.36,31.17,10.08,
                        21.741,70.953,14.919,1.6791,0,0,1.29,8.1339)
)

```


```{r paged.print=FALSE}
num_trans <- data.frame(id = c(0L, 1L, 2L, 16L, 15L, 3L, 27L),省 = c("北京市", "天津市", "河北省", "河南省", "山东省", "山西省", "陕西省"),改造户数.万户 = c(69.0367,90.1536,747.1861,325.7961,314.9637,287.3401,280.0765))


#    六省县区级
mapProvinceMask <- which(mapDF$省 ==c('北京市','河南省','山东省','山西省','天津市','河北省'))   # '天津市','河北省',
aimProvinceMap<- mapDF[mapProvinceMask,]
aimProvinceMap <- merge(aimProvinceMap, ddddd, by = "id")

#    七省省际
mapProvinceMask1 <- which(mapDF1$省 ==c('北京市','河南省','山东省','山西省','天津市','河北省',"陕西省"))   
aimProvinceMap1<- mapDF1[mapProvinceMask1,]
aimProvinceMap1 <- merge(aimProvinceMap1, num_trans, by = "id")




#   2+26个市县区级
mapProvinceMask2 <- which(mapDF$市 ==c('北京市','天津市','保定市','沧州市','邯郸市','衡水市','廊坊市','石家庄市','唐山市','邢台市','安阳市','鹤壁市','焦作市','开封市','濮阳市','新乡市','郑州市','滨州市','德州市','菏泽市','济南市','济宁市','聊城市','淄博市','晋城市','太原市','阳泉市','长治市'))
aimProvinceMap2<- mapDF[mapProvinceMask2,]
aimProvinceMap2 <- merge(aimProvinceMap2, ddddd, by = "id")



#  2+26个市市级 
mapProvinceMask3 <- which(mapDF2$市 ==c('北京市','天津市','保定市','沧州市','邯郸市','衡水市','廊坊市','石家庄市','唐山市','邢台市','安阳市','鹤壁市','焦作市','开封市','濮阳市','新乡市','郑州市','滨州市','德州市','菏泽市','济南市','济宁市','聊城市','淄博市','晋城市','太原市','阳泉市','长治市'))
aimProvinceMap3<- mapDF2[mapProvinceMask3,]
aimProvinceMap3 <- merge(aimProvinceMap3, okokok, by = "id")
aimProvinceMap3



#  2+26及周边省江苏、安徽、山西、辽宁、内蒙古省级
mapProvinceMask4 <- which(mapDF1$省 ==c('北京市','河南省','山东省','山西省','天津市','河北省',"江苏省","安徽省","内蒙古自治区","辽宁省","山西省"))
aimProvinceMap4<- mapDF1[mapProvinceMask4,]
aimProvinceMap4 <- merge(aimProvinceMap4, ddddd, by = "id")
aimProvinceMap4




#  2+26个市市级 + 第二批汾渭平原改造市级  张家口市没有改造的 不画
mapProvinceMask5 <- which(mapDF2$市 ==c('北京市','天津市','保定市','沧州市','邯郸市','衡水市','廊坊市','石家庄市','唐山市','邢台市','安阳市','鹤壁市','焦作市','开封市','濮阳市','新乡市','郑州市','滨州市','德州市','菏泽市','济南市','济宁市','聊城市','淄博市','晋城市','太原市','阳泉市','长治市',"晋中市","临汾市","吕梁市","运城市","济源市","洛阳市","三门峡市","西安市","铜川市","宝鸡市","咸阳市","渭南市"))
aimProvinceMap5<- mapDF2[mapProvinceMask5,]
aimProvinceMap5 <- merge(aimProvinceMap5, okokok, by = "id")
aimProvinceMap5



#  2+26及周边省山西、陕西 + 内蒙古、江苏、安徽省级1
mapProvinceMask6 <- which(mapDF1$省 ==c('北京市','河南省','山东省','山西省','天津市','河北省',"陕西省","内蒙古自治区","江苏省","安徽省"))
aimProvinceMap6 <- mapDF1[mapProvinceMask6,]
aimProvinceMap6 <- merge(aimProvinceMap6, ddddd, by = "id")
aimProvinceMap6


#  2+26及周边省山西、陕西 + 内蒙古、江苏、安徽省级2
mapProvinceMask7 <- which(mapDF1$省 ==c('北京市','河南省','山东省','山西省','天津市','河北省',"陕西省","内蒙古自治区","江苏省","安徽省"))
aimProvinceMap7 <- mapDF1[mapProvinceMask7,]
aimProvinceMap7 <- merge(aimProvinceMap7, num_trans, by = "id")
aimProvinceMap7

```






```{r}
ggplot(data=aimProvinceMap,aes(x=long,y=lat,group=group))+

  geom_polygon(colour="white",alpha = 0.1) +
  geom_polygon(data=aimProvinceMap2,aes(x=long,y=lat,group=group,fill = hg)) +
  # geom_polygon(data=aimMap1,fill=c('#ffa500'))+
  geom_polygon(colour="white",alpha = 0.1) +
  scale_fill_gradient(low = 'deepskyblue2', high = 'red') +
  geom_polygon(data=aimProvinceMap1,colour="grey20",alpha = 0.1) +
 
  coord_equal()+
  theme(
    panel.grid = element_blank(),
    panel.background = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank()
  )

```


## 2017-2020年改造户数省级地图

```{r}

ggplot(data = aimProvinceMap6, color = "black",aes(x=long,y=lat,group=group))+
  geom_polygon(fill="white", color = "black") +
  
  geom_polygon(data=aimProvinceMap1,aes(x=long,y=lat,group=group,fill = 改造户数.万户),color = "black") +
  scale_fill_gradientn(colours = c("#8EC31F","#DADF00","#F7EE14","#F39800","#EA5412"))+
  # geom_polygon(colour="white",alpha = 0.1) +
  # geom_polygon() +
  # geom_polygon(data=aimProvinceMap1,colour="white",alpha = 0.1) +
  coord_equal()+
  theme_bw() +
  theme(
    legend.title = element_text(size=8)
  )
ggsave("E://Rdata//Rimage//Provincial modification number in 2017-2020.svg")
```







```{r paged.print=FALSE}
ggplot(data = aimProvinceMap6, aes(x=long,y=lat,group=group)) +  # 加七省边界
  geom_polygon(fill="white", color = "black") +
  
  geom_polygon(data=aimProvinceMap5,aes(x=long,y=lat,group=group,fill = group1),colour="white") +
  # scale_fill_gradientn(low = 'white', mid = "deepskyblue3", midpoint = 160, high = 'deepskyblue4') +  # 市级颜色
  scale_fill_manual(values = list(
    "0" = "#E8E8E8",
    "0-30" = "#ACE4E4",
    "30-50" = "#5AC8C8",
    "50-100" = "#5698B9",
    "100-200" = "#4664A0",
    "200-334" = "#3B4994"
    )) +

  # scale_fill_gradientn(colors = blues9) +
  # geom_polygon() +
  # geom_polygon(colour="white",alpha = 0.1) +  #  2+26个市市级 + 第二批汾渭平原改造市级
  
  
  # geom_polygon(data=aimProvinceMap5) +    #  2+26个市市级 + 第二批汾渭平原改造市级
  
  # geom_polygon() +
  
  coord_equal()+
  labs(fill = "Municipal mercury reduction in 2016-2017(Unit:kg)") +
  theme_bw() +
  theme(
    # panel.grid = element_blank(),
    # panel.background = element_blank(),
    # axis.text = element_blank(),
    # axis.ticks = element_blank(),
    # axis.title = element_blank(),
    # legend.key.width = unit(1, "cm"),
    # legend.key.height = unit(1.95, "cm"),
    legend.title = element_text(size=8)
  )



# ggsave("E://Rdata//Rimage//Municipal_Hg_reduction_in 2017.svg", plot = last_plot())

```


```{r}
ggplot(data = aimProvinceMap6, aes(x=long,y=lat,group=group)) +
  geom_polygon(fill="white", color = "black") +
  
  geom_polygon(data=aimProvinceMap5,aes(x=long,y=lat,group=group,fill = group2),colour="white") +
  # scale_fill_gradient(low = 'deepskyblue2', high = 'red') +  # 市级颜色
    scale_fill_manual(values = list(
    "0" = "#E8E8E8",
    "0-30" = "#ACE4E4",
    "30-50" = "#5AC8C8",
    "50-100" = "#5698B9",
    "100-200" = "#4664A0",
    "200-393" = "#3B4994"
    )) +
  # geom_polygon() +
  # geom_polygon(colour="white",alpha = 0.1) +  #  2+26个市市级 + 第二批汾渭平原改造市级
  

  
  # geom_polygon() +
  
  coord_equal()+
  labs(fill = "Municipal mercury reduction in 2018(Unit:kg)") +
  theme_bw() +
  theme(
    # panel.grid = element_blank(),
    # panel.background = element_blank(),
    # axis.text = element_blank(),
    # axis.ticks = element_blank(),
    # axis.title = element_blank(),
    # legend.key.width = unit(1, "cm"),
    # legend.key.height = unit(1.95, "cm"),
    legend.title = element_text(size=8)
  )

ggsave("E://Rdata//Rimage//Municipal_Hg_reduction_in 2018.svg", plot = last_plot())

ggplot(data = aimProvinceMap6, aes(x=long,y=lat,group=group)) +
  geom_polygon(fill="white", color = "black") +
  
  geom_polygon(data=aimProvinceMap5,aes(x=long,y=lat,group=group,fill = group3),colour="white") +
  # scale_fill_gradient(low = 'deepskyblue2', high = 'red') +  # 市级颜色
    scale_fill_manual(values = list(
    "0" = "#E8E8E8",
    "0-30" = "#ACE4E4",
    "30-50" = "#5AC8C8",
    "50-100" = "#5698B9",
    "100-200" = "#4664A0",
    "200-312" = "#3B4994"
    )) +
  # geom_polygon() +
  # geom_polygon(colour="white",alpha = 0.1) +  #  2+26个市市级 + 第二批汾渭平原改造市级
  
  

  
  # geom_polygon() +
  
  coord_equal()+
  labs(fill = "Municipal mercury reduction in 2019(Unit:kg)") +
  theme_bw() +
  theme(
    # panel.grid = element_blank(),
    # panel.background = element_blank(),
    # axis.text = element_blank(),
    # axis.ticks = element_blank(),
    # axis.title = element_blank(),
    # legend.key.width = unit(1, "cm"),
    # legend.key.height = unit(1.95, "cm"),
    legend.title = element_text(size=8)
  )

ggsave("E://Rdata//Rimage//Municipal_Hg_reduction_in 2019.svg", plot = last_plot())


ggplot(data = aimProvinceMap6, aes(x=long,y=lat,group=group)) +
  geom_polygon(fill="white", color = "black") +
  
  geom_polygon(data=aimProvinceMap5,aes(x=long,y=lat,group=group,fill = group4),colour="white") +
  # scale_fill_gradient(low = 'deepskyblue2', high = 'red') +  # 市级颜色
    scale_fill_manual(values = list(
    "0" = "#E8E8E8",
    "0-30" = "#ACE4E4",
    "30-50" = "#5AC8C8",
    "50-100" = "#5698B9",
    "100-200" = "#4664A0",
    "200-225" = "#3B4994"
    )) +
  # geom_polygon() +
  # geom_polygon(colour="white",alpha = 0.1) +  #  2+26个市市级 + 第二批汾渭平原改造市级
  
  # geom_polygon() +
  
  coord_equal()+
  labs(fill = "Municipal mercury reduction in 2020(Unit:kg)") +
  theme_bw() +
  theme(
    # panel.grid = element_blank(),
    # panel.background = element_blank(),
    # axis.text = element_blank(),
    # axis.ticks = element_blank(),
    # axis.title = element_blank(),
    # legend.key.width = unit(1, "cm"),
    # legend.key.height = unit(1.95, "cm"),
    legend.title = element_text(size=8)
  )

ggsave("E://Rdata//Rimage//Municipal_Hg_reduction_in 2020.svg", plot = last_plot())


```

```{r}

ggplot(data = aimProvinceMap6, aes(x=long,y=lat,group=group)) +
  geom_polygon(fill="white",color = "black") +
  
  geom_polygon(data=aimProvinceMap5,aes(x=long,y=lat,group=group,fill = group5),colour="white") +
  # scale_fill_gradient(low = 'deepskyblue2', high = 'red') +  # 市级颜色
  

    scale_fill_manual(values = list(
    "0-100" = "#E8E8E8",
    "100-200" = "#ACE4E4",
    "200-300" = "#5AC8C8",
    "300-400" = "#5698B9",
    "400-500" = "#4664A0",
    "500-677" = "#3B4994"
    )) +

  
  # geom_polygon() +
  
  coord_equal()+
  labs(fill = "Municipal mercury reduction in 2016-2020(Unit:kg)") +
  theme_bw() +
  theme(
    # panel.grid = element_blank(),
    # panel.background = element_blank(),
    # axis.text = element_blank(),
    # axis.ticks = element_blank(),
    # axis.title = element_blank(),
    # legend.key.width = unit(1, "cm"),
    # legend.key.height = unit(1.95, "cm"),
    legend.title = element_text(size=8)
  )

ggsave("E://Rdata//Rimage//Municipal_Hg_reduction_in 2016-2020.svg", plot = last_plot())
```


## 以下为社会实践绘图

```{r}

ggplot(data = aimProvinceMap6, aes(x=long,y=lat,group=group)) +  # 加七省边界
  geom_polygon(fill="white", color = "black") +
  
  geom_polygon(data=aimProvinceMap5,aes(x=long,y=lat,group=group,fill = coal_group1),colour="white") +
  # scale_fill_gradientn(low = 'white', mid = "deepskyblue3", midpoint = 160, high = 'deepskyblue4') +  # 市级颜色
  scale_fill_manual(values = list(
    "0-10" = "#E8E8E8",
    "10-30" = "#DFB0D6",
    "30-50" = "#BE64AC",
    "50-100" = "#8C62AA",
    "100+" = "#3B4994"
    )) +
  
  # scale_fill_gradientn(colors = blues9) +
  # geom_polygon() +
  # geom_polygon(colour="white",alpha = 0.1) +  #  2+26个市市级 + 第二批汾渭平原改造市级
  
  
  # geom_polygon(data=aimProvinceMap5) +    #  2+26个市市级 + 第二批汾渭平原改造市级
  
  # geom_polygon() +
  
  coord_equal()+
  labs(fill = "Municipal coal consumption in 2017(Unit:10000tons)") +
  theme_bw() +
  theme(
    # panel.grid = element_blank(),
    # panel.background = element_blank(),
    # axis.text = element_blank(),
    # axis.ticks = element_blank(),
    # axis.title = element_blank(),
    # legend.key.width = unit(1, "cm"),
    # legend.key.height = unit(1.95, "cm"),
    legend.title = element_text(size=8)
  )



ggsave("E://Rdata//Rimage//Municipal_coalconsumption_in 2017.svg", plot = last_plot())



ggplot(data = aimProvinceMap6, aes(x=long,y=lat,group=group)) +  # 加七省边界
  geom_polygon(fill="white", color = "black") +
  
  geom_polygon(data=aimProvinceMap5,aes(x=long,y=lat,group=group,fill = coal_group2),colour="white") +
  # scale_fill_gradientn(low = 'white', mid = "deepskyblue3", midpoint = 160, high = 'deepskyblue4') +  # 市级颜色
  scale_fill_manual(values = list(
    "0-10" = "#E8E8E8",
    "10-30" = "#DFB0D6",
    "30-50" = "#BE64AC",
    "50-100" = "#8C62AA",
    "100+" = "#3B4994"
    )) +

  # scale_fill_gradientn(colors = blues9) +
  # geom_polygon() +
  # geom_polygon(colour="white",alpha = 0.1) +  #  2+26个市市级 + 第二批汾渭平原改造市级
  
  
  # geom_polygon(data=aimProvinceMap5) +    #  2+26个市市级 + 第二批汾渭平原改造市级
  
  # geom_polygon() +
  
  coord_equal()+
  labs(fill = "Municipal coal consumption in 2018(Unit:10000tons)") +
  theme_bw() +
  theme(
    # panel.grid = element_blank(),
    # panel.background = element_blank(),
    # axis.text = element_blank(),
    # axis.ticks = element_blank(),
    # axis.title = element_blank(),
    # legend.key.width = unit(1, "cm"),
    # legend.key.height = unit(1.95, "cm"),
    legend.title = element_text(size=8)
  )



ggsave("E://Rdata//Rimage//Municipal_coalconsumption_in 2018.svg", plot = last_plot())





ggplot(data = aimProvinceMap6, aes(x=long,y=lat,group=group)) +  # 加七省边界
  geom_polygon(fill="white", color = "black") +
  
  geom_polygon(data=aimProvinceMap5,aes(x=long,y=lat,group=group,fill = coal_group3),colour="white") +
  # scale_fill_gradientn(low = 'white', mid = "deepskyblue3", midpoint = 160, high = 'deepskyblue4') +  # 市级颜色
  scale_fill_manual(values = list(
    "0-10" = "#E8E8E8",
    "10-30" = "#DFB0D6",
    "30-50" = "#BE64AC",
    "50-100" = "#8C62AA",
    "100+" = "#3B4994"
    )) +

  # scale_fill_gradientn(colors = blues9) +
  # geom_polygon() +
  # geom_polygon(colour="white",alpha = 0.1) +  #  2+26个市市级 + 第二批汾渭平原改造市级
  
  
  # geom_polygon(data=aimProvinceMap5) +    #  2+26个市市级 + 第二批汾渭平原改造市级
  
  # geom_polygon() +
  
  coord_equal()+
  labs(fill = "Municipal coal consumption in 2019(Unit:10000tons)") +
  theme_bw() +
  theme(
    # panel.grid = element_blank(),
    # panel.background = element_blank(),
    # axis.text = element_blank(),
    # axis.ticks = element_blank(),
    # axis.title = element_blank(),
    # legend.key.width = unit(1, "cm"),
    # legend.key.height = unit(1.95, "cm"),
    legend.title = element_text(size=8)
  )



ggsave("E://Rdata//Rimage//Municipal_coalconsumption_in 2019.svg", plot = last_plot())




ggplot(data = aimProvinceMap6, aes(x=long,y=lat,group=group)) +  # 加七省边界
  geom_polygon(fill="white", color = "black") +
  
  geom_polygon(data=aimProvinceMap5,aes(x=long,y=lat,group=group,fill = coal_group4),colour="white") +
  # scale_fill_gradientn(low = 'white', mid = "deepskyblue3", midpoint = 160, high = 'deepskyblue4') +  # 市级颜色
  scale_fill_manual(values = list(
    "0-10" = "#E8E8E8",
    "10-30" = "#DFB0D6",
    "30-50" = "#BE64AC",
    "50-100" = "#8C62AA",
    "100+" = "#3B4994"
    )) +

  # scale_fill_gradientn(colors = blues9) +
  # geom_polygon() +
  # geom_polygon(colour="white",alpha = 0.1) +  #  2+26个市市级 + 第二批汾渭平原改造市级
  
  
  # geom_polygon(data=aimProvinceMap5) +    #  2+26个市市级 + 第二批汾渭平原改造市级
  
  # geom_polygon() +
  
  coord_equal()+
  labs(fill = "Municipal coal consumption in 2020(Unit:10000tons)") +
  theme_bw() +
  theme(
    # panel.grid = element_blank(),
    # panel.background = element_blank(),
    # axis.text = element_blank(),
    # axis.ticks = element_blank(),
    # axis.title = element_blank(),
    # legend.key.width = unit(1, "cm"),
    # legend.key.height = unit(1.95, "cm"),
    legend.title = element_text(size=8)
  )



ggsave("E://Rdata//Rimage//Municipal_coalconsumption_in 2020.svg", plot = last_plot())



ggplot(data = aimProvinceMap6, aes(x=long,y=lat,group=group)) +  # 加七省边界
  geom_polygon(fill="white", color = "black") +
  
  geom_polygon(data=aimProvinceMap5,aes(x=long,y=lat,group=group,fill = coal_group5),colour="white") +
  # scale_fill_gradientn(low = 'white', mid = "deepskyblue3", midpoint = 160, high = 'deepskyblue4') +  # 市级颜色
  scale_fill_manual(values = list(
    "0-50" = "#E8E8E8",
    "50-100" = "#DFB0D6",
    "100-200" = "#BE64AC",
    "200-300" = "#8C62AA",
    "300+" = "#3B4994"
    )) +

  # scale_fill_gradientn(colors = blues9) +
  # geom_polygon() +
  # geom_polygon(colour="white",alpha = 0.1) +  #  2+26个市市级 + 第二批汾渭平原改造市级
  
  
  # geom_polygon(data=aimProvinceMap5) +    #  2+26个市市级 + 第二批汾渭平原改造市级
  
  # geom_polygon() +
  
  coord_equal()+
  labs(fill = "Municipal coal consumption in 2017-2020(Unit:10000tons)") +
  theme_bw() +
  theme(
    # panel.grid = element_blank(),
    # panel.background = element_blank(),
    # axis.text = element_blank(),
    # axis.ticks = element_blank(),
    # axis.title = element_blank(),
    # legend.key.width = unit(1, "cm"),
    # legend.key.height = unit(1.95, "cm"),
    legend.title = element_text(size=8)
  )



ggsave("E://Rdata//Rimage//Municipal_coalconsumption_in 2017-2020.svg", plot = last_plot())
```





```{r paged.print=FALSE}

position <- read.csv('E://Rdata//coal//beijingposition.csv')
head(position)
position$long <- round(as.numeric(position$long),8)
position$long <- 6378137*pi*position$long/180
position$lat <- round(as.numeric(position$lat),8)
position$lat <- 6378137*log(tan(pi/4+position$lat*pi/360))

position <- position[order(position$remodeled_household_k,decreasing = F),]
position$remodeled_household_k <- position$remodeled_household_k*0.001
head(position)
CO2 <- log(position$remodeled_household_k+1)
hist(CO2)

```









```{r}
p1 <- position[position$sheng == "河北",]
p2 <- position[position$sheng == "河南",]
p3 <- position[position$sheng == "山东",]
p4 <- position[position$sheng == "山西",]
p5 <- position[position$sheng == "天津",]
p6 <- position[position$sheng == "北京",]
```



```{r paged.print=FALSE}
# for(i in c("沧州","邯郸","衡水","保定","廊坊","石家庄","唐山","邢台")){
#   sum(p1[p1$cheng == i,]$remodeled_household_k)
# }
# 
# for(i in c("安阳","鹤壁","焦作","开封","濮阳","新乡","郑州")){
#   print(sum(p2[p2$cheng == i,]$remodeled_household_k))
# }

# for(i in c("滨州","德州","菏泽","济南","济宁","聊城","淄博")){
#   print(sum(p3[p3$cheng == i,]$remodeled_household_k))
# }
# 
# for(i in c("晋城","太原","阳泉","长治")){
#   print(sum(p4[p4$cheng == i,]$remodeled_household_k))
# }
# # Cangzhou ='#7cb5ec',
#             Handan ='#434348',
#             Hengshui = '#90ed7d', 
#             Baoding ='#f7a35c', 
#             Langfang ='#8085e9', 
#             Shijiazhuang ='#f15c80',
#             Tangshan = '#e4d354',
#             Anyang = '#8085e8',
#             Xingtai ='#8d4653',
#             Hebi = '#91e8e1', 
#             Jiaozuo ='#ff7f50',
#             Kaifeng = '#87cefa', 
#             Puyang = '#da70d6',
#             Xinxiang = '#32cd32', 
#             Zhenzhou ='#ff69b4',
#             Binzhou ='#6495ed',
#             Dezhou = '#ba55d3',
#             Heze = '#cd5c5c', 
#             Jinan ='#ffa500', 
#             Liaocheng ='#40e0d0',
#             Jining = '#1e90ff', 
#             Zibo ='#ff6347',
#             Jincheng ='#7b68ee', 
#             Taiyuan ='#00fa9a', 
#             Yangquan ='#ffd700', 
#             Changzhi ='#6b8e23', 
#             Beijing ='#ff00ff', 
#             Tianjin ='#3cb371',
#             Zhangjiakou = '#f15c80',
#             Jinzhong = '#8085e8',
#             Linfen = '#ba55d3',
#             Lvliang = '#8085e8',
#             Yuncheng = '#8085e9',
#             Jiyuan = '#434348',
#             Luoyang = '#91e8e1',
#             Sanmenxia = '#434348',
#             Xian = '#6495ed',
#             Tongchuan = '#7cb5ec',
#             Baoji = '#f7a35c',
#             Xianyang = '#87cefa',
#             Weinan = '#6495ed'
d1 <- data.frame(
  stringsAsFactors = FALSE,
             sheng = c("Beijinshi","Tianjinshi",
                       "Hebei","Hebei","Hebei","Hebei","Hebei","Hebei","Hebei",
                       "Hebei","Shanxi","Shanxi","Shanxi","Shanxi",
                       "Shandong","Shandong","Shandong","Shandong","Shandong",
                       "Shandong","Shandong","Henan","Henan","Henan","Henan",
                       "Henan","Henan","Henan","Shanxi","Shanxi","Shanxi",
                       "Shanxi","Henan","Henan","Henan","Shaanxi","Shaanxi",
                       "Shaanxi","Shaanxi","Shaanxi","Beijinshi",
                       "Tianjinshi","Hebei","Hebei","Hebei","Hebei","Hebei","Hebei",
                       "Hebei","Hebei","Shanxi","Shanxi","Shanxi",
                       "Shanxi","Shandong","Shandong","Shandong","Shandong",
                       "Shandong","Shandong","Shandong","Henan","Henan","Henan",
                       "Henan","Henan","Henan","Henan","Shanxi","Shanxi",
                       "Shanxi","Shanxi","Henan","Henan","Henan","Shaanxi",
                       "Shaanxi","Shaanxi","Shaanxi","Shaanxi"),
               shi = c("Beijing","Tianjin",
                       "Shijiazhuang","Tangshan","Handan","Xingtai","Baoding",
                       "Cangzhou","Langfang","Hengshui","Taiyuan","Yangquan",
                       "Changzhi","Jincheng","Jinan","Zibo","Jining","Dezhou",
                       "Liaocheng","Binzhou","Heze","Zhenzhou","Kaifeng",
                       "Anyang","Hebi","Xinxiang","Jiaozuo","Puyang",
                       "Jinzhong","Linfen","Lvliang","Yuncheng","Jiyuan","Luoyang",
                       "Sanmenxia","Xian","Tongchuan","Baoji","Xianyang",
                       "Weinan","Beijing","Tianjin","Shijiazhuang","Tangshan",
                       "Handan","Xingtai","Baoding","Cangzhou","Langfang",
                       "Hengshui","Taiyuan","Yangquan","Changzhi",
                       "Jincheng","Jinan","Zibo","Jining","Dezhou","Liaocheng",
                       "Binzhou","Heze","Zhenzhou","Kaifeng","Anyang","Hebi",
                       "Xinxiang","Jiaozuo","Puyang","Jinzhong","Linfen",
                       "Lvliang","Yuncheng","Jiyuan","Luoyang","Sanmenxia",
                       "Xian","Tongchuan","Baoji","Xianyang","Weinan"),
               way = c("gas","gas","gas","gas",
                       "gas","gas","gas","gas","gas","gas","gas","gas",
                       "gas","gas","gas","gas","gas","gas","gas","gas","gas",
                       "gas","gas","gas","gas","gas","gas","gas","gas",
                       "gas","gas","gas","gas","gas","gas","gas","gas",
                       "gas","gas","gas","electricity","electricity",
                       "electricity","electricity","electricity","electricity",
                       "electricity","electricity","electricity","electricity",
                       "electricity","electricity","electricity",
                       "electricity","electricity","electricity","electricity",
                       "electricity","electricity","electricity","electricity",
                       "electricity","electricity","electricity","electricity",
                       "electricity","electricity","electricity","electricity",
                       "electricity","electricity","electricity",
                       "electricity","electricity","electricity","electricity",
                       "electricity","electricity","electricity","electricity"),
           number1 = c(18.07,55.23,81.9762,67.2531,
                       80.8978,50.746,122.069,61.3262,79.52,70.4369,
                       16.3835,6.67,27.5034,11.1688,44.28,23.22,25.09,43.0126,
                       44.8,10.72,13.2,1.991,1.28,8,0.3,2.13,1.21,6.48,
                       4.2884,15.1688,5.565,7.321,0.096,0.74,0.05,14.78,
                       10.8,22.49,20.3,47.26,47.07,34.86,25,24.8969,
                       15.3507,29.22,17.8406,4.7114,8.21,1.5208,7.2019,7.6,
                       10.5868,2.2877,7.32,15.73,24.68,5.5899,11.11,3.25,
                       25.72,28.33,15.24,33.94,14.89,31.63,30.88,24.09,
                       4.4732,5.0951,15.105,18.9908,3.1,23.57,14.54,
                       61.07,20.56,26.49,9.97,42.64),
            number = c(18.07,55.23,81.9762,67.2531,
                       80.8978,50.746,122.069,61.3262,79.52,70.4369,
                       16.3835,6.67,27.5034,11.1688,44.28,23.22,25.09,43.0126,
                       44.8,10.72,13.2,1.991,1.28,8,0.3,2.13,1.21,6.48,
                       4.2884,15.1688,5.565,7.321,0.096,0.74,0.05,14.78,
                       10.8,22.49,20.3,47.26,47.07,34.86,25,24.8969,
                       15.3507,29.22,17.8406,4.7114,8.21,1.5208,7.2019,7.6,
                       10.5868,2.2877,7.32,15.73,24.68,5.5899,11.11,3.25,
                       25.72,28.33,15.24,33.94,14.89,31.63,30.88,24.09,
                       4.4732,5.0951,15.105,18.9908,3.1,23.57,14.54,
                       61.07,20.56,26.49,9.97,42.64),
                 市 = c("北京市","天津市","石家庄市","唐山市",
                       "邯郸市","邢台市","保定市","沧州市","廊坊市","衡水市","太原市","阳泉市",
                       "长治市","晋城市","济南市","淄博市","济宁市","德州市","聊城市","滨州市",
                       "菏泽市","郑州市","开封市","安阳市","鹤壁市","新乡市","焦作市","濮阳市","晋中市",
                       "临汾市","吕梁市","运城市","济源市","洛阳市","三门峡市","西安市","铜川市",
                       "宝鸡市","咸阳市","渭南市","北京市","天津市","石家庄市","唐山市","邯郸市",
                       "邢台市","保定市","沧州市","廊坊市","衡水市","太原市","阳泉市","长治市",
                       "晋城市","济南市","淄博市","济宁市","德州市","聊城市","滨州市","菏泽市",
                       "郑州市","开封市","安阳市","鹤壁市","新乡市","焦作市","濮阳市","晋中市",
                       "临汾市","吕梁市","运城市","济源市","洛阳市","三门峡市","西安市","铜川市",
                       "宝鸡市","咸阳市","渭南市")
)

# d2 <- data.frame(
#   stringsAsFactors = FALSE,
#                  市 = c("北京市","天津市","石家庄市","唐山市",
#                        "邯郸市","邢台市","保定市","沧州市","廊坊市","衡水市","太原市","阳泉市",
#                        "长治市","晋城市","济南市","淄博市","济宁市","德州市","聊城市","滨州市",
#                        "菏泽市","郑州市","开封市","安阳市","鹤壁市","新乡市","焦作市","濮阳市","晋中市",
#                        "临汾市","吕梁市","运城市","济源市","洛阳市","三门峡市","西安市","铜川市",
#                        "宝鸡市","咸阳市","渭南市"),
#                 id = c("plan","plan","plan","plan",
#                        "plan","plan","plan","plan","plan","plan","plan",
#                        "plan","plan","plan","plan","plan","plan","plan",
#                        "plan","plan","plan","plan","plan","plan","plan",
#                        "plan","plan","plan","plan","plan","plan","plan",
#                        "plan","plan","plan","plan","plan","plan","plan",
#                        "plan"),
#             number = c(65.14,90.09,104.7762,80.7631,
#                        91.7778,69.966,133.699,65.9662,87.73,71.8569,
#                        22.1235,10.67,32.9434,12.1388,50.39,32.44,33.01,
#                        46.5618,52.39,13.97,22.68,30.321,16.52,32.44,15.19,
#                        33.76,27.25,30.57,6.9484,18.3088,13.465,15.421,2.646,
#                        15.53,6.59,73.1,14.48,36.9,29.33,60.07)
# )

ggplot(d1) +
    aes(x = 市, fill = way, weight = number) +
    geom_bar() +
    scale_fill_manual(
        values = list(
            gas = '#91e8e1',
            electricity = '#6495ed'
            
        )
    ) +
    labs(x = "改造城市", y = "煤改气改电改造户数 (单位: 万户)") +
    theme_bw() +
    labs(fill = "2016-2020年各城市农村地区煤改气/改电改造户数 (单位：万户)") +
    theme(legend.text = element_text(size=6),
          legend.title = element_text(size=6))
    
ggsave("E://gas-elec.svg",plot = last_plot(),width = 30,height = 10)

# ggplot(d2) +
#     aes(x = 市, fill = id, weight = number) +
#     geom_bar() +
#     labs(x = "改造城市", y = "煤改气改电改造总户数 (单位: 万户)") +
#     theme_bw() +
#     labs(fill = "2016-2020年各城市农村地区煤改气改电改造总户数 (单位：万户)") +
#     theme(legend.text = element_text(size=6),
#           legend.title = element_text(size=6)) +
#     geom_text(aes(label = number, y = number), size = 3)
#     
# ggsave("E://gas-elec_total.svg",plot = last_plot(),width = 30,height = 10)
```





```{r paged.print=FALSE}
# d1<-data.frame(
#   stringsAsFactors = FALSE,
#                shi = c("Beijing","Tianjin","Shijiazhuang","Tangshan","Langfang",
#                        "Baoding","Cangzhou","Hengshui","Xingtai","Handan","Zhenzhou","Kaifeng","Anyang","Hebi",
#                        "Xinxiang","Jiaozuo","Puyang","Jinan","Zibo","Jining","Dezhou","Liaocheng","Binzhou","Heze",
#                        "Taiyuan","Yangquan","Changzhi","Jincheng","Beijing","Tianjin","Shijiazhuang","Tangshan","Langfang",
#                        "Baoding","Cangzhou","Hengshui","Xingtai","Handan","Zhenzhou","Kaifeng","Anyang","Hebi",
#                        "Xinxiang","Jiaozuo","Puyang","Jinan","Zibo","Jining","Dezhou","Liaocheng","Binzhou","Heze",
#                        "Taiyuan","Yangquan","Changzhi","Jincheng","Beijing","Tianjin","Shijiazhuang","Tangshan","Langfang",
#                        "Baoding","Cangzhou","Hengshui","Xingtai","Handan","Zhenzhou","Kaifeng","Anyang","Hebi",
#                        "Xinxiang","Jiaozuo","Puyang","Jinan","Zibo","Jining","Dezhou","Liaocheng","Binzhou","Heze",
#                        "Taiyuan","Yangquan","Changzhi","Jincheng"),
#                way = c("Hg0","Hg0","Hg0","Hg0",
#                        "Hg0","Hg0","Hg0","Hg0","Hg0","Hg0","Hg0","Hg0",
#                        "Hg0","Hg0","Hg0","Hg0","Hg0","Hg0","Hg0","Hg0","Hg0",
#                        "Hg0","Hg0","Hg0","Hg0","Hg0","Hg0","Hg0","Hg2+",
#                        "Hg2+","Hg2+","Hg2+","Hg2+","Hg2+","Hg2+","Hg2+",
#                        "Hg2+","Hg2+","Hg2+","Hg2+","Hg2+","Hg2+","Hg2+",
#                        "Hg2+","Hg2+","Hg2+","Hg2+","Hg2+","Hg2+","Hg2+",
#                        "Hg2+","Hg2+","Hg2+","Hg2+","Hg2+","Hg2+","Hgp",
#                        "Hgp","Hgp","Hgp","Hgp","Hgp","Hgp","Hgp","Hgp",
#                        "Hgp","Hgp","Hgp","Hgp","Hgp","Hgp","Hgp","Hgp","Hgp",
#                        "Hgp","Hgp","Hgp","Hgp","Hgp","Hgp","Hgp","Hgp",
#                        "Hgp","Hgp"),
#           emission = c(239.2882025,98.16084237,
#                        159.4978028,45.35679218,343.0778078,296.1422396,
#                        94.28435383,56.42889991,93.81536383,87.49496209,44.95689249,
#                        20.33307822,36.29705917,14.69585378,35.12495207,
#                        25.46996818,22.29210844,47.54747237,30.12131295,15.39408199,
#                        17.52256373,36.65313054,17.70098366,27.75790292,
#                        47.55127393,23.77471723,34.0617413,25.30184108,
#                        49.60852979,20.35041854,33.06661765,9.403237404,71.12588698,
#                        61.39534235,19.54675628,11.69867437,19.44952665,
#                        18.13919946,9.320331371,4.215394265,7.525000071,3.046701393,
#                        7.282002258,5.280359256,4.621534677,9.857402808,
#                        6.244662442,3.191456022,3.632726627,7.598819746,
#                        3.669716125,5.75468719,9.858190937,4.928904792,7.061580513,
#                        5.245503638,2.918148811,1.197083444,1.945095156,
#                        0.553131612,4.183875705,3.611490727,1.149809193,0.688157316,
#                        1.144089803,1.067011733,0.548254787,0.247964369,
#                        0.442647063,0.179217729,0.428353074,0.310609368,
#                        0.271854981,0.579847224,0.367333085,0.187732707,0.213689802,
#                        0.446989397,0.215865654,0.338511011,0.579893585,
#                        0.289935576,0.415387089,0.308559038)
# )

```


```{r}
d_way <- data.frame(region = c('2+26',"Fenwei Plain"),emission = c(7911.87,2610.10))


d1 <- read.csv("E://Rdata//coal//Hg_totalemission.csv")
d1 <- filter(d1, date == "总和")
d1$shi <- factor(d1$shi, levels = c("Beijing","Tianjin", "Hebei","Henan","Shandong","Shanxi","Shaanxi",'"2+26"',"Fenwei"))
# d0.25 <- d0[d0$emission_total != 0, ]
# 
# d0.5 <- d0.25[d0.25$way != "Hg",]
# 
# d1 <- d0.5[d0.5$region == "2+26",]
# 分年份
# ggplot(d1) +
#     aes(x = date, fill = shi, weight = emission) +
#     geom_bar(width = 0.875, position = "dodge") +
#     scale_fill_manual(
#         values = list(
#             Beijing = '#91e8e1',
#             Tianjin = '#6495ed',
#             Hebei =  "#ff7f50",
#             Henan = "#da1f18",
#             Shandong = "#701866",
#             Shanxi = "#f47a75",
#             Shaanxi = "#0780cf"
# 
#         )
#     ) +
#     geom_errorbar(aes(date, ymin = emission*(1+ymin),ymax = emission*(1+ymax)),position = position_dodge(), size = 0.3) +
#     labs(x = "改造城市", y = "减排量(单位: kg)") +
#     ylim(0 ,1500) +
#     theme_bw() +
#     labs(fill = "2016-2020年“2+26”城市和汾渭平原等地的Hg减排量") +
#     theme(legend.text = element_text(size=6),
#           legend.title = element_text(size=6))
# ggsave("E://Rdata//Rimage//Hg_emission16-20_bar1.svg",plot = last_plot(),width = 6,height = 4)


# 不分年份
ggplot(d1) +
    aes(x = shi, fill = shi, weight = emission) +
    geom_bar(width = 0.75, position = "dodge") +
    # scale_fill_manual(
    #     values = list(
    #         Beijing = '#91e8e1',
    #         Tianjin = '#6495ed',
    #         Hebei =  "#ff7f50",
    #         Henan = "#da1f18",
    #         Shandong = "#701866",
    #         Shanxi = "#f47a75",
    #         Shaanxi = "#0780cf"
    # 
    #     )
    # ) +
    geom_errorbar(aes(shi, ymin = emission*(1+ymin),ymax = emission*(1+ymax)),position = position_dodge(), width = 0.3) +
    labs(x = "改造城市", y = "减排量(单位: kg)") +
    ylim(0 ,9000) +
    theme_bw() +
    labs(fill = "2016-2020年“2+26”城市和汾渭平原等地的Hg减排量") +
    theme(legend.text = element_text(size=6),
          legend.title = element_text(size=6))
ggsave("E://Rdata//Rimage//Hg_emission17-20_bar1.svg",plot = last_plot())



# ggplot(d_way) +
#     aes(x = region, fill = region, weight = emission) +
#     geom_bar(width = 0.8) +
#      scale_fill_manual(
#         values = list(
#             "2+26" = '#ff7f50',
#             "Fenwei Plain" = '#6495ed'
#         )
#     ) +
#     # labs(x = "改造城市", y = "减排量(单位: kg)") +
#     # # ylim(0 ,3500) +
#     theme_bw() +
#   ylim(0,10000)


# labs(fill = "2016-2020年“2+26”城市和汾渭平原等地的Hg减排量") +
# theme(legend.text = element_text(size=6),
#       legend.title = element_text(size=6))


# ggsave("E://Rdata//Rimage//Hg_emission16-20_bar2.svg",plot = last_plot(),width = 5,height = 2)


```


```{r}
d_sector <- data.frame(region = c('This study',"Zhou et al. (2019)"),emission = c(10.52,9.19))

ggplot(d_sector) +
    aes(x = region, fill = region, weight = emission) +
    geom_bar(width = 0.8) +
     scale_fill_manual(
        values = list(
            "This study" = '#ff7f50',
            "Zhou et al. (2019)" = '#6495ed'
        )
    ) +
    # labs(x = "改造城市", y = "减排量(单位: kg)") +
    # # ylim(0 ,3500) +
    theme_bw() +
  ylim(0,15) +
  labs(x = "", y = "Atmospheric Hg emission (t)")
# labs(fill = "2016-2020年“2+26”城市和汾渭平原等地的Hg减排量") +
# theme(legend.text = element_text(size=6),
#       legend.title = element_text(size=6)
#       
#       )


ggsave("E://Rdata//Rimage//Hg_emission16-20_bar3.svg",plot = last_plot())
```


```{r}
d_sector <- data.frame(region = c('This study',"Wu et al. (2016)"),emission = c(10.52,12.699))

ggplot(d_sector) +
    aes(x = region, fill = region, weight = emission) +
    geom_bar(width = 0.8) +
     scale_fill_manual(
        values = list(
            "This study" = '#ff7f50',
            "Wu et al. (2016)" = '#6495ed'
        )
    ) +
    # labs(x = "改造城市", y = "减排量(单位: kg)") +
    # # ylim(0 ,3500) +
    theme_bw() +
  ylim(0,15) +
  labs(x = "", y = "Atmospheric Hg emission (t)")
# labs(fill = "2016-2020年“2+26”城市和汾渭平原等地的Hg减排量") +
# theme(legend.text = element_text(size=6),
#       legend.title = element_text(size=6)
#       
#       )


ggsave("E://Rdata//Rimage//Hg_emission16-20_bar4.svg",plot = last_plot())
```



```{r paged.print=FALSE}

ggplot() +
  # geom_polygon(colour="white",alpha = 0.001 ) +
  
  # geom_polygon(data=aimProvinceMap3,colour="black",fill = "grey90") +
  
  
  aes(x=long,y=lat,group=group) +
  
  geom_point(data = position,aes(x=long,y=lat,group=group,color = remodeled_household_k),size=position$remodeled_household_k*0.25) +
  
  # geom_point(data = p1,aes(x=long,y=lat,group=group,color = remodeled_household_k),size=value) +   # 1
  # geom_point(data = p2,aes(x=long,y=lat,group=group,color = remodeled_household_k),size=value) +   # 2
  # geom_point(data = p3,aes(x=long,y=lat,group=group,color = remodeled_household_k),size=value) +   # 3
  # geom_point(data = p4,aes(x=long,y=lat,group=group,color = remodeled_household_k),size=value) +   # 6
  # geom_point(data = p5,aes(x=long,y=lat,group=group,color = remodeled_household_k),size=value) +   # 5
  # geom_point(data = p6,aes(x=long,y=lat,group=group,color = remodeled_household_k),size=value) +   # 4
  
  
  
  
  # scale_color_gradient2(low = 'deepskyblue2',mid = "gold", midpoint = 10000000,high = 'red') +
  scale_color_gradientn(colours = c("deepskyblue2","red")) +  #调整点的颜色
  # scale_color_gradient(low = 'grey80',high='red') +
  # geom_polygon(data=aimProvinceMap1,colour="black",alpha = 0.005,size = 0.001) +     #加六省界限
  # scale_x_continuous(breaks = seq(109, 124, 5)) +
  
  
  geom_polygon(data=aimProvinceMap3,colour="black",fill = "grey90",alpha = 0.1,size = 0.001) +   #加2+26市界限  
  
  
  # geom_polygon(data = aimProvinceMap4,colour="black",alpha = 0.001,size = 0.001) +   # 加临近省+六省  
  coord_equal() +
  theme_bw() +
  
# 6378137*pi*109/180   
# 6378137*log(tan(pi/4+mapDF2$lat*pi/360))
  theme(
   legend.key.width = unit(1, "cm"),
   legend.key.height = unit(1.95, "cm")
  )+
  # xlim(6378137*pi*110/180,6378137*pi*123/180) +
  # ylim(6378137*log(tan(pi/4+31*pi/360)),6378137*log(tan(pi/4+43*pi/360))) +
  xlab('') +
  ylab("")

ggsave('E://remodeled_household.svg',plot = last_plot())
```






```{r}
library(ggplot2)
library(sf)
```


```{r}
map_china <- read_sf("https://geo.datav.aliyun.com/areas_v3/bound/100000_full.json")
position <- read.csv('E://Rdata//coal//beijingposition.csv')
```


```{r}
ggplot() +
  geom_sf(data = map_china,fill = "NA", size = .5, color = "black") +
  geom_tile(data = position, aes(x = long, y = lat, fill = CO2_t)) +
  scale_fill_gradient(low = "green" , high = "red")
  
```





```{r}
# ggplot(data=mapDF1,aes(x=long,y=lat,group=group))+
#   geom_polygon(colour="white",alpha = 0.1) +
  ggplot(data=aimProvinceMap1,aes(x=long,y=lat,group=group),alpha = 0.005)+
    # 省边界
  geom_polygon(color = "black", fill = "white") +
  # geom_polygon(aimProvinceMap,aes(x=long,y=lat,group=group)) +
  # geom_polygon(colour="white",alpha = 0.1) +

  # geom_point(data = position,aes(x=long,y=lat,group=group,color = CO2),size=0.005) +
  geom_tile(data = position,aes(x=long,y=lat,group=group,fill = CO2),color = "grey50")+
  
  # scale_color_gradient2(low = 'deepskyblue2',midpoint = 47500000,mid = 'yellow',high='red') +
  # scale_fill_gradient(low = 'deepskyblue2',high='red') +

  
  # 
  coord_equal()+
  theme(
    # legend.position = 'none',
    panel.grid = element_blank(),
    panel.background = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank()
  )
```


##  亚洲地图

```{r}
setwd("E://Rdata//Map//Asia//world_map")

# 
library(ggplot2)
library(maps)
library(mapdata)
library(maptools)
library(sp)
library(rgdal)
library(rgeos)
  
dataProjected_new <- readOGR("country.shp",use_iconv=TRUE, encoding = "UTF-8")
dataProjected_new@data$id <- rownames(dataProjected_new@data)
mapPoints_new <- fortify(dataProjected_new, region = "id")

mapDF_asia <- merge(mapPoints_new, dataProjected_new@data, by = "id")

# mapDF_asia$long <- 6378137*pi*mapDF_asia$long/180
# mapDF_asia$lat <- 6378137*log(tan(pi/4+mapDF_asia$lat*pi/360))



dataProjected_1 <- readOGR("E://Rdata//Map//Asia//世界地图shp,有详细和简单两个版本//世界地图shp//世界地图详细//标准国界9.7//南海诸岛.shp",use_iconv=TRUE, encoding = "UTF-8")
dataProjected_1@data$id <- rownames(dataProjected_1@data)
mapPoints_1 <- fortify(dataProjected_1, region = "id")

mapDF_nanhai <- merge(mapPoints_1, dataProjected_1@data, by = "id")
```
### a1


```{r}
long = c(60,60.625,61.25,61.875,62.5,63.125,
             63.75,64.375,65,65.625,66.25,66.875,67.5,68.125,68.75,
             69.375,70,70.625,71.25,71.875,72.5,73.125,73.75,74.375,
             75,75.625,76.25,76.875,77.5,78.125,78.75,79.375,80,
             80.625,81.25,81.875,82.5,83.125,83.75,84.375,85,85.625,
             86.25,86.875,87.5,88.125,88.75,89.375,90,90.625,91.25,
             91.875,92.5,93.125,93.75,94.375,95,95.625,96.25,96.875,
             97.5,98.125,98.75,99.375,100,100.625,101.25,101.875,
             102.5,103.125,103.75,104.375,105,105.625,106.25,106.875,
             107.5,108.125,108.75,109.375,110,110.625,111.25,
             111.875,112.5,113.125,113.75,114.375,115,115.625,116.25,
             116.875,117.5,118.125,118.75,119.375,120,120.625,121.25,
             121.875,122.5,123.125,123.75,124.375,125,125.625,126.25,
             126.875,127.5,128.125,128.75,129.375,130,130.625,
             131.25,131.875,132.5,133.125,133.75,134.375,135,135.625,
             136.25,136.875,137.5,138.125,138.75,139.375,140,140.625,
             141.25,141.875,142.5,143.125,143.75,144.375,145,145.625,
             146.25,146.875,147.5,148.125,148.75,149.375,150)
```


```{r}
library(tidyverse)
position <- read.csv('E://Rdata//Map//Asia//basecase_dep.csv')
head(position)
gg <- data.frame()
for(i in 2:146){
  g <- cbind(position$lat,position[,i])
  gg <- rbind(gg,g)
  }
V3 <- rep(long,each = 133)
gg <- cbind(gg,V3)
group <- rep(1,145*133)
gg <- cbind(gg,group)
gg[gg$V2 > 50,]$V2 <- rep(50,length(gg[gg$V2 > 50,]$V2))
```

### a2

```{r}
position <- read.csv('E://Rdata//Map//Asia//case_dep.csv')
head(position)
gg <- data.frame()
for(i in 2:146){
  g <- cbind(position$lat,position[,i])
  gg <- rbind(gg,g)
  }
V3 <- rep(long,each = 133)
gg <- cbind(gg,V3)
group <- rep(1,145*133)
gg <- cbind(gg,group)
gg[gg$V2 > 50,]$V2 <- rep(50,length(gg[gg$V2 > 50,]$V2))
```


### a3

```{r}
position <- read.csv('E://Rdata//Map//Asia//change_dep.csv')
head(position)
gg <- data.frame()
for(i in 2:146){
  g <- cbind(position$lat,position[,i])
  gg <- rbind(gg,g)
  }
V3 <- rep(long,each = 133)
gg <- cbind(gg,V3)
group <- rep(1,145*133)
gg <- cbind(gg,group)
gg[gg$V2 < -0.2,]$V2 <- rep(-0.2,length(gg[gg$V2 < -0.2,]$V2))
```


### b1

```{r}
position <- read.csv('E://Rdata//Map//Asia//basecase_conc.csv')
head(position)
gg <- data.frame()
for(i in 2:146){
  g <- cbind(position$lat,position[,i])
  gg <- rbind(gg,g)
  }
V3 <- rep(long,each = 133)
gg <- cbind(gg,V3)
group <- rep(1,145*133)
gg <- cbind(gg,group)
gg[gg$V2 > 2.5,]$V2 <- rep(2.5,length(gg[gg$V2 > 2.5,]$V2))
```

### b2

```{r}
position <- read.csv('E://Rdata//Map//Asia//case_conc.csv')
head(position)
gg <- data.frame()
for(i in 2:146){
  g <- cbind(position$lat,position[,i])
  gg <- rbind(gg,g)
  }
V3 <- rep(long,each = 133)
gg <- cbind(gg,V3)
group <- rep(1,145*133)
gg <- cbind(gg,group)
gg[gg$V2 > 2.5,]$V2 <- rep(2.5,length(gg[gg$V2 > 2.5,]$V2))
```

### b3

```{r}
position <- read.csv('E://Rdata//Map//Asia//change_conc.csv')
head(position)
gg <- data.frame()
for(i in 2:146){
  g <- cbind(position$lat,position[,i])
  gg <- rbind(gg,g)
  }
V3 <- rep(long,each = 133)
gg <- cbind(gg,V3)
group <- rep(1,145*133)
gg <- cbind(gg,group)
gg[gg$V2 < -0.2,]$V2 <- rep(-0.2,length(gg[gg$V2 < -0.2,]$V2))
# de <- gg[gg$V2 < -0.05,]
# write.csv(de, file = "E://change_conc_-0.05.csv")
```


### plot


```{r}
countries1 <- c("Bahrain","South Korea","Lebanon","Nepal","Thailand","Pakistan","United Arab Emirates","Bhutan","Oman","Azerbaijan","North Korea","Philippines","Cambodia","Qatar","Kyrgyzstan","Maldives","Malaysia","Mongolian","Saudi Arabia","Cyprus","Brunei","Laos","Japan","Turkmenistan","Turkey","Kazakhstan","Palestinian state","Tajikistan","Georgia","Kuwait","Syria","India","Indonesia","Armenia","Afghanistan","Uzbekistan","Sri Lanka","Iraq","Vietnam","Iran","Yemen","Jordan","Burma","Sikkim","Bangladesh","Singapore","Israel","East timor")


countries <- c("China", "Mongolia", "North Korea", "South Korea", "Japan", "Philippines", "Vietnam", "Laos", "Cambodia", "Myanmar (Burma)", "Thailand", "Malaysia", "BruneiDarussalam", "Singapore", "Indonesia", "east Timor", "Nepal", "Bhutan", "Bangladesh", "India", "Pakistan", "Sri Lanka", "Maldives", "Kazakhstan", "Kyrgyzstan", "Tajikistan", "Uzbekistan", "Turkmenistan", "Afghanistan", "Iraq", "Iran", "Syria", "Jordan", "Lebanon", "Israel", "Palestine", "SaudiArabia", "Bahrain", "Qatar", "Kuwait", "United Arab Emirates", "Oman", "Yemen", "Georgia", "Armenia", "Azerbaijan", "Turkey", "Cyprus","Taiwan", "Papua New Guinea", "Russia","Saudi Arabia")
```

```{r}
CC <- data.frame()
for(i in countries){
  q <- mapDF_asia[which(mapDF_asia$CNTRY_NAME == i),]
  CC <- rbind(CC,q)
}


```


```{r}
library(viridis)

ggplot(CC,aes(x = long, y = lat, group = group)) +
  geom_polygon(color = "black", fill = "white", width = 0.01) +
  geom_polygon(data = mapDF_nanhai,aes(x = long, y = lat, group = group)) +
  coord_equal() +
  xlim(0,180) +
  geom_tile(data = gg, aes(x = V3, y = V1, fill = V2, group = group), alpha = 0.9) +
  # scale_fill_gradientn(colors = c("white","#E8E8E8", "#5AC8C8", "#BE64AC", "#3B4994")) +
#a1 2 b1 2用
  # scale_fill_gradientn(colours = c("white","white","#E8E8E8","#DFB0D6","#BE64AC","#8C62AA","#3B4994","black")) +
#a3 b3用
  # scale_fill_gradientn(colours = c("#3B4994","#8C62AA","#BE64AC","#DFB0D6","white","white")) +
  
  # scale_fill_gradientn(colours = c("#EA5412","#F39800","#F7EE14","#DADF00","#8EC31F","white")) +
  # scale_fill_viridis(discrete=F, guide=F, option="A") +
  theme_bw() +
  labs(title = paste0("（A1）基准情形下大气汞沉降通量单位：         μg·m-2/yr-1"))

#labs(title = paste0("（A1）基准情形下大气汞沉降通量         单位：μg·m-2/yr-1"))
#labs(title = paste0("（A2）政策情形下大气汞沉降通量         单位：μg·m-2/yr-1"))
#labs(title = paste0("（A3）大气汞沉降通量变化值         单位：μg·m-2/yr-1"))
#labs(title = paste0("（B1）基准情形下大气汞浓度         单位：ng·m-3"))
#labs(title = paste0("（B2）基准情形下大气汞沉降通量         单位：ng·m-3"))
#labs(title = paste0("（B3）基准情形下大气汞沉降通量         单位：ng·m-3"))
ggsave("E://a1.svg",plot = last_plot())

```




```{r}

# position$long <- round(as.numeric(position$long),8)
# position$long <- 6378137*pi*position$long/180
# position$lat <- round(as.numeric(position$lat),8)
# position$lat <- 6378137*log(tan(pi/4+position$lat*pi/360))
# 
# position <- position[order(position$remodeled_household_k,decreasing = F),]
# position$remodeled_household_k <- position$remodeled_household_k*0.001
# head(position)

```

```{r}

```


```{r}


ggplot(data = position,aes(x=long,y=lat,fill = CO2_t))+
geom_tile()
```





```{r paged.print=FALSE}
# 安装并加载所需的R包
# install.packages("ggalluvial")
# library(ggalluvial)
# library(ggplot2)



admissions <- data.frame(
  stringsAsFactors = FALSE,
           A3家庭年收入 = c("100000元以上","100000元以上",
                       "100000元以上","100000元以上","100000元以上","100000元以上",
                       "50000元～100000元","50000元～100000元","50000元～100000元",
                       "50000元～100000元","50000元～100000元","50000元～100000元","30000元～50000元",
                       "30000元～50000元","30000元～50000元","30000元～50000元",
                       "30000元～50000元","30000元～50000元","10000元～30000元",
                       "10000元～30000元","10000元～30000元","10000元～30000元","10000元～30000元",
                       "10000元～30000元","10000元以下","10000元以下","10000元以下",
                       "10000元以下","10000元以下","10000元以下"),
          A4家庭收入来源 = c("单位或部门工资及年薪所得",
                       "种植、养殖、加工或相关劳务收入所得","赡养费、抚（扶）养费、依法继承遗产及其它赠与所得",
                       "土地承包权流转收益、财产租赁或变卖收入，集体分红和股息、储蓄存款和利息收入，股票、基金等有价证券及其收益",
                       "社会养老保险金、商业养老保险金、商业医疗保险金、土地征用补偿和安置费、水库移民后扶补助、粮食直接补贴、一次性安置费、经济补偿金、遗属生活补助费、离退休金、基本生活费与医疗费、养老金及救济金、失业保险金及其各种以奖金、补助、津贴等以现金发放的劳保福利所得",
                       "自谋职业收入或偶然所得及其它通过劳动所得合法收入等","单位或部门工资及年薪所得","种植、养殖、加工或相关劳务收入所得",
                       "赡养费、抚（扶）养费、依法继承遗产及其它赠与所得",
                       "土地承包权流转收益、财产租赁或变卖收入，集体分红和股息、储蓄存款和利息收入，股票、基金等有价证券及其收益",
                       "社会养老保险金、商业养老保险金、商业医疗保险金、土地征用补偿和安置费、水库移民后扶补助、粮食直接补贴、一次性安置费、经济补偿金、遗属生活补助费、离退休金、基本生活费与医疗费、养老金及救济金、失业保险金及其各种以奖金、补助、津贴等以现金发放的劳保福利所得",
                       "自谋职业收入或偶然所得及其它通过劳动所得合法收入等","单位或部门工资及年薪所得","种植、养殖、加工或相关劳务收入所得",
                       "赡养费、抚（扶）养费、依法继承遗产及其它赠与所得",
                       "土地承包权流转收益、财产租赁或变卖收入，集体分红和股息、储蓄存款和利息收入，股票、基金等有价证券及其收益",
                       "社会养老保险金、商业养老保险金、商业医疗保险金、土地征用补偿和安置费、水库移民后扶补助、粮食直接补贴、一次性安置费、经济补偿金、遗属生活补助费、离退休金、基本生活费与医疗费、养老金及救济金、失业保险金及其各种以奖金、补助、津贴等以现金发放的劳保福利所得",
                       "自谋职业收入或偶然所得及其它通过劳动所得合法收入等","单位或部门工资及年薪所得","种植、养殖、加工或相关劳务收入所得",
                       "赡养费、抚（扶）养费、依法继承遗产及其它赠与所得",
                       "土地承包权流转收益、财产租赁或变卖收入，集体分红和股息、储蓄存款和利息收入，股票、基金等有价证券及其收益",
                       "社会养老保险金、商业养老保险金、商业医疗保险金、土地征用补偿和安置费、水库移民后扶补助、粮食直接补贴、一次性安置费、经济补偿金、遗属生活补助费、离退休金、基本生活费与医疗费、养老金及救济金、失业保险金及其各种以奖金、补助、津贴等以现金发放的劳保福利所得",
                       "自谋职业收入或偶然所得及其它通过劳动所得合法收入等","单位或部门工资及年薪所得","种植、养殖、加工或相关劳务收入所得",
                       "赡养费、抚（扶）养费、依法继承遗产及其它赠与所得",
                       "土地承包权流转收益、财产租赁或变卖收入，集体分红和股息、储蓄存款和利息收入，股票、基金等有价证券及其收益",
                       "社会养老保险金、商业养老保险金、商业医疗保险金、土地征用补偿和安置费、水库移民后扶补助、粮食直接补贴、一次性安置费、经济补偿金、遗属生活补助费、离退休金、基本生活费与医疗费、养老金及救济金、失业保险金及其各种以奖金、补助、津贴等以现金发放的劳保福利所得","自谋职业收入或偶然所得及其它通过劳动所得合法收入等"),
                户数 = c(37L,32L,1L,10L,25L,40L,
                       29L,62L,6L,18L,50L,68L,9L,53L,5L,13L,40L,55L,
                       10L,20L,0L,10L,15L,17L,0L,2L,8L,4L,7L,4L),
                A4 = c(1L,2L,3L,4L,5L,6L,1L,2L,
                       3L,4L,5L,6L,1L,2L,3L,4L,5L,6L,1L,2L,3L,4L,
                       5L,6L,1L,2L,3L,4L,5L,6L),
            output = c(1L,2L,3L,4L,5L,6L,1L,2L,
                       3L,4L,5L,6L,1L,2L,3L,4L,5L,6L,1L,2L,3L,4L,
                       5L,6L,1L,2L,3L,4L,5L,6L)
)
# )
# # 使用geom_alluvium函数绘制桑基图
# admissions <- as.data.frame(UCBAdmissions)
# head(admissions)
# ##      Admit Gender Dept Freq
# ## 1 Admitted   Male    A  512
# ## 2 Rejected   Male    A  313
# ## 3 Admitted Female    A   89
# ## 4 Rejected Female    A   19
# ## 5 Admitted   Male    B  353
# ## 6 Rejected   Male    B  207
# 
```


```{r paged.print=FALSE}
ggplot(admissions,
       aes(y = 户数, axis1 = A3家庭年收入, axis2 = A4)) +
  geom_alluvium(aes(fill = as.factor(A4)), width = 1/12) +
  # geom_flow() +
  geom_stratum(width = 1/12, fill = c('#FFEFE3','#DDE1E3',"#B9D1E3","#8DC1E4","#72B7E3","#5E5446","#8F6A4E","#EB5804","#EF833A","#F6A970","#FACCA8"), color = "white") +
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) +
  scale_x_discrete(limits = c("A3家庭年收入", "A4"), expand = c(.05, .05)) +
  scale_fill_manual(values = c("#FACCA8","#F6A970","#EF833A","#EB5804","#8F6A4E","#5E5446")) +
  theme_void()
ggsave("E://sankey.svg",plot = last_plot())
```

## 时间气泡图 
```{r paged.print=FALSE}
circle <- read.csv("E://Rdata//coal//circle time line.csv")

circle$地区 <- factor(circle$地区, levels = c("Beijing", "Tianjin", "Hebei", "Henan", "Shandong", "Shanxi", "Shaanxi",'"2+26"', "Fenwei"), ordered = T)

mytheme <- theme_minimal()+
  theme(
    panel.grid.major.y=element_blank(),
    panel.grid.minor.y=element_blank(),
    panel.grid.major.x=element_blank(),
    panel.grid.minor.x=element_blank(),
    panel.border = element_rect(fill = NA),
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title=element_text(hjust =0.5),
    axis.line.y=element_line(linetype=1,color='black'),
    axis.line.x=element_line(linetype=1,color='black'),
    axis.ticks = element_line(linetype=2,color='black'),
    # panel.grid=element_line(linetype=2,color='black'),
    # legend.background = element_rect(fill="gray90", size=0,color='white'),
    legend.text=element_text(face="bold",size=8),
    legend.title=element_text(face="bold",size=8),
    axis.text=element_text(face="bold",size=8)
  )


ggplot(data = circle) +
  aes(地区, 时间, color = group) +
  geom_hline(yintercept = circle$时间, color = "black") +
  geom_point(aes(size = Hg.t.), pch = 16) +
  scale_color_manual(values = list(
    "0-0.3" = "#E8E8E8",
    "0.3-0.5" = "#DFB0D6",
    "0.5-1.0" = "#BE64AC",
    "1.0-2.0" = "#8C62AA",
    "2.0-2.26" = "#3B4994"
    )) +
  ylim(2016.5,2020.5) +
  mytheme +
  labs(size = "Hg(t)", color = 'Hg(t)', x = "Region", y = "time")

ggsave("E://Rdata/Rimage/circle time line.svg", plot = last_plot())
# "#E8E8E8","#DFB0D6","#BE64AC","#8C62AA","#644B96","#3B4994"
```

mytheme <- theme_minimal()+
  theme(
    panel.grid.major.y=element_blank(),
    panel.grid.minor.y=element_blank(),
    axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title=element_text(hjust =0.5),
    axis.line.y=element_line(linetype=1,color='grey'),
    axis.line.x=element_line(linetype=1,color='grey'),
    axis.ticks = element_line(linetype=2,color='grey'),
    panel.grid=element_line(linetype=2,color='grey'),
    legend.background = element_rect(fill="gray90", size=0,color='white'),
    legend.text=element_text(face="bold",size=8),
    legend.title=element_text(face="bold",size=8),
    axis.text=element_text(face="bold",size=8)
  )

ggplot(data=df, mapping=aes(x=product,y=ratio,color=factor(year)))+
  geom_point(stat= "identity",aes(size=bubblesize),alpha=0.7,show.legend = TRUE)+ 
  guides(color=guide_legend(title="Year"))+
  scale_size(range = c(1, 30),guide=FALSE)+
  scale_color_manual(values=c("#666666","#FF0016"))+
  scale_y_continuous(labels = scales::percent,limits=c(y.min,1))+
  labs(x='Product',y='Increase ratio',title='Product increase ratio')+
  geom_text(aes(y=ratio,label=scales::percent(ratio),hjust=0.5), size=3,color="black",position = position_dodge(width=0.00),check_overlap = FALSE) +
  mytheme+
  geom_hline(yintercept = ratio.mean,linetype='dashed')+
  annotate(geom='text',x=0,y=ratio.mean,label=scales::percent(ratio.mean),hjust=-0.4,vjust=-0.5)

```{r}
setwd("E:/Rdata/Map/2021年7月中国乡镇行政区划shp/中国乡镇行政shp(来自百度地图0/河北省")
library(ggplot2)
library(maps)
library(mapdata)
library(maptools)
library(sp)
library(rgdal)
library(rgeos)
  
dataProjected <- readOGR("河北省_乡镇边界.shp",use_iconv=TRUE, encoding = "UTF-8")
# proj4string(dataProjected) <- CRS("+proj=longlat +ellps=WGS84")  
# projNew <- CRS("+proj=merc +lat_0=45n +lon_0=100e")  
# dataProjected <- spTransform(dataProjected, projNew)


dataProjected@data$id <- rownames(dataProjected@data)
mapPoints <- fortify(dataProjected, region = "id")

# dataProjected@data$hg <- ddddd$hg
mapDF <- merge(mapPoints, dataProjected@data, by = "id")

mapDF$long <- 6378137*pi*mapDF$long/180
mapDF$lat <- 6378137*log(tan(pi/4+mapDF$lat*pi/360))






# dataProjected1 <- readOGR("sheng.shp",use_iconv=TRUE, encoding = "UTF-8")
# # proj4string(dataProjected1) <- CRS("+proj=longlat +ellps=WGS84")
# # projNew <- CRS("+proj=merc +lat_0=45n +lon_0=100e")
# # dataProjected1 <- spTransform(dataProjected1, projNew)
# 
# dataProjected1@data$id <- rownames(dataProjected1@data) 
# mapPoints1 <- fortify(dataProjected1, region = "id")
# 
# # dataProjected@data$hg <- ddddd$hg
# mapDF1 <- merge(mapPoints1, dataProjected1@data, by = "id")
# 
# mapDF1$long <- 6378137*pi*mapDF1$long/180
# mapDF1$lat <- 6378137*log(tan(pi/4+mapDF1$lat*pi/360))
```

```{r}

ggplot(data=mapDF,aes(x=long,y=lat,group=group))+
  
  geom_polygon(colour="black") +
  coord_equal()+
  theme(
    panel.grid = element_blank(),
    panel.background = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank(),
    axis.title = element_blank()
  )

```

```{r paged.print=FALSE}
library(dplyr)

beijing <- read.csv("E://Rdata//coal//2017country_beijing.csv")
head(beijing)
```
```{r paged.print=FALSE}
xiangzhen <- beijing %>% select(城,区县,乡镇,村.社区.,地址,纬度,经度,全村.社区.总户数.修正.,X2017年计划改造总数.修正.) %>% group_by(城,区县,乡镇) %>% summarise(X2017年计划改造总数.修正. = sum(X2017年计划改造总数.修正.))
xiangzhen
```


```{r}
xiangzhen <- data.frame(
  stringsAsFactors = FALSE,
       check.names = FALSE,
                 城 = c("北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京","北京","北京","北京",
                       "北京","北京","北京","北京","北京","北京","北京"),
                区县 = c("昌平区","昌平区","昌平区","昌平区",
                       "昌平区","昌平区","昌平区","昌平区","昌平区","昌平区","朝阳区","朝阳区",
                       "朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区",
                       "朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区",
                       "朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区",
                       "朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区","朝阳区",
                       "朝阳区","朝阳区","大兴区","大兴区","大兴区","大兴区","大兴区","大兴区",
                       "大兴区","大兴区","大兴区","大兴区","大兴区","大兴区","房山区","房山区",
                       "房山区","房山区","房山区","房山区","房山区","房山区","房山区","房山区",
                       "房山区","房山区","房山区","房山区","房山区","房山区","房山区","房山区","房山区",
                       "房山区","房山区","房山区","海淀区","海淀区","海淀区","海淀区","海淀区",
                       "海淀区","海淀区","怀柔区","怀柔区","怀柔区","怀柔区","怀柔区","怀柔区",
                       "怀柔区","怀柔区","怀柔区","怀柔区","怀柔区","怀柔区","怀柔区","怀柔区",
                       "门头沟区","门头沟区","门头沟区","门头沟区","密云区","密云区","密云区","密云区",
                       "密云区","密云区","密云区","密云区","平谷区","平谷区","平谷区","平谷区",
                       "平谷区","平谷区","平谷区","平谷区","平谷区","平谷区","平谷区","平谷区",
                       "平谷区","平谷区","平谷区","平谷区","平谷区","石景山区","石景山区","石景山区",
                       "石景山区","石景山区","石景山区","石景山区","石景山区","顺义区","顺义区",
                       "顺义区","顺义区","顺义区","顺义区","顺义区","顺义区","顺义区","顺义区",
                       "顺义区","顺义区","顺义区","顺义区","顺义区","顺义区","顺义区","顺义区",
                       "顺义区","顺义区","顺义区","顺义区","顺义区","顺义区","通州区","通州区",
                       "通州区","通州区","通州区","通州区","通州区","通州区","通州区","通州区","通州区",
                       "通州区","通州区","通州区","通州区","延庆","延庆","延庆","延庆",
                       "延庆","延庆","延庆","延庆","延庆","延庆","延庆","延庆","延庆","延庆",
                       "延庆"),
                乡镇 = c("百善镇","城北街道","城南街道","崔村镇",
                       "马池口镇","南口镇","南邵镇","十三陵镇","小汤山镇","阳坊镇","高碑店","管庄",
                       "黑庄户","王四营","小红门","奥运村","八里庄","崔各庄乡","大屯","东坝镇",
                       "东风","垡头","高碑店","管庄","和平街","黑庄户","呼家楼","机场","建外",
                       "将台乡","金盏乡","劲松","酒仙桥","来广营","六里屯","麦子店","南磨房",
                       "平房乡","三间房乡","三里屯","十八里店乡","双井","孙河","王四营","望京",
                       "小红门","左家庄","安定镇","北臧村镇","采育镇","红星区","黄村","礼贤镇",
                       "庞各庄镇","青云店","魏善庄镇","西红门镇","榆垡镇","长子营","大石窝镇","青龙湖镇",
                       "城关街道","城关街道大石河社区","城关街道南城","城关南沿里","城关新东关","城关永安西里",
                       "窦店镇","拱辰街道","韩村河镇","琉璃河镇","青龙湖镇","十渡镇","石楼镇",
                       "西潞街道","霞云岭乡","阎村镇","张坊镇","长沟镇","长阳镇","周口店镇","东升",
                       "上庄","四季青","苏家坨镇","温泉镇","西北旺镇","苏家坨镇","北房镇","渤海镇",
                       "怀北镇","庙城镇","桥梓镇","雁栖镇","北房镇","渤海镇","怀北镇","怀柔镇",
                       "庙城镇","桥梓镇","汤河口镇","雁栖镇","潭柘寺镇","雁翅镇","清水镇","王平镇",
                       "不老屯","古北口","河南寨镇","巨各庄镇","穆家峪镇","石城镇","西田各庄镇",
                       "溪翁庄镇","大兴庄镇","东高村镇","东高村镇","黄松峪乡","金海湖镇","马昌营镇",
                       "马坊镇","南独乐何","平谷镇","山东庄镇","王辛庄镇","夏各庄镇","夏各庄镇","兴谷街道",
                       "熊儿寨乡","峪口镇","镇罗营镇","八宝山街道","八角街道","古城街道","广宁街道",
                       "金顶街街道","老山街道","苹果园街道","五里坨街道","高丽营镇","木林镇","南彩镇",
                       "牛栏山镇","杨镇","张镇","赵全营镇","北石槽镇","北务镇","北小营镇",
                       "大孙各庄镇","后沙峪镇","李桥镇","李遂镇","龙湾屯镇","马坡镇","南彩镇","南法信镇",
                       "南法信镇","牛栏山镇","仁和镇","杨镇","张镇","赵全营镇","漷县镇","宋庄镇",
                       "台湖镇","永乐店镇","永顺镇","于家务回族乡","张家湾镇","漷县镇","潞城镇","潞城镇",
                       "马驹桥镇","西集镇","永乐店镇","于家务回族乡","张家湾镇","八达岭","大榆树镇",
                       "大庄科乡","井庄镇","旧县镇","康庄镇","刘斌堡乡","千家店镇","沈家营镇",
                       "四海镇","香营乡","延庆镇","永宁镇","张山营镇","珍珠泉乡"),
           `2017年` = c(2414L,1768L,642L,1937L,
                       9082L,3453L,2208L,601L,7217L,2015L,279L,104L,910L,
                       4731L,1077L,290L,410L,6931L,10L,405L,703L,2590L,
                       2117L,2620L,0L,4535L,5L,10L,0L,1599L,1906L,60L,
                       1808L,184L,292L,120L,2435L,5072L,1765L,333L,12465L,
                       702L,23L,3994L,343L,2451L,3L,7920L,5811L,75L,
                       205L,5700L,17229L,10522L,236L,9762L,3355L,16397L,
                       325L,5970L,5539L,166L,42L,2L,5L,12L,22L,8812L,
                       657L,5355L,13957L,2462L,160L,7018L,18L,304L,2825L,
                       3027L,4095L,1522L,4908L,691L,1328L,1560L,2036L,
                       1220L,4121L,121L,1060L,167L,303L,287L,847L,123L,
                       2612L,1390L,2905L,492L,1438L,3998L,260L,715L,182L,
                       585L,507L,576L,128L,83L,485L,98L,140L,93L,168L,
                       192L,3481L,1995L,4780L,380L,4794L,3202L,4623L,
                       1160L,3767L,2818L,6831L,242L,1094L,2239L,1064L,9010L,
                       1699L,82L,13L,220L,565L,1323L,700L,80L,208L,
                       3613L,10063L,180L,556L,2292L,2403L,1786L,5001L,1653L,
                       5381L,8529L,464L,14041L,5649L,2436L,1905L,10817L,
                       716L,2010L,3322L,377L,7105L,4934L,5068L,8628L,
                       7740L,692L,4969L,212L,6371L,7081L,7448L,6143L,
                       4067L,13113L,14261L,9273L,834L,9421L,676L,1037L,95L,
                       1054L,120L,1478L,64L,110L,1657L,213L,153L,1311L,
                       180L,6828L,179L)
)
```


```{r paged.print=FALSE}
xiangzhen <- xiangzhen %>% group_by(城,区县,乡镇) %>% summarise(`2017年` = sum(`2017年`))
xiangzhen
```


```{r}
write.csv(xiangzhen,"E://Rdata//coal//2017country_beijing(xiangzhen).csv")
```



```{r paged.print=FALSE}
library(dplyr)

xinxiang_cunzhuang <- read.csv("E://Rdata//coal//Xinxiang_cunzhuang.csv")
jiaozuo_cunzhuang <- read.csv("E://Rdata//coal//Jiaozuo_cunzhuang.csv")
head(xinxiang_cunzhuang)
head(jiaozuo_cunzhuang)
```

```{r paged.print=FALSE}
xinxiang_cunzhuang <- xinxiang_cunzhuang %>% group_by(省,城,区县,乡镇,改造方式) %>% summarise(X17年改造 = sum(X17年改造))
xinxiang_cunzhuang
jiaozuo_cunzhuang <- jiaozuo_cunzhuang %>% group_by(省,城,区县,乡镇,改造方式) %>% summarise(X17年改造 = sum(X17年改造))
jiaozuo_cunzhuang

```

```{r}
write.csv(xinxiang_cunzhuang,"E://Rdata//coal//Xinxiang_cunzhuang_xiangzhen.csv")
write.csv(jiaozuo_cunzhuang,"E://Rdata//coal//Jiaozuo_cunzhuang_xiangzhen.csv")
```

```{r paged.print=FALSE}
xinxiang_zhi <- read.csv("E://Rdata//coal//Xinxiang_zhi.csv")
jiaozuo_zhi <- read.csv("E://Rdata//coal//Jiaozuo_zhi.csv")
head(xinxiang_zhi)
head(jiaozuo_zhi)
```

```{r paged.print=FALSE}
xinxiang_zhi <- xinxiang_zhi %>% group_by(省份代码,省份名称,地市代码,地市名称,区县名称,乡镇名称) %>% summarise(X17煤改气 = sum(X17煤改气),X17煤改电 = sum(X17煤改电),X18煤改气 = sum(X18煤改气),X18煤改电 = sum(X18煤改电),X19煤改气 = sum(X19煤改气),X19煤改电 = sum(X19煤改电))
jiaozuo_zhi <- jiaozuo_zhi %>% group_by(省份代码,省份名称,地市代码,地市名称,区县名称,乡镇名称) %>% summarise(X17煤改气 = sum(X17煤改气),X17煤改电 = sum(X17煤改电),X18煤改气 = sum(X18煤改气),X18煤改电 = sum(X18煤改电),X19煤改气 = sum(X19煤改气),X19煤改电 = sum(X19煤改电))
```

```{r}
write.csv(xinxiang_zhi, "E://Rdata//coal//Xinxiang_zhi_xiangzhen.csv",row.names = F)
write.csv(jiaozuo_zhi, "E://Rdata//coal//Jiaozuo_zhi_xiangzhen.csv",row.names = F)
```

```{r}
library(ggplot2)
library(tidyverse)
```


```{r paged.print=FALSE}
point <- read.csv("E://Rdata//coal//city point plot.csv")

# circle$地区 <- factor(circle$地区, levels = c("Beijing", "Tianjin", "Hebei", "Henan", "Shandong", "Shanxi", "Shaanxi",'"2+26"', "Fenwei"), ordered = T)

p1 <- point %>% filter(批次 == '“2+26”')
p2 <- point %>% filter(批次 == 'Fenwei')
as.tibble(p1)
```



```{r}
mytheme <- theme_minimal()+
  theme(
    panel.grid.major.y=element_blank(),
    panel.grid.minor.y=element_blank(),
    panel.grid.major.x=element_blank(),
    panel.grid.minor.x=element_blank(),
    panel.border = element_rect(fill = NA),
    # axis.text.x = element_text(angle = 45, hjust = 1),
    plot.title=element_text(hjust =0.5),
    axis.line.y=element_line(linetype=1,color='black'),
    axis.line.x=element_line(linetype=1,color='black'),
    axis.ticks = element_line(linetype=2,color='black'),
    # panel.grid=element_line(linetype=2,color='black'),
    # legend.background = element_rect(fill="gray90", size=0,color='white'),
    legend.text=element_text(face="bold",size=8),
    legend.title=element_text(face="bold",size=8),
    axis.text=element_text(face="bold",size=8)
  )


ggplot(data = p1) +
  aes(户均散煤用量, 总户数.万户., color = group) +
  # geom_hline(yintercept = circle$时间, color = "black") +
  geom_point(size = 2,pch = 16) + # aes(size = Hg.t.),
  scale_color_manual(values = list(
    "0-0.3" = "#E8E8E8",
    "0.3-0.5" = "#DFB0D6",
    "0.5-1.0" = "#BE64AC",
    "1.0-1.5" = "#8C62AA",
    "1.5-2.26" = "#3B4994"
    )) +
  # ylim(2016.5,2020.5) +
  mytheme +
  labs(color = 'Hg(t)', x = "户均年用散煤量(单位:户/吨)", y = "改造户数(万户)", title = '“2+26”城市') +
  scale_y_continuous(expand = c(0, 0))+
  coord_cartesian(ylim = c(0,500), xlim = c(1,3.5))

ggsave("E://Rdata//Rimage//city point plot_2+26.svg", plot = last_plot(), width = 5, height = 4.5)


ggplot(data = p2) +
  aes(户均散煤用量, 总户数.万户., color = group) +
  # geom_hline(yintercept = circle$时间, color = "black") +
  geom_point(size = 2,pch = 16) + # aes(size = Hg.t.),
  scale_color_manual(values = list(
    "0-0.3" = "#E8E8E8",
    "0.3-0.5" = "#DFB0D6",
    "0.5-1.0" = "#BE64AC",
    "1.0-2.0" = "#8C62AA",
    "2.0-2.26" = "#3B4994"
    )) +
  # ylim(2016.5,2020.5) +
  mytheme +
  labs(color = 'Hg(t)', x = "户均年用散煤量(单位:户/吨)", y = "改造户数(万户)", title = '汾渭平原地区') +
  scale_y_continuous(expand = c(0, 0))+
  coord_cartesian(ylim = c(0,200), xlim = c(1,3.5))
ggsave("E://Rdata//Rimage//city point plot_Fenwei.svg", plot = last_plot(), width = 5, height = 4.5)
```

```{r paged.print=FALSE}
data <- read.csv("E://Rdata//coal//2+26list.csv")
as_tibble(data)

```

```{r paged.print=FALSE}
d1 <- data %>% group_by(省,市) %>% summarise(煤改气替代户数.万户. = sum(煤改气替代户数.万户.), 煤改电替代户数.万户.  = sum(煤改电替代户数.万户.),集中供暖替代户数.万户.  = sum(集中供暖替代户数.万户.),煤改气替代量.万吨. = sum(煤改气替代量.万吨.),煤改电替代量.万吨. = sum(煤改电替代量.万吨.), 集中供暖替代量.万吨. = sum(集中供暖替代量.万吨.))
d1
```

```{r paged.print=FALSE}
d2 <- d1 %>% group_by(省,市) %>% summarise(替代户.万户. = sum(煤改气替代户数.万户.,煤改电替代户数.万户.,集中供暖替代户数.万户.), 替代量.万吨. = sum(煤改气替代量.万吨.,煤改电替代量.万吨.,集中供暖替代量.万吨.))
```


## 热力图

### 社会实践
```{r paged.print=FALSE}
heat1 <- data.frame(city = c("济南","邢台","聊城","石家庄","滨州",
                       "濮阳","鹤壁","安阳","聊城","安阳","济南","安阳","滨州","濮阳",
                       "淄博","鹤壁","滨州","濮阳","济南","滨州","濮阳","滨州","安阳","滨州",
                       "聊城","濮阳","聊城","淄博","长治","长治","天津","天津","邯郸",
                       "天津","天津","济宁","济宁","邯郸","长治","天津","菏泽","天津","长治",
                       "邯郸","天津","邯郸","长治","菏泽","天津","济南","邢台","聊城",
                       "石家庄","滨州","濮阳","鹤壁","安阳","聊城","安阳","济南","安阳",
                       "滨州","濮阳","淄博","鹤壁","滨州","濮阳","济南","滨州","濮阳","滨州",
                       "安阳","滨州","聊城","濮阳","聊城","淄博","长治","长治","天津",
                       "天津","邯郸","天津","天津","济宁","济宁","邯郸","长治","天津","菏泽",
                       "天津","长治","邯郸","天津","邯郸","长治","菏泽","天津","济南",
                       "邢台","聊城","石家庄","滨州","濮阳","鹤壁","安阳","聊城","安阳",
                       "济南","安阳","滨州","濮阳","淄博","鹤壁","滨州","濮阳","济南","滨州",
                       "濮阳","滨州","安阳","滨州","聊城","濮阳","聊城","淄博","长治",
                       "长治","天津","天津","邯郸","天津","天津","济宁","济宁","邯郸","长治",
                       "天津","菏泽","天津","长治","邯郸","天津","邯郸","长治","菏泽",
                       "天津","济南","邢台","聊城","石家庄","滨州","濮阳","鹤壁","安阳",
                       "聊城","安阳","济南","安阳","滨州","濮阳","淄博","鹤壁","滨州","濮阳",
                       "济南","滨州","濮阳","滨州","安阳","滨州","聊城","濮阳","聊城",
                       "淄博","长治","长治","天津","天津","邯郸","天津","天津","济宁","济宁",
                       "邯郸","长治","天津","菏泽","天津","长治","邯郸","天津","邯郸",
                       "长治","菏泽","天津","济南","邢台","聊城","石家庄","滨州","濮阳",
                       "鹤壁","安阳","聊城","安阳","济南","安阳","滨州","濮阳","淄博","鹤壁",
                       "滨州","濮阳","济南","滨州","濮阳","滨州","安阳","滨州","聊城",
                       "濮阳","聊城","淄博","长治","长治","天津","天津","邯郸","天津","天津",
                       "济宁","济宁","邯郸","长治","天津","菏泽","天津","长治","邯郸",
                       "天津","邯郸","长治","菏泽","天津","济南","邢台","聊城","石家庄",
                       "滨州","濮阳","鹤壁","安阳","聊城","安阳","济南","安阳","滨州","濮阳",
                       "淄博","鹤壁","滨州","濮阳","济南","滨州","濮阳","滨州","安阳",
                       "滨州","聊城","濮阳","聊城","淄博","长治","长治","天津","天津","邯郸",
                       "天津","天津","济宁","济宁","邯郸","长治","天津","菏泽","天津",
                       "长治","邯郸","天津","邯郸","长治","菏泽","天津"),
                户数 = c(14L,40L,3L,29L,7L,9L,13L,
                       8L,3L,19L,7L,12L,7L,15L,25L,7L,34L,10L,19L,
                       9L,10L,8L,11L,16L,7L,11L,7L,27L,12L,12L,8L,10L,
                       15L,10L,11L,16L,17L,19L,12L,27L,3L,13L,12L,
                       10L,12L,15L,11L,35L,9L,14L,40L,3L,29L,7L,9L,
                       13L,8L,3L,19L,7L,12L,7L,15L,25L,7L,34L,10L,19L,
                       9L,10L,8L,11L,16L,7L,11L,7L,27L,12L,12L,8L,
                       10L,15L,10L,11L,16L,17L,19L,12L,27L,3L,13L,12L,
                       10L,12L,15L,11L,35L,9L,14L,40L,3L,29L,7L,9L,
                       13L,8L,3L,19L,7L,12L,7L,15L,25L,7L,34L,10L,
                       19L,9L,10L,8L,11L,16L,7L,11L,7L,27L,12L,12L,8L,
                       10L,15L,10L,11L,16L,17L,19L,12L,27L,3L,13L,
                       12L,10L,12L,15L,11L,35L,9L,14L,40L,3L,29L,7L,9L,
                       13L,8L,3L,19L,7L,12L,7L,15L,25L,7L,34L,10L,
                       19L,9L,10L,8L,11L,16L,7L,11L,7L,27L,12L,12L,
                       8L,10L,15L,10L,11L,16L,17L,19L,12L,27L,3L,13L,
                       12L,10L,12L,15L,11L,35L,9L,14L,40L,3L,29L,7L,
                       9L,13L,8L,3L,19L,7L,12L,7L,15L,25L,7L,34L,10L,
                       19L,9L,10L,8L,11L,16L,7L,11L,7L,27L,12L,12L,
                       8L,10L,15L,10L,11L,16L,17L,19L,12L,27L,3L,13L,
                       12L,10L,12L,15L,11L,35L,9L,14L,40L,3L,29L,7L,
                       9L,13L,8L,3L,19L,7L,12L,7L,15L,25L,7L,34L,
                       10L,19L,9L,10L,8L,11L,16L,7L,11L,7L,27L,12L,
                       12L,8L,10L,15L,10L,11L,16L,17L,19L,12L,27L,3L,
                       13L,12L,10L,12L,15L,11L,35L,9L),
             index = c("AQ","AQ","AQ","AQ","AQ",
                       "AQ","AQ","AQ","AQ","AQ","AQ","AQ","AQ","AQ","AQ",
                       "AQ","AQ","AQ","AQ","AQ","AQ","AQ","AQ","AQ",
                       "AQ","AQ","AQ","AQ","AQ","AQ","AQ","AQ","AQ","AQ",
                       "AQ","AQ","AQ","AQ","AQ","AQ","AQ","AQ","AQ",
                       "AQ","AQ","AQ","AQ","AQ","AQ","SC","SC","SC","SC",
                       "SC","SC","SC","SC","SC","SC","SC","SC","SC",
                       "SC","SC","SC","SC","SC","SC","SC","SC","SC","SC",
                       "SC","SC","SC","SC","SC","SC","SC","SC","SC",
                       "SC","SC","SC","SC","SC","SC","SC","SC","SC","SC",
                       "SC","SC","SC","SC","SC","SC","SC","EA","EA",
                       "EA","EA","EA","EA","EA","EA","EA","EA","EA","EA",
                       "EA","EA","EA","EA","EA","EA","EA","EA","EA",
                       "EA","EA","EA","EA","EA","EA","EA","EA","EA","EA",
                       "EA","EA","EA","EA","EA","EA","EA","EA","EA",
                       "EA","EA","EA","EA","EA","EA","EA","EA","EA","LC",
                       "LC","LC","LC","LC","LC","LC","LC","LC","LC",
                       "LC","LC","LC","LC","LC","LC","LC","LC","LC","LC",
                       "LC","LC","LC","LC","LC","LC","LC","LC","LC",
                       "LC","LC","LC","LC","LC","LC","LC","LC","LC","LC",
                       "LC","LC","LC","LC","LC","LC","LC","LC","LC",
                       "LC","HS","HS","HS","HS","HS","HS","HS","HS","HS",
                       "HS","HS","HS","HS","HS","HS","HS","HS","HS",
                       "HS","HS","HS","HS","HS","HS","HS","HS","HS","HS",
                       "HS","HS","HS","HS","HS","HS","HS","HS","HS",
                       "HS","HS","HS","HS","HS","HS","HS","HS","HS","HS",
                       "HS","HS","PE","PE","PE","PE","PE","PE","PE",
                       "PE","PE","PE","PE","PE","PE","PE","PE","PE","PE",
                       "PE","PE","PE","PE","PE","PE","PE","PE","PE",
                       "PE","PE","PE","PE","PE","PE","PE","PE","PE","PE",
                       "PE","PE","PE","PE","PE","PE","PE","PE","PE",
                       "PE","PE","PE","PE"),
                 n = c(70,198,15,116,28,29.97,
                       52.13,37.04,15,73.91,35,56.04,24.99,55.95,100,
                       30.03,166.94,38,84.93,45,39,40,47.96,78.08,34.02,
                       42.02,32.97,100,48.96,48.96,37.04,47,75,47,51.04,
                       72.96,72.93,88.92,57,117.99,12.99,63.96,54,50,
                       56.04,70.95,49.5,171.15,43.02,70,193.2,15,127.89,
                       28,32.04,52,36,15,87.02,35,56.04,28,58.95,100,
                       31.01,170,37,87.97,45,41,40,51.04,78.08,34.02,
                       45.98,32.97,100,50.04,50.04,39.04,47,75,47,51.04,
                       72.96,72.93,91.96,54,122.04,12,65,48.96,50,59.04,
                       72,51.37,164.15,43.02,67.06,180,15,116,35,
                       35.01,50.05,37.04,15,79.04,34.02,50.04,24.99,60,100,
                       30.03,170,37,88.92,45,43,40,51.04,78.08,32.97,
                       45.98,32.97,100,48.96,51,31.04,46,64.05,47,47.96,
                       72,73.95,86.07,51.96,122.04,11.01,65,48.96,50,
                       54,67.05,49.5,163.1,41.04,65.94,196,15,115.13,35,
                       35.01,52,34,15,75.05,32.97,48.96,21.98,55.95,
                       100,31.01,168.98,37,91.96,45,43,40,47.96,78.08,
                       32.97,43.01,32.97,100,48.96,48.96,28,45,72,47,
                       46.97,72.96,74.97,83.98,54,122.04,12.99,65,56.04,
                       50,47.04,67.95,54.12,164.85,37.98,58.94,200,14.01,
                       102.95,35,19.98,50.96,30,14.01,69.92,31.99,39.96,
                       17.99,40.95,100,28.98,125.12,26,87.02,27,24,40,
                       34.98,60.96,28.98,22.99,31.99,100,29.04,30.96,
                       24,36,39,23,40.04,36.96,56.95,41.99,26.04,76.95,
                       12,47.97,32.04,25,45.96,34.05,26.62,102.9,32.04,
                       64.96,199.2,15,122.96,35,29.97,54.99,39.04,15,
                       79.99,31.99,45.96,28,61.05,100,31.99,144.84,35,
                       87.02,36,47,40,44,60,34.02,48.95,31.99,100,48.96,
                       50.04,32,47,75,47,46.97,76.96,80.92,88.92,51.96,
                       123.93,15,63.96,51,50,48,70.95,48.62,164.15,
                       41.04)
)
heat1 <- heat1 %>% group_by(city = city,index = index) %>% summarise(n=sum(n)/sum(户数))
heat1$index <- factor(heat1$index,levels = c("AQ","SC","EA",'LC',"HS",'PE'),ordered = T)
heat2 <- data.frame(city = c("济南","邢台","聊城","石家庄","滨州",
                       "濮阳","鹤壁","安阳","聊城","安阳","济南","安阳","滨州","濮阳",
                       "淄博","鹤壁","滨州","濮阳","济南","滨州","濮阳","滨州","安阳","滨州",
                       "聊城","濮阳","聊城","淄博","长治","长治","天津","天津","邯郸",
                       "天津","天津","济宁","济宁","邯郸","长治","天津","菏泽","天津","长治",
                       "邯郸","天津","邯郸","长治","菏泽","天津"),
             index = c("综合幸福指数","综合幸福指数","综合幸福指数",
                       "综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数",
                       "综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数",
                       "综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数",
                       "综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数",
                       "综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数",
                       "综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数",
                       "综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数",
                       "综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数","综合幸福指数",
                       "综合幸福指数"),
                 n = c(13.3,38.8,2.97,23.49,6.51,
                       6.03,10.53,7.12,2.97,15.58,6.72,9.96,4.9,11.1,20,
                       6.09,31.62,7,17.67,8.1,7.9,8,9.24,14.4,6.58,
                       8.25,6.51,21.6,9.16,9.33,6.37,8.93,13.34,8.6,9.47,
                       13.49,14.42,16.06,9.83,22.83,2.53,12.36,9.7,
                       9.17,10.34,12.77,9.32,31.01,7.94),
                户数 = c(14L,40L,3L,29L,7L,9L,13L,
                       8L,3L,19L,7L,12L,7L,15L,25L,7L,34L,10L,19L,
                       9L,10L,8L,11L,16L,7L,11L,7L,27L,12L,12L,8L,10L,
                       15L,10L,11L,16L,17L,19L,12L,27L,3L,13L,12L,
                       10L,12L,15L,11L,35L,9L)
)
heat2 <- heat2 %>% group_by(city = city,index = index) %>% summarise(n=sum(n)/sum(户数))

heat1$city <- factor(heat1$city,levels = c("淄博","长治","邢台","天津","石家庄","濮阳","聊城","济宁","济南","鹤壁","菏泽","邯郸","滨州","安阳"),ordered = F)
heat2$city <- factor(heat2$city,levels = c("淄博","长治","邢台","天津","石家庄","濮阳","聊城","济宁","济南","鹤壁","菏泽","邯郸","滨州","安阳"),ordered = F)

# 计算95%区间

library(truncnorm)
library(Rmisc)
for(i in c("AQ","SC","EA",'LC',"HS",'PE')){
  # df <- heat1[heat1$index == i,]
  # sup <- mean(df$n) + sd(df$n)*qnorm(0.05)

  sup <- CI(heat1[heat1$index == i,]$n,0.95)
  # upp <- mean(df$n) + sd(df$n)*qnorm(0.975)
  print(paste(i,"的95%置信区间:"))
  print(sup)

}


```


```{r}
ggplot(data = heat1, aes(x = index, y = city)) + 
  geom_tile(aes(fill = n),color = "black") +
  # scale_color_brewer(palette = "Blues")
  scale_fill_gradientn(colours = c("#8EC31F","#DADF00","#F7EE14","#F39800","#EA5412"))+
  theme_light()
ggsave("E://Rdata//Rimage//heatmap1.svg")

ggplot(data = heat2, aes(x = index, y = city)) + 
  geom_tile(aes(fill = n),color = "black") +
  # scale_color_brewer(palette = "Blues")
  scale_fill_gradientn(colours = c("#8EC31F","#DADF00","#F7EE14","#F39800","#EA5412"))+
  theme_light()
ggsave("E://Rdata//Rimage//heatmap2.svg",width = 2,height = 4)
```




### 中国32省市汞沉降减少量

```{r}
heat3 <- data.frame(
    province = c("ZJ","YN","XZ","XJ","TW",
                 "TJ","SX","SHX","SH","SD","SC","QH","NX","LN",
                 "JX","JS","JL","IM","HN","HLJ","HEN","HEB","HB",
                 "HAN","GZ","GX","GS","GD","FJ","CQ","BJ","AH"),
    changedep = c(-10.0570525,-25.9897922,
                  -13.3858462,-20.35286268,-3.3782157,-20.50767,-86.467505,
                  -128.746559,-0.440567,-75.1036888,-47.1567691,
                  -9.1670741,-5.787881,-17.0091852,-18.854841,-12.2841787,
                  -11.6275966,-51.3756722,-35.487003,-18.3143567,
                  -141.788683,-174.712031,-41.880313,-12.1034066,-24.20349,
                  -34.0692383,-31.7636341,-16.814108,-11.1254697,-14.847669,
                  -9.74212,-24.702873),
    index = c("changedep","changedep",
              "changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep")
)

```

```{r}
heat3$province <- factor(heat3$province, levels = c("ZJ","YN","XZ","XJ","TW",
                 "TJ","SX","SHX","SH","SD","SC","QH","NX","LN",
                 "JX","JS","JL","IM","HN","HLJ","HEN","HEB","HB",
                 "HAN","GZ","GX","GS","GD","FJ","CQ","BJ","AH"),ordered = F)
```


```{r}
# "#A5ADD3",
library(ggplot2)
ggplot(data = heat3, aes( x = index,y = province)) + 
  geom_tile(aes(fill = changedep),color = "black",) +
  # scale_color_brewer(palette = "Blues")
  scale_fill_gradientn(colours = c("#3A4895","#8D62AB","#BF64AD","#DFB1D7","#E9E9E9"))+
  theme_light() +
   theme( axis.text.y = element_text(size = 10,hjust = 0.5))
ggsave("E://heatmap4.svg",width = 3,height = 10)
```

## 弦图

### 一维arc diagram


```{r}
data <- data.frame(
    from = c("Deposotion reduction",
             "Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction",
             "Deposotion reduction","Deposotion reduction","Deposotion reduction"),
    to = c("AH","BJ","CQ","FJ","GD",
           "GS","GX","GZ","HAN","HB","HEB","HEN","HLJ","HN",
           "IM","JL","JS","JX","LN","NX","QH","SC","SD",
           "SH","SHX","SX","TJ","TW","XJ","XZ","YN","ZJ"),
    value = c(-24.702873,-9.74212,
              -14.847669,-11.1254697,-16.814108,-31.7636341,-34.0692383,
              -24.20349,-12.1034066,-41.880313,-174.712031,-141.788683,
              -18.3143567,-35.487003,-51.3756722,-11.6275966,
              -12.2841787,-18.854841,-17.0091852,-5.787881,-9.1670741,
              -47.1567691,-75.1036888,-0.440567,-128.746559,
              -86.467505,-20.50767,-3.3782157,-20.35286268,-13.3858462,
              -25.9897922,-10.0570525)
)

co <- data.frame(
    name = c("Deposotion reduction","AH","BJ","CQ","FJ","GD",
           "GS","GX","GZ","HAN","HB","HEB","HEN","HLJ","HN",
           "IM","JL","JS","JX","LN","NX","QH","SC","SD",
           "SH","SHX","SX","TJ","TW","XJ","XZ","YN","ZJ"),
    n = c(sum(data$value),-24.702873,-9.74212,
              -14.847669,-11.1254697,-16.814108,-31.7636341,-34.0692383,
              -24.20349,-12.1034066,-41.880313,-174.712031,-141.788683,
              -18.3143567,-35.487003,-51.3756722,-11.6275966,
              -12.2841787,-18.854841,-17.0091852,-5.787881,-9.1670741,
              -47.1567691,-75.1036888,-0.440567,-128.746559,
              -86.467505,-20.50767,-3.3782157,-20.35286268,-13.3858462,
              -25.9897922,-10.0570525),
    group = c("all","changedep",
              "changedep","changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep","changedep",
              "changedep","changedep","changedep","changedep")
)
```


```{r paged.print=FALSE}
library(igraph)
mygraph <- graph_from_data_frame(data, vertices = co, directed = FALSE)
# 鉴定社区
com <- walktrap.community(mygraph)
#重新整理数据
coline <- co %>%
 mutate(grp = com$membership) %>%
 arrange(grp) %>%
 mutate(name=factor(name, name))
mygraph2 <- graph_from_data_frame(data, vertices = coline, directed = FALSE)
mygraph2
```



```{r}
library(RColorBrewer)
library(ggplot2)
library(ggraph)
mycolor<-colorRampPalette(brewer.pal(7, "Set3"))

 ggraph(mygraph2, layout="linear") +
 geom_edge_arc(edge_colour= "black", edge_alpha=0.2, edge_width=1,fold=TRUE) +

 geom_node_point(aes(size=-n, color="black")) +
 scale_size_continuous(range=c(1,10)) +
 scale_color_manual(values=mycolor(33)) +
 geom_node_text(aes(label=name), angle=90, hjust=0.5, nudge_y = -1.1, size=2.8)  +

 theme(
 legend.position="none",
 plot.margin=unit(c(0,0,0.5,0), "null"),
 panel.spacing=unit(c(0,0,2,0), "null")
 ) +
 expand_limits(x = c(-3, 1.2), y = c(-6, 1.2))
ggsave("E://arc.svg", plot = last_plot())
```




## 鸡冠图
```{r paged.print=FALSE}
okokok <- read.csv('E://Rdata//coal//country.csv')
coalto_x <- okokok %>% select(省,市,gas_equality,electricity_equality,others_equality) %>% gather(way,number,-省,-市)
BJ <- coalto_x[coalto_x$省 == "北京市",]
TJ <- coalto_x[coalto_x$省 == "天津市",]
HB <- coalto_x[coalto_x$省 == "河北省",]
HN <- coalto_x[coalto_x$省 == "河南省",]
SD <- coalto_x[coalto_x$省 == "山东省",]
Shanxi <- coalto_x[coalto_x$省 == "山西省",]
Shaanxi <- coalto_x[coalto_x$省 == "陕西省",]

# 若换省份图，更改这一项
HB <- HB
HB
HB$way <- factor(HB$way, levels = c("others_equality","electricity_equality","gas_equality"),ordered = F)


```

```{r paged.print=FALSE}
# 绘制条形图
p<-ggplot(HB,aes(x=市,y=number,fill=way))+geom_bar(stat="identity",color="black")
# 将条形图进行极坐标化
p+coord_polar()
# # 中间挖空
# p+coord_polar() + ylim(-100,100)
# 进行排序处理
p<-ggplot(data=HB,aes(x=reorder(市,number),y=number,fill=way))+
  geom_bar(stat="identity",color="black",size = 0.1, width = 1)

# 进行美化、添加标题等处理
HB$label=paste(HB$市)
p+coord_polar()+
  theme_bw()+
    scale_fill_manual(values = list(
    "others_equality" = "#EA5412",
    "electricity_equality" = "#F39800",
    "gas_equality" = "#8EC31F"
    )) +
  # theme(panel.grid = element_blank(),
  #       panel.border= element_blank(),
  #       axis.text.y = element_blank(),
  #       axis.text.x = element_blank(),
  #       axis.ticks = element_blank(),
  #       axis.title = element_blank()) +
  # geom_text(aes(y = 30,label=市),color="black",size = 2.5)+
  ggtitle("河北省") 
  # annotate("text", x = rep(max(HB$number),5), y = c(0, 10, 20, 30, 40), label = c("0", "50", "100", "150", "200") , color="grey", size=2 , angle=0, fontface="bold", hjust=1)
  # annotate("text",x=0, y=-50, label="各省\n2019年\nGDP", fontface="bold", colour="steelblue", size=6)
  # geom_text(aes(label=HB$label),size=3,vjust ="left",hjust ="outward",fontface="bold" )
  # guides(fill=F)
ggsave("E://Rdata//Rimage//roses_Hebei.svg")
```

```{r paged.print=FALSE}
library(ggpubr)
lollipop1 <- data.frame(pollution = c("NOx","CO","CO2","SO2","PM2.5","NH3"),
  emission.reduction.unit.tons. = c(113329.8239,6179457.766,111641806,864885.4982,578578.5746,53682.54816)
)

lollipop2 <- data.frame(pollution = c("Hg","Cr","Cd","Pb","As"),
  emission.reduction.unit.tons. = c(3.877072923,31.01658338,1.968360099,220.6949202,
                                      5.666491195)
)

p1 <- ggdotchart(lollipop1, x = "pollution", y = "emission.reduction.unit.tons.",
           color = "black",                                # 按照cyl填充颜色
           # palette = c("#00AFBB", "#E7B800", "#FC4E07"), # 修改颜色
           sorting = "ascending",                        
           add = "segments",   # 添加棒子
           add.params = list(color = "lightgray", size = 1.5),
           ggtheme = theme_pubr(),                        # 改变主题
           xlab="",ylab = "emission reduction(unit:tons)"
) +
  coord_cartesian(ylim = c(0,6500000))   #设置下面一半的值域

p2 <- ggdotchart(lollipop1, x = "pollution", y = "emission.reduction.unit.tons.",
           color = "black",                                # 按照cyl填充颜色
           # palette = c("#00AFBB", "#E7B800", "#FC4E07"), # 修改颜色
           sorting = "ascending",                        
           add = "segments",   # 添加棒子
           add.params = list(color = "lightgray", size = 1.5),
           ggtheme = theme_pubr(),                        # 改变主题
           xlab="",ylab = "emission reduction(unit:tons)"
) +
  labs(x=NULL,y=NULL,fill=NULL) +   #不要标签
  theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +     #去掉X轴和X轴的文字
    coord_cartesian(ylim = c(111640000,111650000))   #设置下面一半的值域

ggarrange(p2,p1,heights=c(1/5, 4/5),ncol = 1, nrow = 2,common.legend = TRUE,legend="right",align = "v") 

ggdotchart(lollipop2, x = "pollution", y = "emission.reduction.unit.tons.",
           color = "black",                                # 按照cyl填充颜色
           # palette = c("#00AFBB", "#E7B800", "#FC4E07"), # 修改颜色
           sorting = "ascending",                        
           add = "segments",   # 添加棒子
           add.params = list(color = "lightgray", size = 1.5),
           ggtheme = theme_pubr(),                        # 改变主题
           xlab="",ylab = "emission reduction(unit:tons)"
) 
  #  theme(axis.text.x = element_blank(),axis.ticks.x = element_blank()) +     #去掉X轴和X轴的文字
  # coord_cartesian(ylim = c(210,230))   #设置上面一半的值域
  # scale_y_continuous(breaks = c(195,205,5)) #以5为单位划分Y轴

```

## 棒棒糖图

```{r}
library(ggpubr)

lollipop1 <- data.frame(year = c("2017年","2018年","2019年","2020年"),
  n = c(474.30,537.97,557.75 ,549.88)
)
 


lollipop2 <- data.frame(way = c("改气","改电","其他"),
  n = c(1127.70,754.34,237.87)
)

 


ggdotchart(lollipop1, x = "year", y = "n",
           color = "black",                                # 按照cyl填充颜色
           # palette = c("#00AFBB", "#E7B800", "#FC4E07"), # 修改颜色
           sorting = "ascending",                        
           add = "segments",   # 添加棒子
           add.params = list(color = "lightgray", size = 1.5),
           ggtheme = theme_pubr(),                        # 改变主题
           xlab="",ylab = "改造户数（万户）"
) +
  coord_cartesian(ylim = c(0,600))

ggplot(lollipop1,aes(x = year, y = n)) +
  geom_point(size = 10) +
  geom_segment(aes(x = year,xend = year,y = 400,yend = n), size = 3) +
  ylab("改造户数（万户）") +
  ylim(400,600) +
  theme_bw()
  
```






## 气泡图


```{r}
bubble <-data.frame(村 = c("北山子后","陈","堤口冯","东汉","东马营",
                       "董楼南","方寨","葛庄","葛庄","观寨","郭家沟","韩庄","河东",
                       "后韩胡同","尖西","南关","前游","清北","顺河","孙家庄子","王助东","西李",
                       "西裴","下坡李","杨楼","张寨","周口冯","淄井","东堰","岗上","官地",
                       "国和庄","后台街","罗古判","南漳泗河","上九山","深井","石桥","石泉","石西",
                       "西马亥","西南庄","西泼","西烟","下营","新清流","堰漕","尹楼","营周庄"),
            综合幸福指数 = c(0.95,0.97,0.99,0.81,0.93,
                       0.67,0.81,0.89,0.99,0.82,0.96,0.83,0.7,0.74,0.8,
                       0.87,0.93,0.7,0.93,0.9,0.79,1,0.84,0.9,0.94,
                       0.75,0.93,0.8,0.76,0.78,0.8,0.89,0.89,0.86,0.86,
                       0.84,0.85,0.85,0.82,0.85,0.84,0.95,0.81,0.92,0.86,
                       0.85,0.85,0.89,0.88),
         实际支出的平均费用 = c(1.74,2.82,1.26,4.65,0,0.94,
                       1.34,2.86,2.07,0,0.29,1.78,2.71,0.85,2.31,1.48,
                       0.08,0.84,1.72,2.69,1.68,1.97,1.71,0,1.62,1.85,
                       0.99,1.64,2.59,2.38,2.16,1.98,2.3,2.02,2.06,
                       2.8,1.03,2.42,4.24,1.02,2.04,2.08,2.46,2.37,1.67,
                       2.52,2.35,3.29,1.83),
             家庭年收入 = c(3.14,7.59,8.33,7.07,6,5,
                       6.69,7.81,9.17,6.11,2.86,8.25,4,4.27,4.08,5.79,
                       5.6,2.7,2.68,4.39,6.1,7.5,6.86,6.41,7.57,4.73,
                       7.43,3.67,5.29,5.96,7.25,8.3,5.63,4.85,9.09,4.69,
                       3.94,3.53,6.17,2.98,10,9.23,6.33,5.75,6.83,4,
                       4.79,8.74,6.78)
)

# library(Rmisc)
# CI(x,ci=0.95)

# install.packages('truncnorm')
# library(truncnorm)
# norm_data <- rnorm(n = 1000, mean = 90, sd = 4)
# hist(norm_data)
# truncnorm_data <- rtruncnorm(n = 1000, a = 85, b = 100, mean = 90, sd = 4)
# hist(truncnorm_data)

sup <- CI(bubble$综合幸福指数,0.95)
# upp <- mean(bubble$综合幸福指数) + sd(bubble$综合幸福指数)*qnorm(0.975)
print(paste("综合幸福指数","的95%置信区间:"))
print(sup)
```

```{r paged.print=FALSE}

  ggplot(bubble, aes(x=实际支出的平均费用, y=综合幸福指数, size=家庭年收入, fill=家庭年收入)) +
    geom_point(alpha=0.5, shape=21, color="black") +
    scale_size(range = c(.1, 14), name="家庭年收入(万元)") +
    # scale_fill_viridis(discrete=F, guide=F, option="A") +
    # theme_ipsum() +
    theme_bw() +
    scale_fill_gradientn(colours = c("#8EC31F","#DADF00","#F7EE14","#F39800","#EA5412")) +
    
    geom_hline(yintercept = 0.8579592, color = "red", size = 0.8) +
    geom_hline(yintercept = 0.8357258,size = 0.5) +
    geom_hline(yintercept = 0.8801926,size = 0.5) +
    # geom_hline(yintercept = 0.8082033,size = 0.5,color = "red", linetype = 2) +
    # geom_hline(yintercept = 0.7929162,size = 0.5) +
    # geom_hline(yintercept = 0.8236450,size = 0.5) +

    # 燃煤
    geom_vline(xintercept = 1.242948, color = "red", linetype = 2) +
    geom_vline(xintercept = 1.022617, color = "black", linetype = 1) +
    geom_vline(xintercept = 1.463279, color = "black", linetype = 1) +
    # 清洁取暖支出
    geom_vline(xintercept = 1.867347, color = "red", linetype = 2) +
    geom_vline(xintercept = 1.589523, color = "blue", linetype = 1) +
    geom_vline(xintercept = 2.145171, color = "blue", linetype = 1) +




    # theme(legend.position="bottom") +
    ylab("综合幸福指数") +
    xlab("实际支出的平均费用(千元)") +
    scale_y_continuous(expand = c(0, 0))+
  coord_cartesian(ylim = c(0.65,1.02), xlim = c(0,5))+
    theme(legend.position = "right",
          legend.title = element_text(size=6))
ggsave("E://Rdata//Rimage//bubbles.svg")  #,height = 4.1,width =6
```



## 雷达图
```{r}

library(ggradar)

HB <- data.frame(opt = c("是，有专门的公职人员或 \n 志愿者进行宣讲介绍 \n （或张贴相关告示、海报等）","否，目前暂无人进行 \n 相关介绍","是，已完 \n 全到账","是，但只有部分到账","否， \n 还未到账"), n = c(581,95,530,26,24), ratio = c(0.8595,0.1405,0.9138,0.0448,0.0414),le = 1:5)
HB$opt <- factor(HB$opt,levels = c("否，目前暂无人进行 \n 相关介绍","是，已完 \n 全到账","是，但只有部分到账","否， \n 还未到账","是，有专门的公职人员或 \n 志愿者进行宣讲介绍 \n （或张贴相关告示、海报等）") )

p<-ggplot(data=HB,aes(x=opt,y=n,size=ratio))+
  geom_point(color = "#EA5412") +
  geom_point(color = "blue", size = 0.4, type = 8) +

  scale_size(range = c(.9, 14))

x<-c(0,20,30,50,100,500,550,600)


p+
  coord_polar()+
  scale_y_continuous(breaks = x,labels = x,limits = c(0,x[8])) +
  geom_hline(aes(yintercept=0), lwd=1, lty=2) +
  theme_bw()+
  ggtitle("B8 + B17") 
ggsave("E://Rdata//Rimage//radar.svg", plot = last_plot())

```


```{r}
HB <- data.frame(opt = c("经常提供上门维护服务","需要主动联系服务单位","偶尔提供上门维护服务","未曾接受相关维护服务"), n = c(0.2276*580,0.3776*580,0.1845*580,0.2103*580))
HB$opt <- factor(HB$opt,levels = c("经常提供上门维护服务","需要主动联系服务单位","偶尔提供上门维护服务","未曾接受相关维护服务"))

p<-ggplot(data=HB,aes(x=opt,y=n,size=n))+
  geom_point(color = "#EA5412") +
  geom_point(color = "blue", size = 0.4, type = 8) +

  scale_size(range = c(9.9, 19))

x<-c(0,20,30,50,100,500,550,600)


p+
  coord_polar()+
  # scale_y_continuous(breaks = x,labels = x,limits = c(0,x[8])) +
  geom_hline(aes(yintercept=0), lwd=1, lty=2) +
  theme_bw()+
  ggtitle("表4.1") 
ggsave("E://Rdata//Rimage//radar2.svg", plot = last_plot())
```

```{r}
# install.packages("goffda")
library(goffda)
```

```{r}
# 设置默认值
mu=mean(fp$实际支出的平均费用)
sigma=sd(fp$实际支出的平均费用)/sqrt(length(fp$实际支出的平均费用))
a=0
b=1e1

# 设置 x 的 grid
x = seq(a, b, l=1e3)

# 定义函数
# fx1 = ( (1/((pnorm(b,mu,sigma)-pnorm(a,mu,sigma))*sqrt(2*pi*sigma^2))*
#           exp(-( (x-mu)^2/(2*sigma^2))) ))

fx1 = ( (1/(sqrt(2*pi*sigma^2))*
          exp(-( (x-mu)^2/(2*sigma^2))) ))

# 利用integral1D(.)函数，设置 trapezoid 法和 Simpson 法分别计算积分
int_fx1_trap = integral1D(fx = fx1, t = x, int_rule = "trapezoid",
                           equispaced = TRUE)
int_fx1_Simp = integral1D(fx = fx1, t = x, int_rule = "Simpson",
                           equispaced = TRUE)

# 输出结果

int_fx1_trap
int_fx1_Simp
fx1
```


```{r paged.print=FALSE}
al = (a-mu)/sigma
be = (b - mu)/sigma

Fb = integral1D(fx = fb, t = x, int_rule = "Simpson",
                           equispaced = TRUE)
Fa = integral1D(fx = fa, t = x, int_rule = "Simpson",
                           equispaced = TRUE)

junzhi <- mu - sigma*(0 - 0)  /  (int_fx1_trap - 0)
xigema <- sqrt(
  sigma**2 * (1 - 0 - 0)
               )
be
al
sigma
```
## 户级指标置信区间

```{r}
index <- data.frame(AQ = c(5,5,5,5,5,4,5,5,4,5,5,3,4,3,3,
                 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,4,5,5,5,5,5,4,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,2,2,4,4,4,
                 3,4,4,3,4,4,4,5,5,5,4,4,4,5,4,4,5,4,3,4,4,
                 4,4,3,4,4,4,4,4,4,4,4,3,5,4,4,5,4,4,5,4,4,
                 5,5,4,4,4,4,4,5,4,4,4,4,4,5,4,4,4,4,3,4,4,
                 5,4,5,4,4,4,5,4,4,4,4,5,4,3,5,5,3,5,4,5,5,
                 4,5,3,4,4,4,3,4,3,4,3,4,5,3,4,4,4,4,5,4,5,
                 4,4,4,4,4,5,4,4,4,4,5,4,3,3,4,4,4,3,3,3,3,
                 4,5,5,4,5,5,5,4,5,5,5,5,5,5,3,5,5,5,5,5,4,
                 3,4,4,5,3,4,4,5,4,4,4,3,5,4,4,3,4,4,4,4,5,
                 5,4,5,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,
                 4,4,4,4,4,4,4,4,4,5,4,4,4,3,3,5,5,5,5,5,5,
                 5,4,5,5,5,5,5,5,3,5,4,5,4,5,5,5,5,5,5,3,5,
                 5,5,5,5,5,5,5,5,5,5,5,4,5,5,4,5,5,5,5,5,5,
                 5,5,5,5,4,5,5,4,3,4,4,3,4,4,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,5,4,4,
                 5,4,3,4,5,5,5,4,5,5,5,5,5,4,4,5,5,5,5,5,4,
                 4,4,5,4,4,5,5,4,5,5,4,5,5,5,5,5,4,5,5,5,4,
                 4,5,4,4,4,5,5,5,4,5,4,4,5,5,4,5,4,4,4,4,4,
                 5,4,3,4,4,3,4,3,3,4,4,5,5,5,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,5,5,5,5,
                 4,5,5,5,5,5,5,3,5,5,4,5,5,5,5,5,5,5,4,5,4,
                 5,3,5,5,5,5,5,5,5,5,4,4,5,4,4,4,5,5,5,4,4,
                 3,4,4,4,5,4,4,5,5,5,4,5,5,5,3,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                 4,5,5,5,4,5,5,5,4,4,5,5,5,5,4,5,5,5,5,4,5,
                 4,5,4,5,5,5,3,5,4,5,4,4,4,5,4,5,5,4,4,5,5,
                 5,5,4,5,5,4,4,5,5,5,5,5,5,4,4,4,5,5,4,5,5,
                 4,4,5,4,5,5,5,5,4,4,5,4,5,5,3,4,4,3,5,5,4,
                 5,3,5,3,5,4,5,5,4,4,5,5,5,5,5,5,5,4,5,5,5,
                 5,5,5,4,5,5,5,5,5,5),
          SC = c(5,5,5,5,5,4,5,5,4,5,5,4,4,4,4,
                 4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,4,5,5,5,5,4,5,4,4,5,5,
                 5,5,5,4,5,4,5,5,5,5,4,5,5,5,5,5,3,2,4,4,4,
                 3,3,4,3,4,4,3,5,5,5,4,4,4,5,4,4,5,5,5,4,4,
                 4,4,5,4,5,4,4,4,5,4,5,4,5,5,4,4,5,4,5,5,4,
                 4,5,4,4,4,4,5,4,4,4,4,4,4,5,4,4,4,4,4,4,5,
                 5,5,5,4,5,4,5,4,4,4,5,4,5,5,5,5,5,5,4,5,5,
                 3,5,5,4,4,5,5,4,4,4,3,4,4,4,4,4,5,4,5,4,5,
                 4,4,4,4,4,5,4,4,4,4,5,4,4,3,4,4,4,4,4,4,3,
                 5,5,5,4,4,5,5,5,5,5,5,5,5,5,4,4,5,4,5,5,4,
                 4,5,4,5,5,4,4,5,3,3,5,4,5,4,5,4,3,4,3,4,5,
                 5,4,4,5,5,5,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,
                 4,4,4,4,4,4,4,4,4,5,4,4,4,4,4,5,5,5,5,5,5,
                 5,4,5,5,5,5,5,5,4,5,4,5,4,5,5,5,5,5,5,3,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,4,4,4,5,4,4,4,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,5,5,5,
                 5,5,4,4,5,5,5,4,5,5,5,5,5,4,5,5,5,5,5,4,5,
                 5,4,4,5,4,5,5,4,5,5,4,5,4,4,4,5,4,4,5,5,4,
                 4,5,4,4,4,4,4,4,3,4,5,4,5,4,5,5,4,4,4,4,4,
                 4,4,4,4,4,3,4,4,4,3,5,5,5,5,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,5,4,5,5,
                 5,5,5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,5,5,
                 5,3,5,5,5,5,4,5,5,5,5,4,5,4,5,4,5,5,5,4,4,
                 3,4,4,4,5,3,4,5,4,5,5,5,5,5,3,4,4,5,5,4,5,
                 5,5,5,5,5,4,5,5,5,5,5,5,5,4,5,5,5,5,5,4,4,
                 4,5,5,5,3,5,5,5,4,4,5,5,5,5,4,5,5,5,5,5,5,
                 4,5,4,5,5,5,3,5,4,5,5,5,5,5,5,5,5,5,4,5,5,
                 5,5,5,5,5,5,4,4,5,5,5,5,5,5,4,5,5,5,4,5,5,
                 4,4,5,4,5,5,5,5,4,4,5,4,5,5,3,4,5,3,5,5,5,
                 5,4,5,3,5,4,3,5,4,4,5,5,5,5,5,5,5,4,5,5,5,
                 5,5,5,5,5,5,5,5,5,5),
          EA = c(5,5,5,5,5,4,5,5,4,5,5,4,4,4,4,
                 4,3,4,4,3,4,3,4,5,5,4,5,4,5,5,5,4,5,5,5,5,
                 5,5,5,5,4,4,4,4,4,4,5,4,4,4,4,5,5,4,5,5,5,
                 5,5,5,4,4,5,4,4,4,5,5,4,4,5,4,4,4,3,4,4,4,
                 3,3,4,2,3,4,4,5,5,5,4,5,4,5,4,4,5,3,4,5,4,
                 4,4,5,4,4,4,4,4,4,5,5,4,5,3,4,5,4,3,4,5,4,
                 4,5,4,4,4,4,4,4,5,4,4,5,4,4,4,4,4,4,4,4,4,
                 4,4,4,4,4,4,5,4,4,5,4,4,4,3,5,5,3,5,4,5,5,
                 4,5,3,4,5,4,3,4,4,4,4,4,4,3,4,4,5,4,5,4,5,
                 4,4,4,5,4,5,4,5,4,4,5,4,4,4,4,4,4,3,4,4,4,
                 4,5,5,4,4,5,4,4,5,5,4,5,4,5,4,5,4,3,5,5,4,
                 4,5,4,4,5,5,3,5,3,4,5,4,5,4,5,3,3,5,3,4,5,
                 5,4,4,5,5,5,5,5,4,5,4,4,4,4,4,4,4,4,4,4,4,
                 4,4,4,4,4,4,4,4,5,5,4,4,4,5,4,5,5,5,5,5,5,
                 5,4,5,5,5,5,5,5,4,5,4,5,4,5,5,5,5,5,5,3,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,4,4,4,5,4,4,3,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,3,5,5,5,5,4,4,4,4,4,5,
                 5,4,4,3,5,5,5,4,5,5,5,5,5,4,5,4,5,5,5,5,4,
                 4,4,4,5,4,4,5,4,5,4,4,5,4,3,5,5,4,4,5,5,3,
                 5,5,4,4,4,4,4,5,4,4,5,4,4,3,4,4,4,4,4,4,4,
                 4,4,4,4,5,3,5,3,4,4,5,5,5,4,5,5,5,5,5,5,5,
                 5,5,5,5,3,5,5,5,5,5,2,5,3,3,3,5,5,4,4,4,5,
                 4,5,5,2,5,5,4,5,5,3,3,5,5,5,5,5,5,5,4,5,3,
                 5,3,4,5,4,5,5,3,5,5,4,5,5,4,5,4,5,5,5,4,4,
                 3,4,4,4,5,3,4,4,5,4,5,5,5,5,5,5,5,5,4,5,4,
                 4,5,4,4,5,4,4,5,4,5,5,4,5,5,5,4,5,5,5,5,5,
                 4,5,5,5,4,5,5,5,4,4,5,5,5,5,4,4,5,5,5,3,5,
                 4,5,4,5,5,4,3,5,4,5,5,5,5,5,5,5,5,4,4,5,4,
                 5,5,5,5,5,5,4,3,5,4,5,4,5,3,4,3,3,4,5,5,5,
                 4,3,5,4,5,5,5,5,4,4,5,4,5,5,4,4,5,3,5,5,5,
                 5,4,5,3,4,4,3,5,4,4,5,5,5,5,5,5,5,4,5,5,5,
                 5,5,5,5,5,5,5,5,5,5),
          LC = c(5,5,5,5,5,4,5,5,4,5,5,3,3,3,3,
                 4,2,4,4,4,4,4,4,5,5,4,5,4,5,5,5,4,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,4,5,4,5,4,5,5,5,3,4,4,4,
                 3,4,4,2,3,4,5,5,5,5,4,5,4,5,4,4,5,4,4,4,4,
                 4,4,4,5,4,4,4,4,4,4,4,3,4,3,4,4,4,4,4,4,4,
                 3,4,4,4,4,4,4,4,4,4,4,5,4,5,4,4,4,3,4,4,4,
                 4,4,4,4,4,4,5,4,4,4,4,4,4,4,5,5,4,5,4,5,5,
                 3,5,4,4,5,4,4,4,4,4,3,4,4,3,4,4,4,4,5,4,4,
                 4,4,4,4,4,4,4,5,4,3,5,4,4,3,4,4,4,4,3,3,4,
                 4,4,5,5,4,5,3,5,5,5,4,5,4,5,3,5,4,4,5,5,4,
                 4,5,3,4,5,4,4,5,4,4,5,4,5,3,5,4,3,5,3,4,5,
                 5,5,5,5,5,5,5,5,3,5,4,4,4,4,4,4,4,4,4,4,4,
                 4,4,4,4,4,4,5,4,5,5,4,4,4,4,4,5,5,5,5,5,5,
                 5,4,5,5,4,5,5,5,4,5,4,5,3,5,5,5,5,5,5,3,5,
                 5,5,5,5,5,5,5,5,5,5,5,4,5,5,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,4,4,4,5,3,4,3,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,4,5,4,4,5,4,4,4,5,4,5,
                 4,4,4,4,5,5,5,4,5,5,5,5,5,4,5,5,4,5,5,5,5,
                 5,5,5,5,5,4,5,5,5,4,4,5,4,5,4,5,4,5,5,5,4,
                 4,4,5,4,5,5,5,4,4,4,5,5,5,5,5,4,4,3,3,5,5,
                 4,4,4,4,4,3,4,4,3,4,4,5,5,5,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,2,5,5,5,5,5,5,5,4,4,5,
                 4,5,4,3,4,5,4,4,4,3,3,4,5,5,5,5,5,5,4,5,4,
                 5,4,4,5,5,5,5,3,5,5,4,4,5,4,4,4,5,5,5,4,3,
                 3,4,4,4,5,4,4,5,5,4,5,5,5,5,3,4,5,5,4,5,5,
                 5,5,4,5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,5,
                 4,5,5,5,4,5,5,5,4,4,5,5,5,5,4,4,4,5,5,3,4,
                 4,5,4,5,5,3,3,5,4,2,5,5,5,5,5,5,5,4,4,3,4,
                 5,5,5,5,5,4,4,3,5,2,4,3,5,3,4,3,3,3,4,5,5,
                 4,4,5,4,5,5,5,5,4,4,5,4,5,5,4,4,5,3,5,5,5,
                 5,4,5,3,4,5,4,5,4,4,5,5,5,5,5,5,5,4,5,5,5,
                 5,5,5,5,5,5,5,5,5,5),
          HS = c(3,3,3,3,3,4,3,3,4,3,3,2,3,2,2,
                 4,4,4,4,2,4,3,4,5,5,4,5,4,5,5,5,4,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,2,2,2,2,4,
                 3,3,4,3,4,4,5,5,5,5,4,3,4,5,4,4,5,4,4,3,4,
                 4,4,3,4,4,4,4,4,5,4,5,4,3,3,4,4,4,3,4,3,4,
                 4,4,4,4,4,4,4,4,4,4,4,2,4,4,4,4,4,4,3,3,4,
                 3,4,4,4,4,3,5,4,3,4,5,4,4,2,5,5,2,5,3,5,5,
                 4,5,2,4,4,2,2,1,2,3,2,2,4,2,4,4,2,4,3,4,4,
                 4,2,4,2,4,3,4,3,4,3,5,2,3,3,2,2,3,3,3,2,4,
                 3,2,5,4,3,4,3,4,4,5,3,5,3,5,2,5,5,2,5,4,2,
                 3,4,3,4,4,2,3,5,3,2,5,3,5,3,4,3,2,5,3,4,5,
                 5,4,5,5,5,4,5,5,3,5,4,4,4,4,4,4,4,4,4,4,4,
                 4,4,2,4,4,4,3,2,3,3,2,2,2,2,3,5,5,2,4,5,5,
                 5,3,3,3,2,5,3,4,2,5,2,5,2,4,2,3,4,4,3,3,3,
                 4,4,4,4,3,4,5,5,4,4,3,4,3,2,4,4,3,5,3,3,2,
                 3,4,3,4,3,3,4,2,3,3,2,1,1,2,4,3,5,5,5,5,4,
                 5,5,5,3,4,5,5,5,3,5,3,4,5,4,5,3,3,3,4,3,4,
                 4,4,4,3,5,4,5,4,5,5,5,5,5,3,2.42,2.42,2.42,
                 2.42,2.42,2.42,2.42,2.42,2.42,2.42,2.42,2.42,2.17,2.17,
                 2.17,2.17,2.17,2.17,2.17,2.17,2.17,2.17,2.17,2.17,
                 2.58,2.58,2.58,2.58,2.58,2.58,2.67,2.67,2.67,2.67,2.67,
                 2.67,2.67,2.67,2.67,2.67,2.67,2.67,2.42,2.42,2.42,
                 2.42,2.42,2.42,2.42,2.42,2.42,2.42,2.42,2.42,2.58,2.58,
                 2.58,2.58,2.58,2.58,2.5,2.5,2.5,2.5,2.5,2.5,2.5,
                 2.5,2.5,2.5,2.6,2.6,2.6,2.6,2.6,2.6,2.6,2.6,2.6,2.6,
                 2.6,2.6,2.6,2.6,2.6,2.21,2.21,2.21,3.64,2.21,3.64,
                 3.64,3.64,3.64,3.64,2.21,2.21,2.21,2.21,2.21,2.21,2.21,
                 2.21,2.21,2.21,2.21,2.21,2.21,2.21,2.27,2.27,2.27,
                 2.27,2.21,2.27,2.27,2.27,2.27,2.27,2.27,2.27,2.27,2.27,
                 2.27,2.27,3.64,3.64,3.64,3.64,3.64,2.31,2.31,2.31,
                 2.85,2.85,2.85,2.85,2.85,4,4,4,2.94,2.94,2.94,2.94,
                 2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,
                 2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,
                 2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.31,
                 2.31,3.35,3.35,3.35,2.31,3.6,3.6,3.6,3.6,3.6,3.6,
                 3.6,3.6,3.6,3.6,3.83,3.83,3.83,3.83,2.85,2.85,2.85,
                 2.85,2.85,3.83,2.85,3.83,2.85,3.83,2.85,2.85,2.85,2.85,
                 2.85,2.85,2.85,3.83,3.83,3.83,3.83,3.56,3.56,3.83,
                 3.56,3.56,3.56,3.56,3.56,3.56,3.56,3,3,3,3,3,3,3,3,
                 3.35,2.31,2.31,2.31,2.31,2.31,2.31,2.85,2.85,2.85,
                 2.85,2.85,2.85,2.85,2.85,2.31,2.31,2.31,3.35,3.35,3.35,
                 3.35,2.31,3.35,3.35,3.35,3.35,3.35,3.35,3.35,3.35,
                 3.35,2.3,2.3,2.3,2.3,2.3,2.3,2.3,2.3,2.3,2.3,3.69,3.69,
                 3.69,3.69,3.69,3.69,3.69,3.69,3.69,3.69,3.69,3.69,
                 3.69),
          PE = c(4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
                 4,4,4,4,4,4,4,4,5,5,4,5,4,5,5,5,4,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                 5,5,5,5,4,5,5,5,5,5,5,5,5,5,5,5,3,1,4,4,4,
                 3,3,4,4,5,4,5,5,4,5,5,4,4,5,5,5,5,4,4,4,4,
                 4,4,4,4,4,4,4,4,5,5,5,4,4,4,4,5,4,4,5,4,4,
                 4,5,4,4,4,4,4,5,5,4,4,5,4,5,4,4,4,4,4,4,4,
                 4,4,5,4,5,4,5,4,4,4,5,4,5,4,5,5,4,5,4,5,5,
                 5,5,4,4,4,4,4,4,3,4,3,5,4,3,4,4,5,4,4,4,5,
                 4,5,4,3,4,5,4,5,4,4,5,3,4,4,4,4,4,3,4,4,4,
                 4,2,5,3,2,5,4,5,5,5,4,5,3,5,2,5,5,2,5,5,4,
                 4,4,4,5,4,3,3,5,3,3,5,3,4,4,4,4,4,4,5,4,5,
                 5,4,4,5,5,4,5,5,3,5,4,4,4,4,4,4,4,4,4,4,4,
                 4,4,4,4,4,4,4,5,5,5,5,5,4,5,5,5,5,3,4,4,5,
                 5,5,4,4,5,5,5,5,4,5,4,5,5,4,4,3,3,4,4,3,3,
                 3,4,4,4,4,4,4,5,4,4,5,5,4,4,4,4,3,4,4,4,4,
                 4,4,4,4,5,3,4,4,5,4,5,4,4,4,5,5,5,5,5,5,5,
                 5,5,5,5,4,5,5,5,5,5,4,4,5,4,5,4,4,4,5,4,5,
                 5,5,4,4,5,5,5,3,5,5,5,5,5,4,5,4,5,5,5,4,4,
                 4,4,4,5,4,4,4,4,5,5,4,5,4,4,4,5,4,5,5,5,4,
                 4,5,4,4,4,4,4,5,4,4,5,4,5,4,5,5,4,4,3,4,4,
                 4,4,4,4,4,3,4,4,3,4,4,5,5,5,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,5,
                 4,5,4,3,5,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,
                 5,4,5,4,5,5,5,5,4,5,5,4,4,4,4,4,5,5,5,5,5,
                 3,4,4,4,5,5,5,5,5,5,5,5,3,5,5,5,5,5,5,5,5,
                 5,5,5,5,5,5,5,3,5,3,3,5,4,5,5,5,5,5,5,5,5,
                 3,5,5,5,5,5,5,5,4,4,5,5,5,5,4,5,5,5,5,4,4,
                 4,5,5,5,5,3,4,5,3,3,5,5,5,5,5,5,5,4,3,3,4,
                 5,5,5,5,5,4,5,3,5,4,5,3,5,4,4,4,4,3,5,5,5,
                 4,3,5,5,5,5,5,5,5,4,5,4,5,5,5,5,5,3,5,5,5,
                 5,5,5,3,5,5,5,5,4,4,5,5,5,5,5,5,5,4,5,5,5,
                 5,4,5,5,5,5,5,5,5,5),
      综合幸福指数 = c(0.9,0.9,0.9,0.9,0.9,0.8,0.9,0.9,0.8,
                 0.9,0.9,0.67,0.73,0.67,0.67,0.8,0.7,0.8,0.8,0.7,
                 0.8,0.73,0.8,0.93,0.93,0.8,0.93,0.8,0.93,0.93,0.93,0.8,
                 0.93,1,1,1,1,1,1,1,0.97,0.97,0.97,0.97,0.97,0.97,
                 0.93,0.97,0.97,0.97,0.97,0.93,0.97,0.93,0.97,1,1,1,
                 1,1,0.93,0.93,0.97,0.97,0.97,0.97,0.97,0.97,0.93,
                 0.97,0.97,0.97,0.97,0.63,0.43,0.73,0.73,0.8,0.6,0.67,
                 0.8,0.57,0.77,0.8,0.87,1,0.97,1,0.83,0.83,0.8,1,
                 0.83,0.83,1,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.83,0.83,0.8,
                 0.8,0.8,0.9,0.87,0.93,0.73,0.87,0.73,0.8,0.9,0.83,
                 0.73,0.9,0.83,0.8,0.8,0.93,0.8,0.8,0.8,0.8,0.83,0.87,
                 0.87,0.8,0.8,0.83,0.8,0.93,0.8,0.8,0.8,0.77,0.73,
                 0.77,0.83,0.83,0.83,0.9,0.8,0.87,0.77,1,0.8,0.77,0.83,
                 0.9,0.83,0.87,0.7,1,1,0.7,1,0.77,1,1,0.77,1,0.7,
                 0.8,0.87,0.77,0.7,0.7,0.67,0.77,0.6,0.77,0.83,0.6,
                 0.8,0.8,0.83,0.8,0.9,0.8,0.93,0.8,0.77,0.8,0.73,0.8,
                 0.9,0.8,0.87,0.8,0.73,1,0.7,0.73,0.67,0.73,0.73,0.77,
                 0.67,0.7,0.67,0.73,0.8,0.77,1,0.8,0.73,0.97,0.8,0.9,
                 0.97,1,0.83,1,0.8,1,0.6,0.97,0.93,0.67,1,0.97,
                 0.73,0.73,0.9,0.73,0.9,0.87,0.73,0.7,1,0.67,0.67,0.97,
                 0.7,0.97,0.73,0.9,0.7,0.63,0.9,0.7,0.8,1,1,0.83,0.9,
                 1,1,0.93,1,1,0.77,1,0.8,0.8,0.8,0.8,0.8,0.8,0.8,
                 0.8,0.8,0.8,0.8,0.8,0.8,0.73,0.8,0.8,0.8,0.8,0.77,
                 0.87,0.93,0.77,0.77,0.73,0.77,0.77,1,1,0.83,0.93,
                 0.97,1,1,0.8,0.9,0.9,0.87,1,0.93,0.97,0.7,1,0.73,1,
                 0.73,0.93,0.87,0.87,0.9,0.93,0.9,0.6,0.87,0.9,0.93,
                 0.93,0.93,0.9,0.93,0.97,1,0.93,0.93,0.93,0.9,0.9,0.87,
                 0.9,0.93,0.87,0.97,0.9,0.9,0.87,0.9,0.93,0.9,0.93,
                 0.9,0.87,0.93,0.73,0.77,0.77,0.87,0.63,0.7,0.67,0.97,
                 0.93,1,1,1,1,0.97,1,1,1,0.93,0.93,1,1,1,0.93,1,
                 0.8,0.93,0.97,0.9,1,0.83,0.8,0.77,0.93,0.8,0.93,0.93,
                 0.87,0.77,0.73,1,0.97,1,0.77,1,1,1,1,1,0.77,0.88,
                 0.85,0.88,0.91,0.91,0.85,0.81,0.81,0.78,0.81,0.88,
                 0.78,0.81,0.87,0.77,0.91,0.84,0.74,0.91,0.77,0.77,0.81,
                 0.91,0.74,0.85,0.92,0.92,0.72,0.79,0.89,0.79,0.76,
                 0.79,0.82,0.82,0.86,0.72,0.79,0.89,0.79,0.89,0.79,0.85,
                 0.85,0.75,0.71,0.68,0.78,0.78,0.78,0.75,0.71,0.75,
                 0.78,0.59,0.79,0.69,0.65,0.72,0.82,0.92,0.92,0.88,0.92,
                 0.92,0.92,0.92,0.92,0.92,0.92,0.92,0.92,0.92,0.92,
                 0.85,0.92,0.92,0.92,0.92,0.92,0.72,0.92,0.85,0.85,0.85,
                 0.91,0.84,0.87,0.82,0.81,0.95,0.82,0.95,0.89,0.69,
                 0.87,0.87,0.81,0.77,0.84,0.77,0.74,0.87,0.91,0.91,0.91,
                 0.91,0.91,0.91,0.78,0.91,0.78,0.91,0.64,0.84,0.88,
                 0.88,0.91,0.88,0.78,0.88,0.91,0.81,0.78,0.88,0.79,0.85,
                 0.79,0.95,0.95,0.91,0.78,0.74,0.6,0.76,0.76,0.76,
                 0.93,0.77,0.83,0.93,0.9,0.86,0.9,0.93,0.86,0.93,0.73,
                 0.86,0.9,0.93,0.86,0.9,0.9,0.9,0.93,0.86,0.9,0.9,0.86,
                 0.9,0.86,0.9,0.86,0.86,0.9,0.9,0.9,0.93,0.9,0.93,
                 0.93,0.9,0.86,0.9,0.73,0.91,0.91,0.95,0.78,0.95,0.91,
                 0.95,0.79,0.79,0.95,0.95,0.95,0.95,0.79,0.89,0.92,
                 0.96,0.96,0.76,0.89,0.76,0.93,0.8,0.93,0.93,0.79,0.63,
                 0.96,0.73,0.79,0.9,0.9,0.9,0.93,0.9,0.93,0.93,0.83,
                 0.76,0.83,0.86,0.95,0.95,0.93,0.95,0.95,0.85,0.82,0.72,
                 0.95,0.79,0.9,0.77,0.93,0.73,0.77,0.73,0.77,0.77,
                 0.85,0.91,0.91,0.74,0.68,0.91,0.78,0.93,0.93,0.93,0.93,
                 0.8,0.76,0.93,0.76,0.91,0.91,0.71,0.81,0.91,0.61,0.95,
                 0.91,0.91,0.95,0.78,0.95,0.61,0.88,0.85,0.78,0.95,
                 0.74,0.74,0.91,0.91,0.91,0.91,0.91,0.91,0.91,0.74,0.96,
                 0.96,0.96,0.96,0.92,0.96,0.92,0.96,0.96,0.96,0.96,
                 0.96,0.96)
)
```

```{r paged.print=FALSE}
library(Rmisc)
x <- c("AQ", "SC", "EA", "LC", "HS", "PE", "综合幸福指数")
for(i in 1:7){
  sup <- CI(index[,i],0.95)
  print(paste(x[i],"的95%置信区间:"))
  print(sup)
}
```
## 市级指标置信区间

```{r}
shiji <- data.frame(市 = c("滨州","滨州","滨州","滨州","滨州",
                       "淄博","滨州","滨州","淄博","滨州","滨州","滨州","滨州","滨州","滨州",
                       "淄博","滨州","淄博","淄博","滨州","淄博","滨州","淄博","滨州",
                       "滨州","淄博","滨州","淄博","滨州","滨州","滨州","淄博","滨州","滨州",
                       "滨州","滨州","滨州","滨州","滨州","滨州","邢台","邢台","邢台",
                       "邢台","邢台","邢台","邢台","邢台","邢台","邢台","邢台","邢台","邢台",
                       "邢台","邢台","邢台","邢台","邢台","邢台","邢台","邢台","邢台",
                       "邢台","邢台","邢台","邢台","邢台","邢台","邢台","邢台","邢台","邢台",
                       "邢台","濮阳","濮阳","濮阳","濮阳","濮阳","鹤壁","鹤壁","鹤壁",
                       "鹤壁","鹤壁","鹤壁","鹤壁","鹤壁","鹤壁","鹤壁","鹤壁","鹤壁",
                       "鹤壁","鹤壁","鹤壁","鹤壁","鹤壁","鹤壁","安阳","安阳","淄博","淄博",
                       "淄博","安阳","安阳","安阳","安阳","淄博","淄博","安阳","安阳",
                       "安阳","安阳","安阳","安阳","淄博","安阳","安阳","安阳","石家庄",
                       "安阳","淄博","安阳","安阳","淄博","石家庄","淄博","淄博","石家庄",
                       "安阳","石家庄","淄博","淄博","安阳","淄博","安阳","淄博","淄博","石家庄",
                       "石家庄","石家庄","石家庄","石家庄","石家庄","石家庄","石家庄","石家庄",
                       "石家庄","石家庄","邢台","石家庄","石家庄","石家庄","石家庄","石家庄",
                       "石家庄","石家庄","邢台","邢台","石家庄","邢台","石家庄","邢台","邢台",
                       "石家庄","邢台","石家庄","石家庄","石家庄","石家庄","石家庄","濮阳",
                       "濮阳","濮阳","濮阳","濮阳","濮阳","安阳","淄博","淄博","安阳","淄博",
                       "安阳","淄博","安阳","淄博","濮阳","淄博","安阳","淄博","濮阳",
                       "淄博","安阳","淄博","濮阳","安阳","濮阳","濮阳","濮阳","濮阳","濮阳",
                       "濮阳","濮阳","濮阳","濮阳","濮阳","安阳","安阳","安阳","安阳",
                       "安阳","安阳","安阳","济南","安阳","济南","安阳","济南","安阳","济南",
                       "安阳","济南","安阳","安阳","济南","安阳","濮阳","安阳","济南",
                       "濮阳","安阳","济南","濮阳","濮阳","济南","濮阳","濮阳","济南","濮阳",
                       "济南","濮阳","济南","濮阳","濮阳","济南","济南","济南","济南",
                       "济南","济南","济南","济南","济南","济南","济南","济南","济南","济南",
                       "淄博","淄博","淄博","淄博","淄博","淄博","淄博","淄博","淄博",
                       "淄博","淄博","淄博","淄博","濮阳","淄博","淄博","淄博","濮阳","濮阳",
                       "濮阳","濮阳","濮阳","濮阳","濮阳","濮阳","濮阳","滨州","滨州",
                       "滨州","滨州","滨州","滨州","滨州","濮阳","滨州","滨州","濮阳","滨州",
                       "滨州","滨州","濮阳","滨州","濮阳","滨州","濮阳","滨州","滨州",
                       "滨州","滨州","滨州","滨州","滨州","滨州","滨州","滨州","滨州","滨州",
                       "滨州","滨州","滨州","滨州","滨州","滨州","滨州","滨州","滨州",
                       "滨州","滨州","滨州","滨州","滨州","滨州","滨州","滨州","滨州","滨州",
                       "滨州","滨州","滨州","滨州","滨州","濮阳","濮阳","濮阳","濮阳",
                       "濮阳","濮阳","聊城","聊城","聊城","聊城","聊城","聊城","聊城","聊城",
                       "聊城","聊城","济南","济南","济南","济南","济南","济南","济南",
                       "济南","济南","济南","济南","济南","济南","济南","鹤壁","鹤壁","鹤壁",
                       "安阳","安阳","安阳","安阳","安阳","安阳","聊城","聊城","聊城",
                       "聊城","聊城","聊城","聊城","聊城","聊城","聊城","长治","长治","长治",
                       "长治","长治","长治","长治","长治","长治","长治","长治","长治",
                       "长治","长治","长治","长治","长治","长治","长治","长治","长治","长治",
                       "长治","长治","长治","长治","长治","长治","长治","长治","长治",
                       "长治","长治","长治","长治","长治","长治","长治","长治","长治","长治",
                       "长治","长治","长治","长治","长治","长治","长治","长治","长治",
                       "长治","长治","长治","长治","长治","长治","长治","长治","长治","长治",
                       "邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸",
                       "邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸",
                       "邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸",
                       "天津","邯郸","天津","天津","天津","天津","天津","邯郸","邯郸","邯郸",
                       "邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸",
                       "邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸",
                       "邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","邯郸","天津",
                       "天津","天津","天津","天津","济宁","济宁","济宁","天津","天津",
                       "天津","天津","天津","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽",
                       "菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽",
                       "菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽",
                       "菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽","菏泽",
                       "菏泽","菏泽","菏泽","济宁","济宁","济宁","济宁","济宁","济宁",
                       "天津","天津","天津","天津","天津","天津","天津","天津","天津",
                       "天津","天津","天津","天津","天津","天津","天津","天津","天津","天津",
                       "天津","天津","天津","天津","天津","天津","天津","天津","天津",
                       "天津","天津","天津","天津","天津","天津","天津","天津","天津","天津",
                       "天津","天津","天津","天津","天津","天津","天津","天津","天津",
                       "天津","天津","天津","天津","天津","天津","济宁","济","济宁",
                       "济宁","济宁","济宁","济宁","天津","天津","天津","天津","天津",
                       "天津","天津","天津","济宁","济宁","济宁","济宁","济宁","济宁",
                       "济宁","济宁","济宁","济宁","济宁","济宁","济宁","济宁",
                       "济宁","济宁","济宁","天津","天津","天津","天津","天津","天津",
                       "天津","天津","天津","天津","天津","天津","天津","天津","天津","天津",
                       "天津","天津","天津","天津","天津","天津","天津"),
                AQ = c(5,5,5,5,5,4,5,5,4,5,5,
                       3,4,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
                       4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,4,5,5,
                       5,5,5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,2,2,4,4,4,3,4,4,3,4,4,4,5,5,
                       5,4,4,4,5,4,4,5,4,3,4,4,4,4,3,4,4,4,4,
                       4,4,4,4,3,5,4,4,5,4,4,5,4,4,5,5,4,4,4,
                       4,4,5,4,4,4,4,4,5,4,4,4,4,3,4,4,5,4,5,
                       4,4,4,5,4,4,4,4,5,4,3,5,5,3,5,4,5,5,4,
                       5,3,4,4,4,3,4,3,4,3,4,5,3,4,4,4,4,5,4,
                       5,4,4,4,4,4,5,4,4,4,4,5,4,3,3,4,4,4,3,
                       3,3,3,4,5,5,4,5,5,5,4,5,5,5,5,5,5,3,5,
                       5,5,5,5,4,3,4,4,5,3,4,4,5,4,4,4,3,5,4,
                       4,3,4,4,4,4,5,5,4,5,5,5,5,5,5,5,5,4,4,
                       4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,
                       4,4,4,3,3,5,5,5,5,5,5,5,4,5,5,5,5,5,5,
                       3,5,4,5,4,5,5,5,5,5,5,3,5,5,5,5,5,5,5,
                       5,5,5,5,5,4,5,5,4,5,5,5,5,5,5,5,5,5,5,
                       4,5,5,4,3,4,4,3,4,4,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,5,4,4,
                       5,4,3,4,5,5,5,4,5,5,5,5,5,4,4,5,5,5,5,
                       5,4,4,4,5,4,4,5,5,4,5,5,4,5,5,5,5,5,4,
                       5,5,5,4,4,5,4,4,4,5,5,5,4,5,4,4,5,5,4,
                       5,4,4,4,4,4,5,4,3,4,4,3,4,3,3,4,4,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,4,5,5,5,5,4,5,5,5,5,5,5,3,5,
                       5,4,5,5,5,5,5,5,5,4,5,4,5,3,5,5,5,5,5,
                       5,5,5,4,4,5,4,4,4,5,5,5,4,4,3,4,4,4,5,
                       4,4,5,5,5,4,5,5,5,3,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,
                       5,5,5,4,5,5,5,4,4,5,5,5,5,4,5,5,5,5,4,
                       5,4,5,4,5,5,5,3,5,4,5,4,4,4,5,4,5,5,4,
                       4,5,5,5,5,4,5,5,4,4,5,5,5,5,5,5,4,4,4,
                       5,5,4,5,5,4,4,5,4,5,5,5,5,4,4,5,4,5,5,
                       3,4,4,3,5,5,4,5,3,5,3,5,4,5,5,4,4,5,5,
                       5,5,5,5,5,4,5,5,5,5,5,5,4,5,5,5,5,5,5),
                SC = c(5,5,5,5,5,4,5,5,4,5,5,
                       4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,
                       4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,4,5,5,
                       5,5,4,5,4,4,5,5,5,5,5,4,5,4,5,5,5,5,4,
                       5,5,5,5,5,3,2,4,4,4,3,3,4,3,4,4,3,5,5,
                       5,4,4,4,5,4,4,5,5,5,4,4,4,4,5,4,5,4,4,
                       4,5,4,5,4,5,5,4,4,5,4,5,5,4,4,5,4,4,4,
                       4,5,4,4,4,4,4,4,5,4,4,4,4,4,4,5,5,5,5,
                       4,5,4,5,4,4,4,5,4,5,5,5,5,5,5,4,5,5,3,
                       5,5,4,4,5,5,4,4,4,3,4,4,4,4,4,5,4,5,4,
                       5,4,4,4,4,4,5,4,4,4,4,5,4,4,3,4,4,4,4,
                       4,4,3,5,5,5,4,4,5,5,5,5,5,5,5,5,5,4,4,
                       5,4,5,5,4,4,5,4,5,5,4,4,5,3,3,5,4,5,4,
                       5,4,3,4,3,4,5,5,4,4,5,5,5,5,5,5,5,4,4,
                       4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,
                       4,4,4,4,4,5,5,5,5,5,5,5,4,5,5,5,5,5,5,
                       4,5,4,5,4,5,5,5,5,5,5,3,5,5,5,5,5,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,4,4,4,5,4,4,4,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,5,5,5,
                       5,5,4,4,5,5,5,4,5,5,5,5,5,4,5,5,5,5,5,
                       4,5,5,4,4,5,4,5,5,4,5,5,4,5,4,4,4,5,4,
                       4,5,5,4,4,5,4,4,4,4,4,4,3,4,5,4,5,4,5,
                       5,4,4,4,4,4,4,4,4,4,4,3,4,4,4,3,5,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,4,5,4,5,5,5,5,5,4,5,5,5,5,5,
                       5,5,5,5,5,5,5,5,5,4,5,5,5,3,5,5,5,5,4,
                       5,5,5,5,4,5,4,5,4,5,5,5,4,4,3,4,4,4,5,
                       3,4,5,4,5,5,5,5,5,3,4,4,5,5,4,5,5,5,5,
                       5,5,4,5,5,5,5,5,5,5,4,5,5,5,5,5,4,4,4,
                       5,5,5,3,5,5,5,4,4,5,5,5,5,4,5,5,5,5,5,
                       5,4,5,4,5,5,5,3,5,4,5,5,5,5,5,5,5,5,5,
                       4,5,5,5,5,5,5,5,5,4,4,5,5,5,5,5,5,4,5,
                       5,5,4,5,5,4,4,5,4,5,5,5,5,4,4,5,4,5,5,
                       3,4,5,3,5,5,5,5,4,5,3,5,4,3,5,4,4,5,5,
                       5,5,5,5,5,4,5,5,5,5,5,5,5,5,5,5,5,5,5),
                EA = c(5,5,5,5,5,4,5,5,4,5,5,
                       4,4,4,4,4,3,4,4,3,4,3,4,5,5,4,5,4,5,5,
                       5,4,5,5,5,5,5,5,5,5,4,4,4,4,4,4,5,4,4,
                       4,4,5,5,4,5,5,5,5,5,5,4,4,5,4,4,4,5,5,
                       4,4,5,4,4,4,3,4,4,4,3,3,4,2,3,4,4,5,5,
                       5,4,5,4,5,4,4,5,3,4,5,4,4,4,5,4,4,4,4,
                       4,4,5,5,4,5,3,4,5,4,3,4,5,4,4,5,4,4,4,
                       4,4,4,5,4,4,5,4,4,4,4,4,4,4,4,4,4,4,4,
                       4,4,4,5,4,4,5,4,4,4,3,5,5,3,5,4,5,5,4,
                       5,3,4,5,4,3,4,4,4,4,4,4,3,4,4,5,4,5,4,
                       5,4,4,4,5,4,5,4,5,4,4,5,4,4,4,4,4,4,3,
                       4,4,4,4,5,5,4,4,5,4,4,5,5,4,5,4,5,4,5,
                       4,3,5,5,4,4,5,4,4,5,5,3,5,3,4,5,4,5,4,
                       5,3,3,5,3,4,5,5,4,4,5,5,5,5,5,4,5,4,4,
                       4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,
                       4,4,4,5,4,5,5,5,5,5,5,5,4,5,5,5,5,5,5,
                       4,5,4,5,4,5,5,5,5,5,5,3,5,5,5,5,5,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,4,4,4,5,4,4,3,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,5,5,5,3,5,5,5,5,4,4,4,4,4,5,
                       5,4,4,3,5,5,5,4,5,5,5,5,5,4,5,4,5,5,5,
                       5,4,4,4,4,5,4,4,5,4,5,4,4,5,4,3,5,5,4,
                       4,5,5,3,5,5,4,4,4,4,4,5,4,4,5,4,4,3,4,
                       4,4,4,4,4,4,4,4,4,4,5,3,5,3,4,4,5,5,5,
                       4,5,5,5,5,5,5,5,5,5,5,5,3,5,5,5,5,5,2,
                       5,3,3,3,5,5,4,4,4,5,4,5,5,2,5,5,4,5,5,
                       3,3,5,5,5,5,5,5,5,4,5,3,5,3,4,5,4,5,5,
                       3,5,5,4,5,5,4,5,4,5,5,5,4,4,3,4,4,4,5,
                       3,4,4,5,4,5,5,5,5,5,5,5,5,4,5,4,4,5,4,
                       4,5,4,4,5,4,5,5,4,5,5,5,4,5,5,5,5,5,4,
                       5,5,5,4,5,5,5,4,4,5,5,5,5,4,4,5,5,5,3,
                       5,4,5,4,5,5,4,3,5,4,5,5,5,5,5,5,5,5,4,
                       4,5,4,5,5,5,5,5,5,4,3,5,4,5,4,5,3,4,3,
                       3,4,5,5,5,4,3,5,4,5,5,5,5,4,4,5,4,5,5,
                       4,4,5,3,5,5,5,5,4,5,3,4,4,3,5,4,4,5,5,
                       5,5,5,5,5,4,5,5,5,5,5,5,5,5,5,5,5,5,5),
                LC = c(5,5,5,5,5,4,5,5,4,5,5,
                       3,3,3,3,4,2,4,4,4,4,4,4,5,5,4,5,4,5,5,
                       5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,5,
                       4,5,4,5,5,5,3,4,4,4,3,4,4,2,3,4,5,5,5,
                       5,4,5,4,5,4,4,5,4,4,4,4,4,4,4,5,4,4,4,
                       4,4,4,4,3,4,3,4,4,4,4,4,4,4,3,4,4,4,4,
                       4,4,4,4,4,4,5,4,5,4,4,4,3,4,4,4,4,4,4,
                       4,4,4,5,4,4,4,4,4,4,4,5,5,4,5,4,5,5,3,
                       5,4,4,5,4,4,4,4,4,3,4,4,3,4,4,4,4,5,4,
                       4,4,4,4,4,4,4,4,5,4,3,5,4,4,3,4,4,4,4,
                       3,3,4,4,4,5,5,4,5,3,5,5,5,4,5,4,5,3,5,
                       4,4,5,5,4,4,5,3,4,5,4,4,5,4,4,5,4,5,3,
                       5,4,3,5,3,4,5,5,5,5,5,5,5,5,5,3,5,4,4,
                       4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,4,5,5,
                       4,4,4,4,4,5,5,5,5,5,5,5,4,5,5,4,5,5,5,
                       4,5,4,5,3,5,5,5,5,5,5,3,5,5,5,5,5,5,5,
                       5,5,5,5,5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,4,4,4,5,3,4,3,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,5,5,5,4,5,4,4,5,4,4,4,5,4,5,
                       4,4,4,4,5,5,5,4,5,5,5,5,5,4,5,5,4,5,5,
                       5,5,5,5,5,5,5,4,5,5,5,4,4,5,4,5,4,5,4,
                       5,5,5,4,4,4,5,4,5,5,5,4,4,4,5,5,5,5,5,
                       4,4,3,3,5,5,4,4,4,4,4,3,4,4,3,4,4,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,2,
                       5,5,5,5,5,5,5,4,4,5,4,5,4,3,4,5,4,4,4,
                       3,3,4,5,5,5,5,5,5,4,5,4,5,4,4,5,5,5,5,
                       3,5,5,4,4,5,4,4,4,5,5,5,4,3,3,4,4,4,5,
                       4,4,5,5,4,5,5,5,5,3,4,5,5,4,5,5,5,5,4,
                       5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,5,4,
                       5,5,5,4,5,5,5,4,4,5,5,5,5,4,4,4,5,5,3,
                       4,4,5,4,5,5,3,3,5,4,2,5,5,5,5,5,5,5,4,
                       4,3,4,5,5,5,5,5,4,4,3,5,2,4,3,5,3,4,3,
                       3,3,4,5,5,4,4,5,4,5,5,5,5,4,4,5,4,5,5,
                       4,4,5,3,5,5,5,5,4,5,3,4,5,4,5,4,4,5,5,
                       5,5,5,5,5,4,5,5,5,5,5,5,5,5,5,5,5,5,5),
                HS = c(3,3,3,3,3,4,3,3,4,3,3,
                       2,3,2,2,4,4,4,4,2,4,3,4,5,5,4,5,4,5,5,
                       5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,2,2,2,2,4,3,3,4,3,4,4,5,5,5,
                       5,4,3,4,5,4,4,5,4,4,3,4,4,4,3,4,4,4,4,
                       4,5,4,5,4,3,3,4,4,4,3,4,3,4,4,4,4,4,4,
                       4,4,4,4,4,4,2,4,4,4,4,4,4,3,3,4,3,4,4,
                       4,4,3,5,4,3,4,5,4,4,2,5,5,2,5,3,5,5,4,
                       5,2,4,4,2,2,1,2,3,2,2,4,2,4,4,2,4,3,4,
                       4,4,2,4,2,4,3,4,3,4,3,5,2,3,3,2,2,3,3,
                       3,2,4,3,2,5,4,3,4,3,4,4,5,3,5,3,5,2,5,
                       5,2,5,4,2,3,4,3,4,4,2,3,5,3,2,5,3,5,3,
                       4,3,2,5,3,4,5,5,4,5,5,5,4,5,5,3,5,4,4,
                       4,4,4,4,4,4,4,4,4,4,4,2,4,4,4,3,2,3,3,
                       2,2,2,2,3,5,5,2,4,5,5,5,3,3,3,2,5,3,4,
                       2,5,2,5,2,4,2,3,4,4,3,3,3,4,4,4,4,3,4,
                       5,5,4,4,3,4,3,2,4,4,3,5,3,3,2,3,4,3,4,
                       3,3,4,2,3,3,2,1,1,2,4,3,5,5,5,5,4,5,5,
                       5,3,4,5,5,5,3,5,3,4,5,4,5,3,3,3,4,3,4,
                       4,4,4,3,5,4,5,4,5,5,5,5,5,3,2.42,2.42,
                       2.42,2.42,2.42,2.42,2.42,2.42,2.42,2.42,2.42,2.42,
                       2.17,2.17,2.17,2.17,2.17,2.17,2.17,2.17,2.17,
                       2.17,2.17,2.17,2.58,2.58,2.58,2.58,2.58,2.58,2.67,
                       2.67,2.67,2.67,2.67,2.67,2.67,2.67,2.67,2.67,
                       2.67,2.67,2.42,2.42,2.42,2.42,2.42,2.42,2.42,2.42,
                       2.42,2.42,2.42,2.42,2.58,2.58,2.58,2.58,2.58,
                       2.58,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,2.5,
                       2.6,2.6,2.6,2.6,2.6,2.6,2.6,2.6,2.6,2.6,2.6,2.6,
                       2.6,2.6,2.6,2.21,2.21,2.21,3.64,2.21,3.64,3.64,
                       3.64,3.64,3.64,2.21,2.21,2.21,2.21,2.21,2.21,
                       2.21,2.21,2.21,2.21,2.21,2.21,2.21,2.21,2.27,2.27,
                       2.27,2.27,2.21,2.27,2.27,2.27,2.27,2.27,2.27,
                       2.27,2.27,2.27,2.27,2.27,3.64,3.64,3.64,3.64,3.64,
                       2.31,2.31,2.31,2.85,2.85,2.85,2.85,2.85,4,4,4,
                       2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,
                       2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,
                       2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.94,
                       2.94,2.94,2.94,2.94,2.94,2.94,2.94,2.31,2.31,3.35,
                       3.35,3.35,2.31,3.6,3.6,3.6,3.6,3.6,3.6,3.6,3.6,
                       3.6,3.6,3.83,3.83,3.83,3.83,2.85,2.85,2.85,
                       2.85,2.85,3.83,2.85,3.83,2.85,3.83,2.85,2.85,2.85,
                       2.85,2.85,2.85,2.85,3.83,3.83,3.83,3.83,3.56,
                       3.56,3.83,3.56,3.56,3.56,3.56,3.56,3.56,3.56,3,3,
                       3,3,3,3,3,3,3.35,2.31,2.31,2.31,2.31,2.31,
                       2.31,2.85,2.85,2.85,2.85,2.85,2.85,2.85,2.85,2.31,
                       2.31,2.31,3.35,3.35,3.35,3.35,2.31,3.35,3.35,
                       3.35,3.35,3.35,3.35,3.35,3.35,3.35,2.3,2.3,2.3,2.3,
                       2.3,2.3,2.3,2.3,2.3,2.3,3.69,3.69,3.69,3.69,
                       3.69,3.69,3.69,3.69,3.69,3.69,3.69,3.69,3.69),
                PE = c(4,4,4,4,4,4,4,4,4,4,4,
                       4,4,4,4,4,4,4,4,4,4,4,4,5,5,4,5,4,5,5,
                       5,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,4,5,5,5,5,5,5,
                       5,5,5,5,5,3,1,4,4,4,3,3,4,4,5,4,5,5,4,
                       5,5,4,4,5,5,5,5,4,4,4,4,4,4,4,4,4,4,4,
                       4,5,5,5,4,4,4,4,5,4,4,5,4,4,4,5,4,4,4,
                       4,4,5,5,4,4,5,4,5,4,4,4,4,4,4,4,4,4,5,
                       4,5,4,5,4,4,4,5,4,5,4,5,5,4,5,4,5,5,5,
                       5,4,4,4,4,4,4,3,4,3,5,4,3,4,4,5,4,4,4,
                       5,4,5,4,3,4,5,4,5,4,4,5,3,4,4,4,4,4,3,
                       4,4,4,4,2,5,3,2,5,4,5,5,5,4,5,3,5,2,5,
                       5,2,5,5,4,4,4,4,5,4,3,3,5,3,3,5,3,4,4,
                       4,4,4,4,5,4,5,5,4,4,5,5,4,5,5,3,5,4,4,
                       4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,
                       5,5,4,5,5,5,5,3,4,4,5,5,5,4,4,5,5,5,5,
                       4,5,4,5,5,4,4,3,3,4,4,3,3,3,4,4,4,4,4,
                       4,5,4,4,5,5,4,4,4,4,3,4,4,4,4,4,4,4,4,
                       5,3,4,4,5,4,5,4,4,4,5,5,5,5,5,5,5,5,5,
                       5,5,4,5,5,5,5,5,4,4,5,4,5,4,4,4,5,4,5,
                       5,5,4,4,5,5,5,3,5,5,5,5,5,4,5,4,5,5,5,
                       4,4,4,4,4,5,4,4,4,4,5,5,4,5,4,4,4,5,4,
                       5,5,5,4,4,5,4,4,4,4,4,5,4,4,5,4,5,4,5,
                       5,4,4,3,4,4,4,4,4,4,4,3,4,4,3,4,4,5,5,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,5,5,5,4,4,5,4,5,4,3,5,4,4,4,4,
                       5,5,5,5,5,5,5,5,5,5,5,5,5,4,5,4,5,5,5,
                       5,4,5,5,4,4,4,4,4,5,5,5,5,5,3,4,4,4,5,
                       5,5,5,5,5,5,5,3,5,5,5,5,5,5,5,5,5,5,5,
                       5,5,5,5,3,5,3,3,5,4,5,5,5,5,5,5,5,5,3,
                       5,5,5,5,5,5,5,4,4,5,5,5,5,4,5,5,5,5,4,
                       4,4,5,5,5,5,3,4,5,3,3,5,5,5,5,5,5,5,4,
                       3,3,4,5,5,5,5,5,4,5,3,5,4,5,3,5,4,4,4,
                       4,3,5,5,5,4,3,5,5,5,5,5,5,5,4,5,4,5,5,
                       5,5,5,3,5,5,5,5,5,5,3,5,5,5,5,4,4,5,5,
                       5,5,5,5,5,4,5,5,5,5,4,5,5,5,5,5,5,5,5),
            综合幸福指数 = c(0.9,0.9,0.9,0.9,0.9,0.8,
                       0.9,0.9,0.8,0.9,0.9,0.67,0.73,0.67,0.67,0.8,0.7,
                       0.8,0.8,0.7,0.8,0.73,0.8,0.93,0.93,0.8,0.93,
                       0.8,0.93,0.93,0.93,0.8,0.93,1,1,1,1,1,1,1,0.97,
                       0.97,0.97,0.97,0.97,0.97,0.93,0.97,0.97,0.97,
                       0.97,0.93,0.97,0.93,0.97,1,1,1,1,1,0.93,0.93,
                       0.97,0.97,0.97,0.97,0.97,0.97,0.93,0.97,0.97,0.97,
                       0.97,0.63,0.43,0.73,0.73,0.8,0.6,0.67,0.8,0.57,
                       0.77,0.8,0.87,1,0.97,1,0.83,0.83,0.8,1,0.83,
                       0.83,1,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.83,0.83,
                       0.8,0.8,0.8,0.9,0.87,0.93,0.73,0.87,0.73,0.8,0.9,
                       0.83,0.73,0.9,0.83,0.8,0.8,0.93,0.8,0.8,0.8,
                       0.8,0.83,0.87,0.87,0.8,0.8,0.83,0.8,0.93,0.8,0.8,
                       0.8,0.77,0.73,0.77,0.83,0.83,0.83,0.9,0.8,0.87,
                       0.77,1,0.8,0.77,0.83,0.9,0.83,0.87,0.7,1,1,
                       0.7,1,0.77,1,1,0.77,1,0.7,0.8,0.87,0.77,0.7,
                       0.7,0.67,0.77,0.6,0.77,0.83,0.6,0.8,0.8,0.83,0.8,
                       0.9,0.8,0.93,0.8,0.77,0.8,0.73,0.8,0.9,0.8,
                       0.87,0.8,0.73,1,0.7,0.73,0.67,0.73,0.73,0.77,0.67,
                       0.7,0.67,0.73,0.8,0.77,1,0.8,0.73,0.97,0.8,0.9,
                       0.97,1,0.83,1,0.8,1,0.6,0.97,0.93,0.67,1,
                       0.97,0.73,0.73,0.9,0.73,0.9,0.87,0.73,0.7,1,0.67,
                       0.67,0.97,0.7,0.97,0.73,0.9,0.7,0.63,0.9,0.7,
                       0.8,1,1,0.83,0.9,1,1,0.93,1,1,0.77,1,0.8,0.8,
                       0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,0.8,
                       0.73,0.8,0.8,0.8,0.8,0.77,0.87,0.93,0.77,0.77,
                       0.73,0.77,0.77,1,1,0.83,0.93,0.97,1,1,0.8,0.9,
                       0.9,0.87,1,0.93,0.97,0.7,1,0.73,1,0.73,0.93,0.87,
                       0.87,0.9,0.93,0.9,0.6,0.87,0.9,0.93,0.93,0.93,
                       0.9,0.93,0.97,1,0.93,0.93,0.93,0.9,0.9,0.87,
                       0.9,0.93,0.87,0.97,0.9,0.9,0.87,0.9,0.93,0.9,0.93,
                       0.9,0.87,0.93,0.73,0.77,0.77,0.87,0.63,0.7,
                       0.67,0.97,0.93,1,1,1,1,0.97,1,1,1,0.93,0.93,1,
                       1,1,0.93,1,0.8,0.93,0.97,0.9,1,0.83,0.8,0.77,
                       0.93,0.8,0.93,0.93,0.87,0.77,0.73,1,0.97,1,0.77,
                       1,1,1,1,1,0.77,0.88,0.85,0.88,0.91,0.91,0.85,
                       0.81,0.81,0.78,0.81,0.88,0.78,0.81,0.87,0.77,
                       0.91,0.84,0.74,0.91,0.77,0.77,0.81,0.91,0.74,0.85,
                       0.92,0.92,0.72,0.79,0.89,0.79,0.76,0.79,0.82,
                       0.82,0.86,0.72,0.79,0.89,0.79,0.89,0.79,0.85,0.85,
                       0.75,0.71,0.68,0.78,0.78,0.78,0.75,0.71,0.75,
                       0.78,0.59,0.79,0.69,0.65,0.72,0.82,0.92,0.92,0.88,
                       0.92,0.92,0.92,0.92,0.92,0.92,0.92,0.92,0.92,
                       0.92,0.92,0.85,0.92,0.92,0.92,0.92,0.92,0.72,0.92,
                       0.85,0.85,0.85,0.91,0.84,0.87,0.82,0.81,0.95,
                       0.82,0.95,0.89,0.69,0.87,0.87,0.81,0.77,0.84,0.77,
                       0.74,0.87,0.91,0.91,0.91,0.91,0.91,0.91,0.78,
                       0.91,0.78,0.91,0.64,0.84,0.88,0.88,0.91,0.88,0.78,
                       0.88,0.91,0.81,0.78,0.88,0.79,0.85,0.79,0.95,
                       0.95,0.91,0.78,0.74,0.6,0.76,0.76,0.76,0.93,0.77,
                       0.83,0.93,0.9,0.86,0.9,0.93,0.86,0.93,0.73,0.86,
                       0.9,0.93,0.86,0.9,0.9,0.9,0.93,0.86,0.9,0.9,
                       0.86,0.9,0.86,0.9,0.86,0.86,0.9,0.9,0.9,0.93,0.9,
                       0.93,0.93,0.9,0.86,0.9,0.73,0.91,0.91,0.95,
                       0.78,0.95,0.91,0.95,0.79,0.79,0.95,0.95,0.95,0.95,
                       0.79,0.89,0.92,0.96,0.96,0.76,0.89,0.76,0.93,0.8,
                       0.93,0.93,0.79,0.63,0.96,0.73,0.79,0.9,0.9,0.9,
                       0.93,0.9,0.93,0.93,0.83,0.76,0.83,0.86,0.95,
                       0.95,0.93,0.95,0.95,0.85,0.82,0.72,0.95,0.79,0.9,
                       0.77,0.93,0.73,0.77,0.73,0.77,0.77,0.85,0.91,
                       0.91,0.74,0.68,0.91,0.78,0.93,0.93,0.93,0.93,0.8,
                       0.76,0.93,0.76,0.91,0.91,0.71,0.81,0.91,0.61,0.95,
                       0.91,0.91,0.95,0.78,0.95,0.61,0.88,0.85,0.78,
                       0.95,0.74,0.74,0.91,0.91,0.91,0.91,0.91,0.91,0.91,
                       0.74,0.96,0.96,0.96,0.96,0.92,0.96,0.92,0.96,
                       0.96,0.96,0.96,0.96,0.96)
)
```

```{r paged.print=FALSE}
library(tidyverse)
library(Rmisc)
x <- c("AQ", "SC", "EA", "LC", "HS", "PE", "综合幸福指数")
y <- c("淄博","长治","邢台","天津","石家庄","濮阳","聊城","济宁","济南","鹤壁","菏泽","邯郸","滨州","安阳")

for(i in x){
  for(n in y){
      sup <- CI(shiji[shiji$市 == n,][,i],0.95)
      print(paste(n,i,"的95%置信区间:"))
      print(sup)
  }
}
```

